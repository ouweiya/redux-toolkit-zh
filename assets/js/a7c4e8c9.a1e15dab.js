"use strict";(self.webpackChunkredux_toolkit_zh=self.webpackChunkredux_toolkit_zh||[]).push([[1281],{7438:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>n,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var r=s(4848),i=s(8453);const o={id:"usage-without-react-hooks",title:"\u4e0d\u4f7f\u7528 React Hooks \u7684\u7528\u6cd5",sidebar_label:"\u4e0d\u4f7f\u7528 React Hooks \u7684\u7528\u6cd5",hide_title:!0,description:"RTK Query > Usage > Usage Without React Hooks: Using RTKQ with other UI frameworks"},n="\u4e0d\u4f7f\u7528 React Hooks \u7684\u4f7f\u7528\u65b9\u6cd5",a={id:"rtk-query/usage/usage-without-react-hooks",title:"\u4e0d\u4f7f\u7528 React Hooks \u7684\u7528\u6cd5",description:"RTK Query > Usage > Usage Without React Hooks: Using RTKQ with other UI frameworks",source:"@site/docs/rtk-query/usage/usage-without-react-hooks.mdx",sourceDirName:"rtk-query/usage",slug:"/rtk-query/usage/usage-without-react-hooks",permalink:"/redux-toolkit-zh/rtk-query/usage/usage-without-react-hooks",draft:!1,unlisted:!1,editUrl:"https://github.com/ouweiya/redux-toolkit-zh/tree/master/docs/rtk-query/usage/usage-without-react-hooks.mdx",tags:[],version:"current",frontMatter:{id:"usage-without-react-hooks",title:"\u4e0d\u4f7f\u7528 React Hooks \u7684\u7528\u6cd5",sidebar_label:"\u4e0d\u4f7f\u7528 React Hooks \u7684\u7528\u6cd5",hide_title:!0,description:"RTK Query > Usage > Usage Without React Hooks: Using RTKQ with other UI frameworks"},sidebar:"docs",previous:{title:"\u81ea\u5b9a\u4e49\u67e5\u8be2",permalink:"/redux-toolkit-zh/rtk-query/usage/customizing-queries"},next:{title:"\u8fc1\u79fb\u5230 RTK Query",permalink:"/redux-toolkit-zh/rtk-query/usage/migrating-to-rtk-query"}},c={},d=[{value:"\u6dfb\u52a0\u8ba2\u9605",id:"\u6dfb\u52a0\u8ba2\u9605",level:2},{value:"\u79fb\u9664\u8ba2\u9605",id:"\u79fb\u9664\u8ba2\u9605",level:2},{value:"\u8bbf\u95ee\u7f13\u5b58\u6570\u636e\u548c\u8bf7\u6c42\u72b6\u6001",id:"\u8bbf\u95ee\u7f13\u5b58\u6570\u636e\u548c\u8bf7\u6c42\u72b6\u6001",level:2},{value:"Memoization\uff08\u8bb0\u5fc6\u5316\uff09",id:"memoization\u8bb0\u5fc6\u5316",level:3},{value:"\u6267\u884c\u53d8\u66f4",id:"\u6267\u884c\u53d8\u66f4",level:2},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:2},{value:"\u66f4\u591a\u4fe1\u606f",id:"\u66f4\u591a\u4fe1\u606f",level:2}];function l(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"\xa0"}),"\n",(0,r.jsx)(t.h1,{id:"\u4e0d\u4f7f\u7528-react-hooks-\u7684\u4f7f\u7528\u65b9\u6cd5",children:"\u4e0d\u4f7f\u7528 React Hooks \u7684\u4f7f\u7528\u65b9\u6cd5"}),"\n",(0,r.jsxs)(t.p,{children:["\u5c31\u50cf Redux \u6838\u5fc3\u548c Redux Toolkit \u4e00\u6837\uff0cRTK Query \u7684\u4e3b\u8981\u529f\u80fd\u662f UI-agnostic\uff0c\u53ef\u4ee5\u4e0e\u4efb\u4f55 UI \u5c42\u4e00\u8d77\u4f7f\u7528\u3002RTK Query \u8fd8\u5305\u62ec\u4e00\u4e2a\u4e13\u4e3a React \u8bbe\u8ba1\u7684 ",(0,r.jsx)(t.a,{href:"/redux-toolkit-zh/rtk-query/api/createApi",children:(0,r.jsx)(t.code,{children:"createApi"})})," \u7248\u672c\uff0c\u5b83",(0,r.jsx)(t.a,{href:"/redux-toolkit-zh/rtk-query/api/created-api/hooks",children:"\u81ea\u52a8\u751f\u6210 React hooks"}),"\u3002"]}),"\n",(0,r.jsx)(t.p,{children:"\u867d\u7136 React hooks \u662f\u5927\u591a\u6570\u7528\u6237\u9884\u671f\u4f7f\u7528 RTK Query \u7684\u4e3b\u8981\u65b9\u5f0f\uff0c\u4f46\u8be5\u5e93\u672c\u8eab\u4f7f\u7528\u7eaf JS \u903b\u8f91\uff0c\u65e2\u53ef\u4ee5\u4e0e React Class \u7ec4\u4ef6\u4e00\u8d77\u4f7f\u7528\uff0c\u4e5f\u53ef\u4ee5\u72ec\u7acb\u4e8e React \u672c\u8eab\u4f7f\u7528\u3002"}),"\n",(0,r.jsxs)(t.p,{children:["\u672c\u9875\u9762\u8bb0\u5f55\u4e86\u5728\u4e0d\u4f7f\u7528 React Hooks \u7684\u60c5\u51b5\u4e0b\u5982\u4f55\u4e0e RTK Query \u4ea4\u4e92\uff0c\u4ee5\u4fbf\u6b63\u786e\u4f7f\u7528 RTK Query \u7684 ",(0,r.jsx)(t.a,{href:"./cache-behavior",children:(0,r.jsx)(t.code,{children:"\u7f13\u5b58\u884c\u4e3a"})}),"\u3002"]}),"\n",(0,r.jsx)(t.h2,{id:"\u6dfb\u52a0\u8ba2\u9605",children:"\u6dfb\u52a0\u8ba2\u9605"}),"\n",(0,r.jsxs)(t.p,{children:["\u7f13\u5b58\u8ba2\u9605\u7528\u4e8e\u544a\u8bc9 RTK Query \u5b83\u9700\u8981\u4e3a\u7aef\u70b9\u83b7\u53d6\u6570\u636e\u3002\u53ef\u4ee5\u901a\u8fc7\u5206\u6d3e\u9644\u52a0\u5230\u67e5\u8be2\u7aef\u70b9\u7684 ",(0,r.jsx)(t.a,{href:"/redux-toolkit-zh/rtk-query/api/created-api/endpoints#initiate",children:(0,r.jsx)(t.code,{children:"initiate"})})," thunk action \u521b\u5efa\u5668\u7684\u7ed3\u679c\u6765\u6dfb\u52a0\u7aef\u70b9\u7684\u8ba2\u9605\u3002"]}),"\n",(0,r.jsxs)(t.p,{children:["\u5728 React hooks \u4e2d\uff0c\u8fd9\u79cd\u884c\u4e3a\u662f\u5728 ",(0,r.jsx)(t.a,{href:"/redux-toolkit-zh/rtk-query/api/created-api/hooks#usequery",children:(0,r.jsx)(t.code,{children:"useQuery"})}),"\u3001",(0,r.jsx)(t.a,{href:"../api/created-api/hooks.mdx#usequerysubscription",children:(0,r.jsx)(t.code,{children:"useQuerySubscription"})}),"\u3001",(0,r.jsx)(t.a,{href:"../api/created-api/hooks.mdx#uselazyquery",children:(0,r.jsx)(t.code,{children:"useLazyQuery"})})," \u548c ",(0,r.jsx)(t.a,{href:"/redux-toolkit-zh/rtk-query/api/created-api/hooks#uselazyquerysubscription",children:(0,r.jsx)(t.code,{children:"useLazyQuerySubscription"})})," \u4e2d\u5904\u7406\u7684\u3002"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",metastring:'title="\u8ba2\u9605\u7f13\u5b58\u6570\u636e" no-transpile',children:"const promise = dispatch(api.endpoints.getPosts.initiate())\nconst { refetch } = promise\n// \u4e0e useFetch...() hook \u4e00\u6837\u4e0e\u7f13\u5b58\u4ea4\u4e92\nconst { data, isLoading, isSuccess /*...*/ } = await promise\n"})}),"\n",(0,r.jsx)(t.h2,{id:"\u79fb\u9664\u8ba2\u9605",children:"\u79fb\u9664\u8ba2\u9605"}),"\n",(0,r.jsx)(t.p,{children:"\u79fb\u9664\u7f13\u5b58\u8ba2\u9605\u5bf9\u4e8e RTK Query \u786e\u5b9a\u4e0d\u518d\u9700\u8981\u7f13\u5b58\u6570\u636e\u662f\u5fc5\u8981\u7684\u3002\u8fd9\u5141\u8bb8 RTK Query \u6e05\u7406\u548c\u79fb\u9664\u65e7\u7684\u7f13\u5b58\u6570\u636e\u3002"}),"\n",(0,r.jsxs)(t.p,{children:["\u5206\u6d3e\u67e5\u8be2\u7aef\u70b9\u7684 ",(0,r.jsx)(t.a,{href:"/redux-toolkit-zh/rtk-query/api/created-api/endpoints#initiate",children:(0,r.jsx)(t.code,{children:"initiate"})})," thunk action \u521b\u5efa\u5668\u7684\u7ed3\u679c\u662f\u4e00\u4e2a\u5e26\u6709 ",(0,r.jsx)(t.code,{children:"unsubscribe"})," \u5c5e\u6027\u7684 Promise\u3002\u5f53\u8c03\u7528\u6b64\u5c5e\u6027\u65f6\uff0c\u5b83\u5c06\u79fb\u9664\u76f8\u5e94\u7684\u7f13\u5b58\u8ba2\u9605\u3002"]}),"\n",(0,r.jsxs)(t.p,{children:["\u5728 React hooks \u4e2d\uff0c\u8fd9\u79cd\u884c\u4e3a\u662f\u5728 ",(0,r.jsx)(t.a,{href:"/redux-toolkit-zh/rtk-query/api/created-api/hooks#usequery",children:(0,r.jsx)(t.code,{children:"useQuery"})}),"\u3001",(0,r.jsx)(t.a,{href:"../api/created-api/hooks.mdx#usequerysubscription",children:(0,r.jsx)(t.code,{children:"useQuerySubscription"})}),"\u3001",(0,r.jsx)(t.a,{href:"../api/created-api/hooks.mdx#uselazyquery",children:(0,r.jsx)(t.code,{children:"useLazyQuery"})})," \u548c ",(0,r.jsx)(t.a,{href:"/redux-toolkit-zh/rtk-query/api/created-api/hooks#uselazyquerysubscription",children:(0,r.jsx)(t.code,{children:"useLazyQuerySubscription"})})," \u4e2d\u5904\u7406\u7684\u3002"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",metastring:'title="\u53d6\u6d88\u8ba2\u9605\u7f13\u5b58\u6570\u636e" no-transpile',children:"// \u6dfb\u52a0\u7f13\u5b58\u8ba2\u9605\nconst promise = dispatch(api.endpoints.getPosts.initiate())\n\n// \u79fb\u9664\u76f8\u5e94\u7684\u7f13\u5b58\u8ba2\u9605\npromise.unsubscribe()\n"})}),"\n",(0,r.jsx)(t.h2,{id:"\u8bbf\u95ee\u7f13\u5b58\u6570\u636e\u548c\u8bf7\u6c42\u72b6\u6001",children:"\u8bbf\u95ee\u7f13\u5b58\u6570\u636e\u548c\u8bf7\u6c42\u72b6\u6001"}),"\n",(0,r.jsxs)(t.p,{children:["\u53ef\u4ee5\u4f7f\u7528\u67e5\u8be2\u7aef\u70b9\u7684 ",(0,r.jsx)(t.code,{children:"select"})," \u51fd\u6570\u5c5e\u6027\u521b\u5efa\u4e00\u4e2a\u9009\u62e9\u5668\uff0c\u5e76\u7528 Redux \u72b6\u6001\u8c03\u7528\u5b83\uff0c\u4ee5\u8bbf\u95ee\u7f13\u5b58\u6570\u636e\u548c\u8bf7\u6c42\u72b6\u6001\u4fe1\u606f\u3002\u8fd9\u63d0\u4f9b\u4e86\u5728\u8c03\u7528\u65f6\u7684\u7f13\u5b58\u6570\u636e\u548c\u8bf7\u6c42\u72b6\u6001\u4fe1\u606f\u7684\u5feb\u7167\u3002"]}),"\n",(0,r.jsx)(t.admonition,{type:"caution",children:(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.code,{children:"endpoint.select(arg)"})," \u51fd\u6570\u521b\u5efa\u4e00\u4e2a ",(0,r.jsx)(t.em,{children:"\u65b0\u7684"})," \u9009\u62e9\u5668\u5b9e\u4f8b - \u5b83\u4e0d\u662f\u5b9e\u9645\u7684\u9009\u62e9\u5668\u51fd\u6570\u672c\u8eab\uff01"]})}),"\n",(0,r.jsxs)(t.p,{children:["\u5728 React hooks \u4e2d\uff0c\u8fd9\u79cd\u884c\u4e3a\u662f\u5728 ",(0,r.jsx)(t.a,{href:"/redux-toolkit-zh/rtk-query/api/created-api/hooks#usequery",children:(0,r.jsx)(t.code,{children:"useQuery"})}),"\u3001",(0,r.jsx)(t.a,{href:"../api/created-api/hooks.mdx#usequerystate",children:(0,r.jsx)(t.code,{children:"useQueryState"})})," \u548c ",(0,r.jsx)(t.a,{href:"/redux-toolkit-zh/rtk-query/api/created-api/hooks#uselazyquery",children:(0,r.jsx)(t.code,{children:"useLazyQuery"})})," \u4e2d\u5904\u7406\u7684\u3002"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",metastring:'title="\u8bbf\u95ee\u7f13\u5b58\u6570\u636e\u548c\u8bf7\u6c42\u72b6\u6001" no-transpile',children:"const result = api.endpoints.getPosts.select()(state)\nconst { data, isSuccess, isError, error } = result\n"})}),"\n",(0,r.jsxs)(t.p,{children:["\u8bf7\u6ce8\u610f\uff0c\u4e0e\u81ea\u52a8\u751f\u6210\u7684 hooks \u4e0d\u540c\uff0c\u6ca1\u6709 ",(0,r.jsx)(t.code,{children:"isFetching"})," \u6807\u5fd7\uff0c\u5982\u679c\u72b6\u6001\u662f pending\uff0c\u65e0\u8bba\u662f\u5426\u5df2\u7ecf\u6709\u6570\u636e\uff0c",(0,r.jsx)(t.code,{children:"isLoading"})," \u6807\u5fd7\u90fd\u4f1a\u4e3a true\u3002"]}),"\n",(0,r.jsx)(t.h3,{id:"memoization\u8bb0\u5fc6\u5316",children:"Memoization\uff08\u8bb0\u5fc6\u5316\uff09"}),"\n",(0,r.jsxs)(t.p,{children:["\u7531\u4e8e ",(0,r.jsx)(t.code,{children:"endpoint.select(arg)"})," \u51fd\u6570\u6bcf\u6b21\u8c03\u7528\u65f6\u90fd\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684\u9009\u62e9\u5668\uff0c\u5e76\u4e14\u8fd9\u4e2a\u5b9e\u4f8b\u672c\u8eab\u662f\u8bb0\u5fc6\u5316\u7684\uff0c\u6240\u4ee5\u53ef\u80fd\u5e0c\u671b\u8bb0\u5fc6\u5316\u9009\u62e9\u5668\u7684\u521b\u5efa\uff08\u4f8b\u5982\uff0c\u7136\u540e\u5728\u53e6\u4e00\u4e2a\u9009\u62e9\u5668\u4e2d\u4f7f\u7528\u8be5\u8bb0\u5fc6\u5316\u5b9e\u4f8b\uff09\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7 ",(0,r.jsx)(t.code,{children:"createSelector"})," \u6765\u5b8c\u6210\uff1a"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",metastring:'title="\u521b\u5efa\u4e00\u4e2a\u8bb0\u5fc6\u5316\u7684\u9009\u62e9\u5668\u521b\u5efa\u5668" no-transpile',children:"const createGetPostSelector = createSelector(\n  (id: string) => id,\n  (id) => api.endpoints.getPost.select(id),\n)\n\nconst selectGetPostError = createSelector(\n  (state: RootState) => state,\n  (state: RootState, id: string) => createGetPostSelector(id),\n  (state, selectGetPost) => selectGetPost(state).error,\n)\n"})}),"\n",(0,r.jsx)(t.h2,{id:"\u6267\u884c\u53d8\u66f4",children:"\u6267\u884c\u53d8\u66f4"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.a,{href:"/redux-toolkit-zh/rtk-query/usage/mutations",children:"\u53d8\u66f4"}),"\u7528\u4e8e\u66f4\u65b0\u670d\u52a1\u5668\u4e0a\u7684\u6570\u636e\u3002\u53ef\u4ee5\u901a\u8fc7\u5206\u6d3e\u9644\u52a0\u5230\u53d8\u66f4\u7aef\u70b9\u7684 ",(0,r.jsx)(t.a,{href:"/redux-toolkit-zh/rtk-query/api/created-api/endpoints#initiate",children:(0,r.jsx)(t.code,{children:"initiate"})})," thunk action \u521b\u5efa\u5668\u7684\u7ed3\u679c\u6765\u6267\u884c\u53d8\u66f4\u3002"]}),"\n",(0,r.jsxs)(t.p,{children:["\u5728 React hooks \u4e2d\uff0c\u8fd9\u79cd\u884c\u4e3a\u662f\u5728 ",(0,r.jsx)(t.a,{href:"/redux-toolkit-zh/rtk-query/api/created-api/hooks#usemutation",children:(0,r.jsx)(t.code,{children:"useMutation"})})," \u4e2d\u5904\u7406\u7684\u3002"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",metastring:'title="\u89e6\u53d1\u4e00\u4e2a\u53d8\u66f4\u7aef\u70b9" no-transpile',children:"dispatch(api.endpoints.addPost.initiate({ name: 'foo' }))\n"})}),"\n",(0,r.jsx)(t.h2,{id:"\u793a\u4f8b",children:"\u793a\u4f8b"}),"\n",(0,r.jsx)(t.p,{children:"\u4ee5\u4e0b\u662f\u4e0d\u4f7f\u7528 React hooks \u7684\u4f7f\u7528\u793a\u4f8b\uff1a"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsxs)(t.a,{href:"/redux-toolkit-zh/rtk-query/usage/examples#react-class-components",children:[(0,r.jsx)(t.code,{children:"React Class Components"})," \u793a\u4f8b"]}),"\u4e2d\u7684 ",(0,r.jsx)(t.code,{children:"PostDetail"})," \u7ec4\u4ef6"]}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsxs)(t.a,{href:"/redux-toolkit-zh/rtk-query/usage/examples#svelte",children:[(0,r.jsx)(t.code,{children:"Svelte"})," \u793a\u4f8b"]})}),"\n",(0,r.jsxs)(t.li,{children:["\u4e0b\u9762\u7684 ",(0,r.jsx)(t.code,{children:"Cache Lifetime Subscription Class Component"})," \u793a\u4f8b\uff1a"]}),"\n"]}),"\n",(0,r.jsx)("iframe",{src:"https://codesandbox.io/embed/rtk-query-cache-lifetime-subscription-class-component-example-38mgd?fontsize=12&runonclick=1&hidenavigation=1&module=%2Fsrc%2Fcomponents%2FUsersList.tsx&theme=dark&runonclick=1",style:{width:"100%",height:"800px",border:0,borderRadius:"4px",overflow:"hidden"},title:"RTK Query Cache Lietime Subscription Class Component Example",allow:"geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb",sandbox:"allow-modals allow-forms allow-popups allow-scripts allow-same-origin"}),"\n",(0,r.jsx)(t.h2,{id:"\u66f4\u591a\u4fe1\u606f",children:"\u66f4\u591a\u4fe1\u606f"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["NgRx \u7ef4\u62a4\u8005 Brandon Roberts \u5199\u4e86\u4e00\u7bc7\u540d\u4e3a ",(0,r.jsx)(t.a,{href:"https://dev.to/brandontroberts/cousins-playing-nicely-experimenting-with-ngrx-store-and-rtk-query-25f4",children:"Cousins playing nicely: Experimenting with NgRx Store and RTK Query"})," \u7684\u6587\u7ae0\uff0c\u6f14\u793a\u4e86\u4e00\u4e9b\u5c06 RTK Query \u96c6\u6210\u5230 NgRx \u7684\u65b9\u6cd5"]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"https://github.com/SaulMoro/ngrx-rtk-query",children:(0,r.jsx)(t.code,{children:"saulmoro/ngrx-rtk-query"})})," \u5b9e\u73b0\u4e86 RTKQ \u81ea\u5df1\u7684 React hooks \u4e2d\u7ba1\u7406\u7684\u8ba2\u9605\u751f\u547d\u5468\u671f\u7684 NgRx \u7b49\u4ef7\u7269"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>n,x:()=>a});var r=s(6540);const i={},o=r.createContext(i);function n(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:n(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);