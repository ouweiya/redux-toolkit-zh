"use strict";(self.webpackChunkredux_toolkit_zh=self.webpackChunkredux_toolkit_zh||[]).push([[2839],{8458:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>o});var a=i(4848),t=i(8453);const r={id:"serializabilityMiddleware",title:"\u53ef\u5e8f\u5217\u5316\u4e2d\u95f4\u4ef6",sidebar_label:"\u53ef\u5e8f\u5217\u5316\u4e2d\u95f4\u4ef6",hide_title:!0},l="\u53ef\u5e8f\u5217\u5316\u4e2d\u95f4\u4ef6",s={id:"api/serializabilityMiddleware",title:"\u53ef\u5e8f\u5217\u5316\u4e2d\u95f4\u4ef6",description:"&nbsp;",source:"@site/docs/api/serializabilityMiddleware.mdx",sourceDirName:"api",slug:"/api/serializabilityMiddleware",permalink:"/redux-toolkit-zh/api/serializabilityMiddleware",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/api/serializabilityMiddleware.mdx",tags:[],version:"current",frontMatter:{id:"serializabilityMiddleware",title:"\u53ef\u5e8f\u5217\u5316\u4e2d\u95f4\u4ef6",sidebar_label:"\u53ef\u5e8f\u5217\u5316\u4e2d\u95f4\u4ef6",hide_title:!0},sidebar:"docs",previous:{title:"\u4e0d\u53d8\u6027\u4e2d\u95f4\u4ef6",permalink:"/redux-toolkit-zh/api/immutabilityMiddleware"},next:{title:"\u52a8\u4f5c\u521b\u5efa\u8005\u4e2d\u95f4\u4ef6",permalink:"/redux-toolkit-zh/api/actionCreatorMiddleware"}},d={},o=[{value:"\u9009\u9879",id:"\u9009\u9879",level:2},{value:"\u5bfc\u51fa",id:"\u5bfc\u51fa",level:2},{value:"<code>createSerializableStateInvariantMiddleware</code>",id:"createserializablestateinvariantmiddleware",level:3},{value:"<code>isPlain</code>",id:"isplain",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"\xa0"}),"\n",(0,a.jsx)(n.h1,{id:"\u53ef\u5e8f\u5217\u5316\u4e2d\u95f4\u4ef6",children:"\u53ef\u5e8f\u5217\u5316\u4e2d\u95f4\u4ef6"}),"\n",(0,a.jsxs)(n.p,{children:["\u8fd9\u662f\u4e00\u4e2a\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\uff0c\u53ef\u4ee5\u68c0\u6d4b\u72b6\u6001\u6216\u5206\u6d3e\u7684\u64cd\u4f5c\u4e2d\u662f\u5426\u5305\u542b\u4efb\u4f55\u975e\u53ef\u5e8f\u5217\u5316\u7684\u503c\uff0c\u5176\u6a21\u578b\u6765\u81ea",(0,a.jsx)(n.code,{children:"redux-immutable-state-invariant"}),"\u3002\u4efb\u4f55\u68c0\u6d4b\u5230\u7684\u975e\u53ef\u5e8f\u5217\u5316\u7684\u503c\u90fd\u5c06\u88ab\u8bb0\u5f55\u5230\u63a7\u5236\u53f0\u3002"]}),"\n",(0,a.jsxs)(n.p,{children:["\u8fd9\u4e2a\u4e2d\u95f4\u4ef6\u9ed8\u8ba4\u7531",(0,a.jsx)(n.a,{href:"/redux-toolkit-zh/api/configureStore",children:(0,a.jsx)(n.code,{children:"configureStore"})}),"\u548c",(0,a.jsx)(n.a,{href:"/redux-toolkit-zh/api/getDefaultMiddleware",children:(0,a.jsx)(n.code,{children:"getDefaultMiddleware"})}),"\u6dfb\u52a0\u5230\u5b58\u50a8\u4e2d\u3002"]}),"\n",(0,a.jsxs)(n.p,{children:["\u4f60\u53ef\u4ee5\u901a\u8fc7\u5c06\u4efb\u4f55\u652f\u6301\u7684\u9009\u9879\u4f5c\u4e3a",(0,a.jsx)(n.code,{children:"getDefaultMiddleware"}),"\u7684",(0,a.jsx)(n.code,{children:"serializableCheck"}),"\u503c\u6765\u81ea\u5b9a\u4e49\u6b64\u4e2d\u95f4\u4ef6\u7684\u884c\u4e3a\u3002"]}),"\n",(0,a.jsx)(n.h2,{id:"\u9009\u9879",children:"\u9009\u9879"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",metastring:"no-transpile",children:"interface SerializableStateInvariantMiddlewareOptions {\n  /**\n   * \u68c0\u67e5\u4e00\u4e2a\u503c\u662f\u5426\u88ab\u8ba4\u4e3a\u662f\u53ef\u5e8f\u5217\u5316\u7684\u51fd\u6570\u3002\n   * \u8fd9\u4e2a\u51fd\u6570\u4f1a\u9012\u5f52\u5e94\u7528\u5230\u72b6\u6001\u4e2d\u7684\u6bcf\u4e00\u4e2a\u503c\u3002\n   * \u9ed8\u8ba4\u4e3a`isPlain()`\u3002\n   */\n  isSerializable?: (value: any) => boolean\n  /**\n   * \u5c06\u7528\u4e8e\u4ece\u6bcf\u4e2a\u503c\u4e2d\u68c0\u7d22\u6761\u76ee\u7684\u51fd\u6570\u3002\n   * \u5982\u679c\u672a\u6307\u5b9a\uff0c\u5c06\u4f7f\u7528`Object.entries`\u3002\n   * \u9ed8\u8ba4\u4e3a`undefined`\u3002\n   */\n  getEntries?: (value: any) => [string, any][]\n\n  /**\n   * \u5728\u68c0\u67e5\u53ef\u5e8f\u5217\u5316\u6027\u65f6\u5ffd\u7565\u7684\u64cd\u4f5c\u7c7b\u578b\u7684\u6570\u7ec4\u3002\n   * \u9ed8\u8ba4\u4e3a[]\n   */\n  ignoredActions?: string[]\n\n  /**\n   * \u5728\u68c0\u67e5\u53ef\u5e8f\u5217\u5316\u6027\u65f6\u5ffd\u7565\u7684\u7531\u70b9\u5206\u9694\u7684\u8def\u5f84\u5b57\u7b26\u4e32\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u6570\u7ec4\u3002\n   * \u9ed8\u8ba4\u4e3a['meta.arg', 'meta.baseQueryMeta']\n   */\n  ignoredActionPaths?: (string | RegExp)[]\n\n  /**\n   * \u5728\u68c0\u67e5\u53ef\u5e8f\u5217\u5316\u6027\u65f6\u5ffd\u7565\u7684\u7531\u70b9\u5206\u9694\u7684\u8def\u5f84\u5b57\u7b26\u4e32\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u6570\u7ec4\u3002\n   * \u9ed8\u8ba4\u4e3a[]\n   */\n  ignoredPaths?: (string | RegExp)[]\n  /**\n   * \u6267\u884c\u65f6\u95f4\u8b66\u544a\u9608\u503c\u3002\u5982\u679c\u4e2d\u95f4\u4ef6\u7684\u6267\u884c\u65f6\u95f4\u8d85\u8fc7`warnAfter`\u6beb\u79d2\uff0c\n   * \u63a7\u5236\u53f0\u5c06\u663e\u793a\u8b66\u544a\u3002\u9ed8\u8ba4\u4e3a32ms\u3002\n   */\n  warnAfter?: number\n\n  /**\n   * \u9009\u62e9\u4e0d\u68c0\u67e5\u72b6\u6001\u3002\u5f53\u8bbe\u7f6e\u4e3a`true`\u65f6\uff0c\u5c06\u5ffd\u7565\u5176\u4ed6\u4e0e\u72b6\u6001\u76f8\u5173\u7684\u53c2\u6570\u3002\n   */\n  ignoreState?: boolean\n\n  /**\n   * \u9009\u62e9\u4e0d\u68c0\u67e5\u64cd\u4f5c\u3002\u5f53\u8bbe\u7f6e\u4e3a`true`\u65f6\uff0c\u5c06\u5ffd\u7565\u5176\u4ed6\u4e0e\u64cd\u4f5c\u76f8\u5173\u7684\u53c2\u6570\u3002\n   */\n  ignoreActions?: boolean\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u5bfc\u51fa",children:"\u5bfc\u51fa"}),"\n",(0,a.jsx)(n.h3,{id:"createserializablestateinvariantmiddleware",children:(0,a.jsx)(n.code,{children:"createSerializableStateInvariantMiddleware"})}),"\n",(0,a.jsx)(n.p,{children:"\u4f7f\u7528\u7ed9\u5b9a\u7684\u9009\u9879\u521b\u5efa\u4e00\u4e2a\u53ef\u5e8f\u5217\u5316\u68c0\u67e5\u4e2d\u95f4\u4ef6\u7684\u5b9e\u4f8b\u3002"}),"\n",(0,a.jsxs)(n.p,{children:["\u4f60\u6700\u53ef\u80fd\u4e0d\u9700\u8981\u81ea\u5df1\u8c03\u7528\u8fd9\u4e2a\uff0c\u56e0\u4e3a",(0,a.jsx)(n.code,{children:"getDefaultMiddleware"}),"\u5df2\u7ecf\u8fd9\u6837\u505a\u4e86\u3002"]}),"\n",(0,a.jsx)(n.p,{children:"\u793a\u4f8b\uff1a"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"// \u6587\u4ef6\uff1areducer.ts noEmit\n\nexport default function (state = {}, action: any) {\n  return state\n}\n\n// \u6587\u4ef6\uff1astore.ts\n\nimport { Iterable } from 'immutable'\nimport {\n  configureStore,\n  createSerializableStateInvariantMiddleware,\n  isPlain,\n  Tuple,\n} from '@reduxjs/toolkit'\nimport reducer from './reducer'\n\n// \u589e\u5f3a\u4e2d\u95f4\u4ef6\u4ee5\u5c06Immutable.JS\u8fed\u4ee3\u5668\u89c6\u4e3a\u53ef\u5e8f\u5217\u5316\nconst isSerializable = (value: any) =>\n  Iterable.isIterable(value) || isPlain(value)\n\nconst getEntries = (value: any) =>\n  Iterable.isIterable(value) ? value.entries() : Object.entries(value)\n\nconst serializableMiddleware = createSerializableStateInvariantMiddleware({\n  isSerializable,\n  getEntries,\n})\n\nconst store = configureStore({\n  reducer,\n  middleware: () => new Tuple(serializableMiddleware),\n})\n"})}),"\n",(0,a.jsx)(n.h3,{id:"isplain",children:(0,a.jsx)(n.code,{children:"isPlain"})}),"\n",(0,a.jsx)(n.p,{children:'\u68c0\u67e5\u7ed9\u5b9a\u7684\u503c\u662f\u5426\u88ab\u8ba4\u4e3a\u662f"\u666e\u901a\u503c"\u3002'}),"\n",(0,a.jsx)(n.p,{children:"\u76ee\u524d\u7684\u5b9e\u73b0\u4e3a\uff1a"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"// \u6587\u4ef6\uff1asrc/isPlainObject.ts noEmit\n\ndeclare function isPlainObject(value: unknown): value is object\nexport default isPlainObject\n\n// \u6587\u4ef6\uff1asrc/serializableStateInvariantMiddleware.ts\nimport isPlainObject from './isPlainObject'\n\nexport function isPlain(val: any) {\n  return (\n    typeof val === 'undefined' ||\n    val === null ||\n    typeof val === 'string' ||\n    typeof val === 'boolean' ||\n    typeof val === 'number' ||\n    Array.isArray(val) ||\n    isPlainObject(val)\n  )\n}\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u8fd9\u5c06\u63a5\u53d7\u6240\u6709\u6807\u51c6\u7684JS\u5bf9\u8c61\u3001\u6570\u7ec4\u548c\u539f\u59cb\u503c\uff0c\u4f46\u5bf9\u4e8e",(0,a.jsx)(n.code,{children:"Date"}),"\u3001",(0,a.jsx)(n.code,{children:"Map"}),"\u548c\u5176\u4ed6\u7c7b\u4f3c\u7684\u7c7b\u5b9e\u4f8b\uff0c\u8fd4\u56defalse\u3002"]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>s});var a=i(6540);const t={},r=a.createContext(t);function l(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);