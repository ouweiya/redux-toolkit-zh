"use strict";(self.webpackChunkredux_toolkit_zh=self.webpackChunkredux_toolkit_zh||[]).push([[1846],{2120:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>l,metadata:()=>d,toc:()=>s});var t=r(4848),i=r(8453);const l={id:"getDefaultMiddleware",title:"\u83b7\u53d6\u9ed8\u8ba4\u4e2d\u95f4\u4ef6",sidebar_label:"\u83b7\u53d6\u9ed8\u8ba4\u4e2d\u95f4\u4ef6",hide_title:!0},a="getDefaultMiddleware",d={id:"api/getDefaultMiddleware",title:"\u83b7\u53d6\u9ed8\u8ba4\u4e2d\u95f4\u4ef6",description:"&nbsp;",source:"@site/docs/api/getDefaultMiddleware.mdx",sourceDirName:"api",slug:"/api/getDefaultMiddleware",permalink:"/redux-toolkit-zh/api/getDefaultMiddleware",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/api/getDefaultMiddleware.mdx",tags:[],version:"current",frontMatter:{id:"getDefaultMiddleware",title:"\u83b7\u53d6\u9ed8\u8ba4\u4e2d\u95f4\u4ef6",sidebar_label:"\u83b7\u53d6\u9ed8\u8ba4\u4e2d\u95f4\u4ef6",hide_title:!0},sidebar:"docs",previous:{title:"\u914d\u7f6e\u5b58\u50a8",permalink:"/redux-toolkit-zh/api/configureStore"},next:{title:"\u4e0d\u53d8\u6027\u4e2d\u95f4\u4ef6",permalink:"/redux-toolkit-zh/api/immutabilityMiddleware"}},o={},s=[{value:"\u9884\u671f\u7528\u6cd5",id:"\u9884\u671f\u7528\u6cd5",level:2},{value:"\u5305\u542b\u7684\u9ed8\u8ba4\u4e2d\u95f4\u4ef6",id:"\u5305\u542b\u7684\u9ed8\u8ba4\u4e2d\u95f4\u4ef6",level:2},{value:"\u5f00\u53d1",id:"\u5f00\u53d1",level:3},{value:"\u751f\u4ea7",id:"\u751f\u4ea7",level:3},{value:"\u81ea\u5b9a\u4e49\u5305\u542b\u7684\u4e2d\u95f4\u4ef6",id:"\u81ea\u5b9a\u4e49\u5305\u542b\u7684\u4e2d\u95f4\u4ef6",level:2},{value:"API \u53c2\u8003",id:"api-\u53c2\u8003",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"\xa0"}),"\n",(0,t.jsx)(n.h1,{id:"getdefaultmiddleware",children:(0,t.jsx)(n.code,{children:"getDefaultMiddleware"})}),"\n",(0,t.jsx)(n.p,{children:"\u8fd4\u56de\u4e00\u4e2a\u5305\u542b\u9ed8\u8ba4\u4e2d\u95f4\u4ef6\u5217\u8868\u7684\u6570\u7ec4\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"\u9884\u671f\u7528\u6cd5",children:"\u9884\u671f\u7528\u6cd5"}),"\n",(0,t.jsxs)(n.p,{children:["\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c",(0,t.jsx)(n.a,{href:"/redux-toolkit-zh/api/configureStore",children:(0,t.jsx)(n.code,{children:"configureStore"})})," \u4f1a\u81ea\u52a8\u5411 Redux store \u8bbe\u7f6e\u4e2d\u6dfb\u52a0\u4e00\u4e9b\u4e2d\u95f4\u4ef6\u3002"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const store = configureStore({\n  reducer: rootReducer,\n})\n\n// Store \u5df2\u6dfb\u52a0\u4e2d\u95f4\u4ef6\uff0c\u56e0\u4e3a\u4e2d\u95f4\u4ef6\u5217\u8868\u6ca1\u6709\u88ab\u81ea\u5b9a\u4e49\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u5982\u679c\u4f60\u60f3\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u5217\u8868\uff0c\u4f60\u53ef\u4ee5\u5411 ",(0,t.jsx)(n.code,{children:"configureStore"})," \u63d0\u4f9b\u4e00\u4e2a\u4e2d\u95f4\u4ef6\u51fd\u6570\u7684\u6570\u7ec4\uff1a"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const store = configureStore({\n  reducer: rootReducer,\n  middleware: () => new Tuple(thunk, logger),\n})\n\n// Store \u660e\u786e\u5730\u5e94\u7528\u4e86 thunk \u548c logger \u4e2d\u95f4\u4ef6\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u7136\u800c\uff0c\u5f53\u4f60\u63d0\u4f9b ",(0,t.jsx)(n.code,{children:"middleware"})," \u9009\u9879\u65f6\uff0c\u4f60\u9700\u8981\u8d1f\u8d23\u5b9a\u4e49\u4f60\u60f3\u6dfb\u52a0\u5230 store \u7684\u6240\u6709\u4e2d\u95f4\u4ef6\u3002",(0,t.jsx)(n.code,{children:"configureStore"})," \u4e0d\u4f1a\u6dfb\u52a0\u4f60\u5217\u51fa\u7684\u4efb\u4f55\u989d\u5916\u4e2d\u95f4\u4ef6\u3002"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"getDefaultMiddleware"})," \u5728\u4f60\u60f3\u6dfb\u52a0\u4e00\u4e9b\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\uff0c\u4f46\u4e5f\u4ecd\u7136\u60f3\u6dfb\u52a0\u9ed8\u8ba4\u4e2d\u95f4\u4ef6\u65f6\u975e\u5e38\u6709\u7528\uff1a"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",metastring:"no-transpile",children:"import { configureStore } from '@reduxjs/toolkit'\n\nimport logger from 'redux-logger'\n\nimport rootReducer from './reducer'\n\nconst store = configureStore({\n  reducer: rootReducer,\n  middleware: (getDefaultMiddleware) => getDefaultMiddleware().concat(logger),\n})\n\n// Store \u6dfb\u52a0\u4e86\u6240\u6709\u9ed8\u8ba4\u7684\u4e2d\u95f4\u4ef6\uff0c_\u4ee5\u53ca_ logger \u4e2d\u95f4\u4ef6\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u4f18\u5148\u4f7f\u7528\u8fd4\u56de\u7684 ",(0,t.jsx)(n.code,{children:"Tuple"})," \u7684\u94fe\u5f0f ",(0,t.jsx)(n.code,{children:".concat(...)"})," \u548c ",(0,t.jsx)(n.code,{children:".prepend(...)"})," \u65b9\u6cd5\uff0c\u800c\u4e0d\u662f\u6570\u7ec4\u6269\u5c55\u8fd0\u7b97\u7b26\uff0c\u56e0\u4e3a\u540e\u8005\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u53ef\u80fd\u4f1a\u4e22\u5931\u6709\u4ef7\u503c\u7684 TS \u7c7b\u578b\u4fe1\u606f\u3002"]}),"\n",(0,t.jsx)(n.h2,{id:"\u5305\u542b\u7684\u9ed8\u8ba4\u4e2d\u95f4\u4ef6",children:"\u5305\u542b\u7684\u9ed8\u8ba4\u4e2d\u95f4\u4ef6"}),"\n",(0,t.jsx)(n.h3,{id:"\u5f00\u53d1",children:"\u5f00\u53d1"}),"\n",(0,t.jsxs)(n.p,{children:["Redux Toolkit \u7684\u76ee\u6807\u4e4b\u4e00\u662f\u63d0\u4f9b\u6709\u89c1\u5730\u7684\u9ed8\u8ba4\u503c\u5e76\u9632\u6b62\u5e38\u89c1\u9519\u8bef\u3002\u4f5c\u4e3a\u5176\u4e2d\u7684\u4e00\u90e8\u5206\uff0c",(0,t.jsx)(n.code,{children:"getDefaultMiddleware"})," \u5305\u542b\u4e00\u4e9b\u53ea\u5728\u4f60\u7684\u5e94\u7528\u7684\u5f00\u53d1\u6784\u5efa\u4e2d\u6dfb\u52a0\u7684\u4e2d\u95f4\u4ef6\uff0c\u4ee5\u63d0\u4f9b\u5bf9\u4e09\u4e2a\u5e38\u89c1\u95ee\u9898\u7684\u8fd0\u884c\u65f6\u68c0\u67e5\uff1a"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"/redux-toolkit-zh/api/immutabilityMiddleware",children:"\u4e0d\u53ef\u53d8\u6027\u68c0\u67e5\u4e2d\u95f4\u4ef6"}),"\uff1a\u6df1\u5ea6\u6bd4\u8f83\u72b6\u6001\u503c\u7684\u53d8\u5316\u3002\u5b83\u53ef\u4ee5\u5728\u8c03\u5ea6\u671f\u95f4\u68c0\u6d4b\u5230 reducer \u4e2d\u7684\u53d8\u5316\uff0c\u4e5f\u53ef\u4ee5\u5728\u8c03\u5ea6\u4e4b\u95f4\uff08\u5982\u5728\u7ec4\u4ef6\u6216\u9009\u62e9\u5668\u4e2d\uff09\u68c0\u6d4b\u5230\u53d8\u5316\u3002\u5f53\u68c0\u6d4b\u5230\u53d8\u5316\u65f6\uff0c\u5b83\u4f1a\u629b\u51fa\u4e00\u4e2a\u9519\u8bef\uff0c\u5e76\u6307\u51fa\u5728\u72b6\u6001\u6811\u4e2d\u68c0\u6d4b\u5230\u53d8\u5316\u503c\u7684\u952e\u8def\u5f84\u3002\uff08\u4ece ",(0,t.jsx)(n.a,{href:"https://github.com/leoasis/redux-immutable-state-invariant",children:(0,t.jsx)(n.code,{children:"redux-immutable-state-invariant"})})," \u5206\u652f\u51fa\u6765\u3002\uff09"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"/redux-toolkit-zh/api/serializabilityMiddleware",children:"\u53ef\u5e8f\u5217\u5316\u6027\u68c0\u67e5\u4e2d\u95f4\u4ef6"}),"\uff1a\u4e13\u95e8\u4e3a Redux Toolkit \u521b\u5efa\u7684\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u3002\u4e0e ",(0,t.jsx)(n.code,{children:"immutable-state-invariant"})," \u7684\u6982\u5ff5\u7c7b\u4f3c\uff0c\u4f46\u6df1\u5ea6\u68c0\u67e5\u4f60\u7684\u72b6\u6001\u6811\u548c\u4f60\u7684\u52a8\u4f5c\u662f\u5426\u5305\u542b\u975e\u5e8f\u5217\u5316\u503c\uff0c\u5982\u51fd\u6570\u3001Promise\u3001Symbol \u548c\u5176\u4ed6\u975e\u666e\u901a JS \u6570\u636e\u503c\u3002\u5f53\u68c0\u6d4b\u5230\u975e\u5e8f\u5217\u5316\u503c\u65f6\uff0c\u4f1a\u6253\u5370\u4e00\u4e2a\u63a7\u5236\u53f0\u9519\u8bef\uff0c\u5e76\u663e\u793a\u68c0\u6d4b\u5230\u975e\u5e8f\u5217\u5316\u503c\u7684\u952e\u8def\u5f84\u3002"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"/redux-toolkit-zh/api/actionCreatorMiddleware",children:"\u52a8\u4f5c\u521b\u5efa\u8005\u68c0\u67e5\u4e2d\u95f4\u4ef6"}),"\uff1a\u53e6\u4e00\u4e2a\u4e13\u95e8\u4e3a Redux Toolkit \u521b\u5efa\u7684\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u3002\u8bc6\u522b\u51fa\u52a8\u4f5c\u521b\u5efa\u8005\u88ab\u9519\u8bef\u5730\u8c03\u5ea6\u800c\u6ca1\u6709\u88ab\u8c03\u7528\uff0c\u5e76\u5411\u63a7\u5236\u53f0\u8b66\u544a\u52a8\u4f5c\u7c7b\u578b\u3002"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u9664\u4e86\u8fd9\u4e9b\u5f00\u53d1\u5de5\u5177\u4e2d\u95f4\u4ef6\uff0c\u5b83\u8fd8\u9ed8\u8ba4\u6dfb\u52a0\u4e86 ",(0,t.jsx)(n.a,{href:"https://github.com/reduxjs/redux-thunk",children:(0,t.jsx)(n.code,{children:"redux-thunk"})}),"\uff0c\u56e0\u4e3a thunk \u662f Redux \u63a8\u8350\u7684\u57fa\u672c\u526f\u4f5c\u7528\u4e2d\u95f4\u4ef6\u3002"]}),"\n",(0,t.jsx)(n.p,{children:"\u76ee\u524d\uff0c\u8fd4\u56de\u503c\u662f\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const middleware = [\n  actionCreatorInvariant,\n  immutableStateInvariant,\n  thunk,\n  serializableStateInvariant,\n]\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u751f\u4ea7",children:"\u751f\u4ea7"}),"\n",(0,t.jsx)(n.p,{children:"\u76ee\u524d\uff0c\u8fd4\u56de\u503c\u662f\uff1a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const middleware = [thunk]\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u81ea\u5b9a\u4e49\u5305\u542b\u7684\u4e2d\u95f4\u4ef6",children:"\u81ea\u5b9a\u4e49\u5305\u542b\u7684\u4e2d\u95f4\u4ef6"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"getDefaultMiddleware"})," \u63a5\u53d7\u4e00\u4e2a\u9009\u9879\u5bf9\u8c61\uff0c\u5141\u8bb8\u4ee5\u4e24\u79cd\u65b9\u5f0f\u81ea\u5b9a\u4e49\u6bcf\u4e2a\u4e2d\u95f4\u4ef6\uff1a"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\u901a\u8fc7\u4e3a\u5176\u5bf9\u5e94\u7684\u5b57\u6bb5\u4f20\u9012 ",(0,t.jsx)(n.code,{children:"false"}),"\uff0c\u53ef\u4ee5\u4ece\u7ed3\u679c\u6570\u7ec4\u4e2d\u6392\u9664\u6bcf\u4e2a\u4e2d\u95f4\u4ef6"]}),"\n",(0,t.jsx)(n.li,{children:"\u901a\u8fc7\u4e3a\u5176\u5bf9\u5e94\u7684\u5b57\u6bb5\u4f20\u9012\u5339\u914d\u7684\u9009\u9879\u5bf9\u8c61\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\u6bcf\u4e2a\u4e2d\u95f4\u4ef6\u7684\u9009\u9879"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:'\u8fd9\u4e2a\u4f8b\u5b50\u663e\u793a\u4e86\u6392\u9664\u53ef\u5e8f\u5217\u5316\u72b6\u6001\u68c0\u67e5\u4e2d\u95f4\u4ef6\uff0c\u5e76\u4e3a thunk \u4e2d\u95f4\u4ef6\u7684 "extra argument" \u4f20\u9012\u4e00\u4e2a\u7279\u5b9a\u503c\uff1a'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"// \u6587\u4ef6: reducer.ts noEmit\n\nexport default function rootReducer(state = {}, action: any) {\n  return state\n}\n\n// \u6587\u4ef6: api.ts noEmit\n\nexport declare const myCustomApiService: any\n\n// \u6587\u4ef6: store.ts\n\nimport { configureStore } from '@reduxjs/toolkit'\nimport rootReducer from './reducer'\nimport { myCustomApiService } from './api'\n\nconst store = configureStore({\n  reducer: rootReducer,\n  middleware: (getDefaultMiddleware) =>\n    getDefaultMiddleware({\n      thunk: {\n        extraArgument: myCustomApiService,\n      },\n      serializableCheck: false,\n    }),\n})\n"})}),"\n",(0,t.jsx)(n.h2,{id:"api-\u53c2\u8003",children:"API \u53c2\u8003"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",metastring:"no-transpile",children:'interface ThunkOptions<E = any> {\n  extraArgument: E\n}\n\ninterface ImmutableStateInvariantMiddlewareOptions {\n  // \u89c1 "\u4e0d\u53ef\u53d8\u6027\u4e2d\u95f4\u4ef6" \u9875\u9762\u7684\u5b9a\u4e49\n}\n\ninterface SerializableStateInvariantMiddlewareOptions {\n  // \u89c1 "\u53ef\u5e8f\u5217\u5316\u6027\u4e2d\u95f4\u4ef6" \u9875\u9762\u7684\u5b9a\u4e49\n}\n\ninterface ActionCreatorInvariantMiddlewareOptions {\n  // \u89c1 "\u52a8\u4f5c\u521b\u5efa\u8005\u4e2d\u95f4\u4ef6" \u9875\u9762\u7684\u5b9a\u4e49\n}\n\ninterface GetDefaultMiddlewareOptions {\n  thunk?: boolean | ThunkOptions\n  immutableCheck?: boolean | ImmutableStateInvariantMiddlewareOptions\n  serializableCheck?: boolean | SerializableStateInvariantMiddlewareOptions\n  actionCreatorCheck?: boolean | ActionCreatorInvariantMiddlewareOptions\n}\n\nfunction getDefaultMiddleware<S = any>(\n  options: GetDefaultMiddlewareOptions = {},\n): Middleware<{}, S>[]\n'})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>d});var t=r(6540);const i={},l=t.createContext(i);function a(e){const n=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);