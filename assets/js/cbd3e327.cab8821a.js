"use strict";(self.webpackChunkredux_toolkit_zh=self.webpackChunkredux_toolkit_zh||[]).push([[3310],{5130:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>o,frontMatter:()=>d,metadata:()=>i,toc:()=>t});var c=r(4848),s=r(8453);const d={id:"api",title:"API \u53c2\u8003",hide_title:!0},l="API \u53c2\u8003",i={id:"redux-saga/api",title:"API \u53c2\u8003",description:"\u4e2d\u95f4\u4ef6 API",source:"@site/docs/redux-saga/API.md",sourceDirName:"redux-saga",slug:"/redux-saga/api",permalink:"/redux-toolkit-zh/redux-saga/api",draft:!1,unlisted:!1,editUrl:"https://github.com/ouweiya/redux-toolkit-zh/tree/master/docs/redux-saga/API.md",tags:[],version:"current",frontMatter:{id:"api",title:"API \u53c2\u8003",hide_title:!0},sidebar:"reduxSaga",previous:{title:"\u672f\u8bed\u8868",permalink:"/redux-toolkit-zh/redux-saga/Glossary"}},a={},t=[{value:"\u4e2d\u95f4\u4ef6 API",id:"\u4e2d\u95f4\u4ef6-api",level:2},{value:"<code>createSagaMiddleware(options)</code>",id:"createsagamiddlewareoptions",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:4},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca",level:4},{value:"<code>middleware.run(saga, ...args)</code>",id:"middlewarerunsaga-args",level:3},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-1",level:4},{value:"\u6548\u679c\u521b\u5efa\u8005",id:"\u6548\u679c\u521b\u5efa\u8005",level:2},{value:"<code>take(pattern)</code>",id:"takepattern",level:3},{value:"<code>takeMaybe(pattern)</code>",id:"takemaybepattern",level:3},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-2",level:4},{value:"<code>take(channel)</code>",id:"takechannel",level:3},{value:"<code>takeMaybe(channel)</code>",id:"takemaybechannel",level:3},{value:"<code>takeEvery(pattern, saga, ...args)</code>",id:"takeeverypattern-saga-args",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-1",level:4},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-3",level:4},{value:"<code>takeEvery(channel, saga, ...args)</code>",id:"takeeverychannel-saga-args",level:3},{value:"<code>takeLatest(pattern, saga, ...args)</code>",id:"takelatestpattern-saga-args",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-2",level:4},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-4",level:4},{value:"<code>takeLatest(channel, saga, ...args)</code>",id:"takelatestchannel-saga-args",level:3},{value:"<code>takeLeading(pattern, saga, ...args)</code>",id:"takeleadingpattern-saga-args",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-3",level:4},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-5",level:4},{value:"<code>takeLeading(channel, saga, ...args)</code>",id:"takeleadingchannel-saga-args",level:3},{value:"<code>put(action)</code>",id:"putaction",level:3},{value:"<code>putResolve(action)</code>",id:"putresolveaction",level:3},{value:"<code>put(channel, action)</code>",id:"putchannel-action",level:3},{value:"<code>call(fn, ...args)</code>",id:"callfn-args",level:3},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-6",level:4},{value:"<code>call([context, fn], ...args)</code>",id:"callcontext-fn-args",level:3},{value:"<code>call([context, fnName], ...args)</code>",id:"callcontext-fnname-args",level:3},{value:"<code>call({context, fn}, ...args)</code>",id:"callcontext-fn-args-1",level:3},{value:"<code>apply(context, fn, [args])</code>",id:"applycontext-fn-args",level:3},{value:"<code>cps(fn, ...args)</code>",id:"cpsfn-args",level:3},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-7",level:4},{value:"<code>cps([context, fn], ...args)</code>",id:"cpscontext-fn-args",level:3},{value:"<code>cps({context, fn}, ...args)</code>",id:"cpscontext-fn-args-1",level:3},{value:"<code>fork(fn, ...args)</code>",id:"forkfn-args",level:3},{value:"\u53c2\u6570",id:"\u53c2\u6570",level:4},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-8",level:4},{value:"\u9519\u8bef\u4f20\u64ad",id:"\u9519\u8bef\u4f20\u64ad",level:4},{value:"<code>fork([context, fn], ...args)</code>",id:"forkcontext-fn-args",level:3},{value:"<code>fork({context, fn}, ...args)</code>",id:"forkcontext-fn-args-1",level:3},{value:"<code>spawn(fn, ...args)</code>",id:"spawnfn-args",level:3},{value:"<code>spawn([context, fn], ...args)</code>",id:"spawncontext-fn-args",level:3},{value:"<code>join(task)</code>",id:"jointask",level:3},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-9",level:4},{value:"<code>join([...tasks])</code>",id:"jointasks",level:3},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-10",level:4},{value:"<code>cancel(task)</code>",id:"canceltask",level:3},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-11",level:4},{value:"<code>cancel([...tasks])</code>",id:"canceltasks",level:3},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-12",level:4},{value:"<code>cancel()</code>",id:"cancel",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-4",level:4},{value:"<code>select(selector, ...args)</code>",id:"selectselector-args",level:3},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-13",level:4},{value:"<code>actionChannel(pattern, [buffer])</code>",id:"actionchannelpattern-buffer",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-5",level:4},{value:"<code>flush(channel)</code>",id:"flushchannel",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-6",level:4},{value:"<code>cancelled()</code>",id:"cancelled",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-7",level:4},{value:"<code>setContext(props)</code>",id:"setcontextprops",level:3},{value:"<code>getContext(prop)</code>",id:"getcontextprop",level:3},{value:"<code>delay(ms, [val])</code>",id:"delayms-val",level:3},{value:"<code>throttle(ms, pattern, saga, ...args)</code>",id:"throttlems-pattern-saga-args",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-8",level:4},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-14",level:4},{value:"<code>throttle(ms, channel, saga, ...args)</code>",id:"throttlems-channel-saga-args",level:3},{value:"<code>debounce(ms, pattern, saga, ...args)</code>",id:"debouncems-pattern-saga-args",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-9",level:4},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-15",level:4},{value:"<code>debounce(ms, channel, saga, ...args)</code>",id:"debouncems-channel-saga-args",level:3},{value:"<code>retry(maxTries, delay, fn, ...args)</code>",id:"retrymaxtries-delay-fn-args",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-10",level:4},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-16",level:4},{value:"Effect \u7ec4\u5408\u5668",id:"effect-\u7ec4\u5408\u5668",level:2},{value:"<code>race(effects)</code>",id:"raceeffects",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-11",level:4},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-17",level:4},{value:"<code>race([...effects]) (\u5e26\u6570\u7ec4)</code>",id:"raceeffects-\u5e26\u6570\u7ec4",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-12",level:4},{value:"<code>all([...effects]) - \u5e76\u884c\u6548\u679c</code>",id:"alleffects---\u5e76\u884c\u6548\u679c",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-13",level:4},{value:"<code>all(effects)</code>",id:"alleffects",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-14",level:4},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-18",level:4},{value:"\u63a5\u53e3",id:"\u63a5\u53e3",level:2},{value:"\u4efb\u52a1",id:"\u4efb\u52a1",level:3},{value:"\u901a\u9053",id:"\u901a\u9053",level:3},{value:"\u7f13\u51b2\u533a",id:"\u7f13\u51b2\u533a",level:3},{value:"SagaMonitor",id:"sagamonitor",level:3},{value:"\u5916\u90e8 API",id:"\u5916\u90e8-api",level:2},{value:"<code>runSaga(options, saga, ...args)</code>",id:"runsagaoptions-saga-args",level:3},{value:"\u6ce8\u91ca",id:"\u6ce8\u91ca-19",level:4},{value:"\u5b9e\u7528\u5de5\u5177",id:"\u5b9e\u7528\u5de5\u5177",level:2},{value:"<code>channel([buffer])</code>",id:"channelbuffer",level:3},{value:"<code>eventChannel(subscribe, [buffer])</code>",id:"eventchannelsubscribe-buffer",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-15",level:4},{value:"<code>buffers</code>",id:"buffers",level:3},{value:"<code>cloneableGenerator(generatorFunc)</code>",id:"cloneablegeneratorgeneratorfunc",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-16",level:4},{value:"<code>createMockTask()</code>",id:"createmocktask",level:3},{value:"\u901f\u67e5\u8868",id:"\u901f\u67e5\u8868",level:2},{value:"\u963b\u585e / \u975e\u963b\u585e",id:"\u963b\u585e--\u975e\u963b\u585e",level:3}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.h1,{id:"api-\u53c2\u8003",children:"API \u53c2\u8003"}),"\n",(0,c.jsx)(n.h2,{id:"\u4e2d\u95f4\u4ef6-api",children:"\u4e2d\u95f4\u4ef6 API"}),"\n",(0,c.jsx)(n.h3,{id:"createsagamiddlewareoptions",children:(0,c.jsx)(n.code,{children:"createSagaMiddleware(options)"})}),"\n",(0,c.jsx)(n.p,{children:"\u521b\u5efa\u4e00\u4e2a Redux \u4e2d\u95f4\u4ef6\u5e76\u5c06 Sagas \u8fde\u63a5\u5230 Redux Store"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"options: Object"})," - \u4f20\u9012\u7ed9\u4e2d\u95f4\u4ef6\u7684\u9009\u9879\u5217\u8868\u3002\u76ee\u524d\u652f\u6301\u7684\u9009\u9879\u6709\uff1a","\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"context: Object"})," - saga \u7684\u521d\u59cb\u4e0a\u4e0b\u6587\u503c\u3002"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"sagaMonitor"})," : ",(0,c.jsx)(n.a,{href:"#sagamonitor",children:"SagaMonitor"})," - \u5982\u679c\u63d0\u4f9b\u4e86 Saga Monitor\uff0c\u4e2d\u95f4\u4ef6\u5c06\u5411\u76d1\u89c6\u5668\u4f20\u9012\u76d1\u89c6\u4e8b\u4ef6\u3002"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"onError: (error: Error, { sagaStack: string })"})," - \u5982\u679c\u63d0\u4f9b\uff0c\u4e2d\u95f4\u4ef6\u5c06\u7528 Sagas \u7684\u672a\u6355\u83b7\u9519\u8bef\u8c03\u7528\u5b83\u3002\u5bf9\u4e8e\u5c06\u672a\u6355\u83b7\u7684\u5f02\u5e38\u53d1\u9001\u5230\u9519\u8bef\u8ddf\u8e2a\u670d\u52a1\u5f88\u6709\u7528\u3002"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"effectMiddlewares"})," : Function [] - \u5141\u8bb8\u4f60\u62e6\u622a\u4efb\u4f55\u6548\u679c\uff0c\u81ea\u5df1\u89e3\u51b3\u5b83\u5e76\u4f20\u9012\u7ed9\u4e0b\u4e00\u4e2a\u4e2d\u95f4\u4ef6\u3002\u8be6\u7ec6\u793a\u4f8b\u8bf7\u53c2\u89c1",(0,c.jsx)(n.a,{href:"/redux-toolkit-zh/redux-saga/advanced/Testing#effectmiddlewares",children:"\u6b64\u90e8\u5206"})]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"channel"}),": \u5982\u679c\u63d0\u4f9b\uff0c\u4e2d\u95f4\u4ef6\u5c06\u4f7f\u7528\u6b64\u901a\u9053\u800c\u4e0d\u662f\u9ed8\u8ba4\u7684 ",(0,c.jsx)(n.code,{children:"stdChannel()"})," \u6765\u8fdb\u884c"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"take"})," \u548c ",(0,c.jsx)(n.code,{children:"put"})," \u6548\u679c\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b",children:"\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.p,{children:["\u4e0b\u9762\u6211\u4eec\u5c06\u521b\u5efa\u4e00\u4e2a\u51fd\u6570 ",(0,c.jsx)(n.code,{children:"configureStore"}),"\uff0c\u5b83\u5c06\u901a\u8fc7\u4e00\u4e2a\u65b0\u7684\u65b9\u6cd5 ",(0,c.jsx)(n.code,{children:"runSaga"})," \u6765\u589e\u5f3a Store\u3002\u7136\u540e\u5728\u6211\u4eec\u7684\u4e3b\u6a21\u5757\u4e2d\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u8be5\u65b9\u6cd5\u6765\u542f\u52a8\u5e94\u7528\u7a0b\u5e8f\u7684 root Saga\u3002"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"configureStore.js"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import createSagaMiddleware from 'redux-saga'\r\nimport reducer from './path/to/reducer'\r\n\r\nexport default function configureStore(initialState) {\r\n  // \u6ce8\u610f\uff1a\u5c06\u4e2d\u95f4\u4ef6\u4f5c\u4e3a\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u4f20\u9012\u7ed9 createStore \u9700\u8981 redux@>=3.1.0\r\n  const sagaMiddleware = createSagaMiddleware()\r\n  return {\r\n    ...createStore(reducer, initialState, applyMiddleware(/* \u5176\u4ed6\u4e2d\u95f4\u4ef6, */sagaMiddleware)),\r\n    runSaga: sagaMiddleware.run\r\n  }\r\n}\n"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"main.js"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import configureStore from './configureStore'\r\nimport rootSaga from './sagas'\r\n// ... \u5176\u4ed6\u5bfc\u5165\r\n\r\nconst store = configureStore()\r\nstore.runSaga(rootSaga)\n"})}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:["\u6709\u5173 ",(0,c.jsx)(n.code,{children:"sagaMiddleware.run"})," \u65b9\u6cd5\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u4e0b\u9762\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"middlewarerunsaga-args",children:(0,c.jsx)(n.code,{children:"middleware.run(saga, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u52a8\u6001\u8fd0\u884c ",(0,c.jsx)(n.code,{children:"saga"}),"\u3002\u53ea\u80fd\u5728 ",(0,c.jsx)(n.code,{children:"applyMiddleware"})," \u9636\u6bb5",(0,c.jsx)(n.strong,{children:"\u4e4b\u540e"}),"\u8fd0\u884c Sagas\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"saga: Function"}),": \u4e00\u4e2a\u751f\u6210\u5668\u51fd\u6570"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"args: Array<any>"}),": \u63d0\u4f9b\u7ed9 ",(0,c.jsx)(n.code,{children:"saga"})," \u7684\u53c2\u6570"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u8be5\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a ",(0,c.jsx)(n.a,{href:"#task-descriptor",children:"\u4efb\u52a1\u63cf\u8ff0\u7b26"}),"\u3002"]}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-1",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"saga"})," \u5fc5\u987b\u662f\u4e00\u4e2a\u8fd4\u56de ",(0,c.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator",children:"\u751f\u6210\u5668\u5bf9\u8c61"}),"\u7684\u51fd\u6570\u3002\u7136\u540e\uff0c\u4e2d\u95f4\u4ef6\u5c06\u904d\u5386\u751f\u6210\u5668\u5e76\u6267\u884c\u6240\u6709\u4ea7\u751f\u7684\u6548\u679c\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"saga"})," \u4e5f\u53ef\u4ee5\u4f7f\u7528\u5e93\u63d0\u4f9b\u7684\u5404\u79cd\u6548\u679c\u542f\u52a8\u5176\u4ed6 sagas\u3002\u4e0b\u9762\u63cf\u8ff0\u7684\u8fed\u4ee3\u8fc7\u7a0b\u4e5f\u9002\u7528\u4e8e\u6240\u6709\u5b50 sagas\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u5728\u7b2c\u4e00\u6b21\u8fed\u4ee3\u4e2d\uff0c\u4e2d\u95f4\u4ef6\u8c03\u7528 ",(0,c.jsx)(n.code,{children:"next()"})," \u65b9\u6cd5\u6765\u83b7\u53d6\u4e0b\u4e00\u4e2a\u6548\u679c\u3002\u7136\u540e\uff0c\u4e2d\u95f4\u4ef6\u6267\u884c\u7531\u4e0b\u9762\u7684 Effects API \u6307\u5b9a\u7684\u4ea7\u751f\u7684\u6548\u679c\u3002\u540c\u65f6\uff0c\u751f\u6210\u5668\u5c06\u88ab\u6302\u8d77\uff0c\u76f4\u5230\u6548\u679c\u6267\u884c\u7ed3\u675f\u3002\u5728\u63a5\u6536\u5230\u6267\u884c\u7ed3\u679c\u540e\uff0c\u4e2d\u95f4\u4ef6\u5728\u751f\u6210\u5668\u4e0a\u8c03\u7528 ",(0,c.jsx)(n.code,{children:"next(result)"}),"\uff0c\u5e76\u5c06\u68c0\u7d22\u5230\u7684\u7ed3\u679c\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u91cd\u590d\uff0c\u76f4\u5230\u751f\u6210\u5668\u6b63\u5e38\u7ec8\u6b62\u6216\u629b\u51fa\u4e00\u4e9b\u9519\u8bef\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c\u6267\u884c\u7ed3\u679c\u662f\u4e00\u4e2a\u9519\u8bef\uff08\u5982\u6bcf\u4e2a Effect \u521b\u5efa\u8005\u6240\u6307\u5b9a\u7684\uff09\uff0c\u90a3\u4e48\u5c06\u8c03\u7528\u751f\u6210\u5668\u7684 ",(0,c.jsx)(n.code,{children:"throw(error)"})," \u65b9\u6cd5\u3002\u5982\u679c\u751f\u6210\u5668\u51fd\u6570\u5b9a\u4e49\u4e86\u4e00\u4e2a ",(0,c.jsx)(n.code,{children:"try/catch"})," \u6765\u5305\u56f4\u5f53\u524d\u7684 yield \u6307\u4ee4\uff0c\u90a3\u4e48\u5e95\u5c42\u7684\u751f\u6210\u5668\u8fd0\u884c\u65f6\u5c06\u8c03\u7528 ",(0,c.jsx)(n.code,{children:"catch"})," \u5757\u3002\u8fd0\u884c\u65f6\u4e5f\u5c06\u8c03\u7528\u4efb\u4f55\u5bf9\u5e94\u7684 finally \u5757\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u5728\u53d6\u6d88 Saga \u7684\u60c5\u51b5\u4e0b\uff08\u65e0\u8bba\u662f\u624b\u52a8\u8fd8\u662f\u4f7f\u7528\u63d0\u4f9b\u7684\u6548\u679c\uff09\uff0c\u4e2d\u95f4\u4ef6\u5c06\u8c03\u7528\u751f\u6210\u5668\u7684 ",(0,c.jsx)(n.code,{children:"return()"})," \u65b9\u6cd5\u3002\u8fd9\u5c06\u5bfc\u81f4\u751f\u6210\u5668\u76f4\u63a5\u8df3\u5230 finally \u5757\u3002"]}),"\n",(0,c.jsx)(n.h2,{id:"\u6548\u679c\u521b\u5efa\u8005",children:"\u6548\u679c\u521b\u5efa\u8005"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:"\u6ce8\u91ca\uff1a"}),"\n"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"\u4e0b\u9762\u7684\u6bcf\u4e2a\u51fd\u6570\u90fd\u8fd4\u56de\u4e00\u4e2a\u666e\u901a\u7684 JavaScript \u5bf9\u8c61\uff0c\u5e76\u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\u3002"}),"\n",(0,c.jsx)(n.li,{children:"\u6267\u884c\u662f\u7531\u4e2d\u95f4\u4ef6\u5728\u4e0a\u8ff0\u7684\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u8fdb\u884c\u7684\u3002"}),"\n",(0,c.jsx)(n.li,{children:"\u4e2d\u95f4\u4ef6\u68c0\u67e5\u6bcf\u4e2a\u6548\u679c\u63cf\u8ff0\u5e76\u6267\u884c\u9002\u5f53\u7684\u64cd\u4f5c\u3002"}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"takepattern",children:(0,c.jsx)(n.code,{children:"take(pattern)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u521b\u5efa\u4e00\u4e2a Effect \u63cf\u8ff0\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u7b49\u5f85 Store \u4e0a\u7684\u6307\u5b9a\u64cd\u4f5c\u3002\r\n\u751f\u6210\u5668\u5c06\u6302\u8d77\uff0c\u76f4\u5230\u5206\u6d3e\u4e00\u4e2a\u4e0e ",(0,c.jsx)(n.code,{children:"pattern"})," \u5339\u914d\u7684\u64cd\u4f5c\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"yield take(pattern)"})," \u7684\u7ed3\u679c\u662f\u6b63\u5728\u5206\u6d3e\u7684\u64cd\u4f5c\u5bf9\u8c61\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"pattern"})," \u6309\u7167\u4ee5\u4e0b\u89c4\u5219\u89e3\u91ca\uff1a"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c\u6ca1\u6709\u53c2\u6570\u6216 ",(0,c.jsx)(n.code,{children:"'*'"})," \u8c03\u7528 ",(0,c.jsx)(n.code,{children:"take"}),"\uff0c\u5219\u6240\u6709\u5206\u6d3e\u7684\u64cd\u4f5c\u90fd\u5c06\u5339\u914d\uff08\u4f8b\u5982\uff0c",(0,c.jsx)(n.code,{children:"take()"})," \u5c06\u5339\u914d\u6240\u6709\u64cd\u4f5c\uff09"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c\u5b83\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u90a3\u4e48\u5982\u679c ",(0,c.jsx)(n.code,{children:"pattern(action)"})," \u4e3a\u771f\uff0c\u5219\u64cd\u4f5c\u5339\u914d\uff08\u4f8b\u5982\uff0c",(0,c.jsx)(n.code,{children:"take(action => action.entities)"})," \u5c06\u5339\u914d\u6240\u6709\u5177\u6709\uff08\u771f\u5b9e\u7684\uff09",(0,c.jsx)(n.code,{children:"entities"})," \u5b57\u6bb5\u7684\u64cd\u4f5c\u3002\uff09"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u6ce8\u610f\uff1a\u5982\u679c\u5728\u6a21\u5f0f\u51fd\u6570\u4e0a\u5b9a\u4e49\u4e86 ",(0,c.jsx)(n.code,{children:"toString"}),"\uff0c\u5219\u5c06 ",(0,c.jsx)(n.code,{children:"action.type"})," \u6d4b\u8bd5\u4e3a ",(0,c.jsx)(n.code,{children:"pattern.toString()"}),"\u3002\u5982\u679c\u4f60\u6b63\u5728\u4f7f\u7528\u50cf redux-act \u6216 redux-actions \u8fd9\u6837\u7684\u64cd\u4f5c\u521b\u5efa\u5e93\uff0c\u8fd9\u5c06\u975e\u5e38\u6709\u7528\u3002"]}),"\n"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c\u5b83\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48\u5982\u679c ",(0,c.jsx)(n.code,{children:"action.type === pattern"}),"\uff0c\u5219\u64cd\u4f5c\u5339\u914d\uff08\u4f8b\u5982\uff0c",(0,c.jsx)(n.code,{children:"take(INCREMENT_ASYNC)"}),"\uff09"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c\u5b83\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u90a3\u4e48\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e00\u9879\u90fd\u4e0e\u4e0a\u8ff0\u89c4\u5219\u5339\u914d\uff0c\u56e0\u6b64\u652f\u6301\u5b57\u7b26\u4e32\u548c\u51fd\u6570\u8c13\u8bcd\u7684\u6df7\u5408\u6570\u7ec4\u3002\u6700\u5e38\u89c1\u7684\u7528\u4f8b\u662f\u5b57\u7b26\u4e32\u6570\u7ec4\uff0c\u56e0\u6b64 ",(0,c.jsx)(n.code,{children:"action.type"})," \u4e0e\u6570\u7ec4\u4e2d\u7684\u6240\u6709\u9879\u5339\u914d\uff08\u4f8b\u5982\uff0c",(0,c.jsx)(n.code,{children:"take([INCREMENT, DECREMENT])"}),"\uff0c\u8fd9\u5c06\u5339\u914d\u7c7b\u578b\u4e3a ",(0,c.jsx)(n.code,{children:"INCREMENT"})," \u6216 ",(0,c.jsx)(n.code,{children:"DECREMENT"})," \u7684\u4efb\u4f55\u64cd\u4f5c\uff09\u3002"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u4e2d\u95f4\u4ef6\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7279\u6b8a\u7684\u64cd\u4f5c ",(0,c.jsx)(n.code,{children:"END"}),"\u3002\u5982\u679c\u4f60\u5206\u6d3e END \u64cd\u4f5c\uff0c\u90a3\u4e48\u6240\u6709\u5728 take Effect \u4e0a\u963b\u585e\u7684 Sagas \u5c06\u88ab\u7ec8\u6b62\uff0c\u65e0\u8bba\u6307\u5b9a\u7684\u6a21\u5f0f\u5982\u4f55\u3002\u5982\u679c\u88ab\u7ec8\u6b62\u7684 Saga \u4ecd\u7136\u6709\u4e00\u4e9b\u6b63\u5728\u8fd0\u884c\u7684 forked \u4efb\u52a1\uff0c\u5b83\u5c06\u7b49\u5f85\u6240\u6709\u5b50\u4efb\u52a1\u7ec8\u6b62\u540e\u518d\u7ec8\u6b62\u4efb\u52a1\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"takemaybepattern",children:(0,c.jsx)(n.code,{children:"takeMaybe(pattern)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4e0e ",(0,c.jsx)(n.code,{children:"take(pattern)"})," \u76f8\u540c\uff0c\u4f46\u5728 ",(0,c.jsx)(n.code,{children:"END"})," \u64cd\u4f5c\u4e0a\u4e0d\u4f1a\u81ea\u52a8\u7ec8\u6b62 Saga\u3002\u76f8\u53cd\uff0c\u6240\u6709\u5728 take Effect \u4e0a\u963b\u585e\u7684 Sagas \u5c06\u5f97\u5230 ",(0,c.jsx)(n.code,{children:"END"})," \u5bf9\u8c61\u3002"]}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-2",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"takeMaybe"})," \u7684\u540d\u5b57\u6765\u81ea FP \u7c7b\u6bd4 - \u5b83\u5c31\u50cf\u6211\u4eec\u53ef\u4ee5\u6709 ",(0,c.jsx)(n.code,{children:"Maybe(ACTION)"})," \u7c7b\u578b\u7684\u8fd4\u56de\u7c7b\u578b\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5904\u7406\u4e24\u79cd\u60c5\u51b5\uff1a"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\u6709 ",(0,c.jsx)(n.code,{children:"Just(ACTION)"}),"\uff08\u6211\u4eec\u6709\u4e00\u4e2a\u64cd\u4f5c\uff09\u7684\u60c5\u51b5"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"NOTHING"}),"\uff08\u901a\u9053\u5df2\u5173\u95ed*\uff09\u7684\u60c5\u51b5\u3002\u5373\u6211\u4eec\u9700\u8981\u67d0\u79cd\u65b9\u5f0f\u6765\u6620\u5c04 ",(0,c.jsx)(n.code,{children:"END"})]}),"\n"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\u5185\u90e8\u6240\u6709 ",(0,c.jsx)(n.code,{children:"dispatch"})," \u7684\u64cd\u4f5c\u90fd\u901a\u8fc7 ",(0,c.jsx)(n.code,{children:"stdChannel"})," \u8fdb\u884c\uff0c\u5f53 ",(0,c.jsx)(n.code,{children:"dispatch(END)"})," \u53d1\u751f\u65f6\uff0c",(0,c.jsx)(n.code,{children:"stdChannel"})," \u5c06\u88ab\u5173\u95ed"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"takechannel",children:(0,c.jsx)(n.code,{children:"take(channel)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u521b\u5efa\u4e00\u4e2a Effect \u63cf\u8ff0\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u7b49\u5f85\u4ece\u63d0\u4f9b\u7684 Channel \u63a5\u6536\u6307\u5b9a\u7684\u6d88\u606f\u3002\u5982\u679c\u901a\u9053\u5df2\u7ecf\u5173\u95ed\uff0c\u90a3\u4e48\u751f\u6210\u5668\u5c06\u7acb\u5373\u7ec8\u6b62\uff0c\u8fc7\u7a0b\u4e0e\u4e0a\u8ff0 ",(0,c.jsx)(n.code,{children:"take(pattern)"})," \u63cf\u8ff0\u7684\u76f8\u540c\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"takemaybechannel",children:(0,c.jsx)(n.code,{children:"takeMaybe(channel)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4e0e ",(0,c.jsx)(n.code,{children:"take(channel)"})," \u76f8\u540c\uff0c\u4f46\u5728 ",(0,c.jsx)(n.code,{children:"END"})," \u64cd\u4f5c\u4e0a\u4e0d\u4f1a\u81ea\u52a8\u7ec8\u6b62 Saga\u3002\u76f8\u53cd\uff0c\u6240\u6709\u5728 take Effect \u4e0a\u963b\u585e\u7684 Sagas \u5c06\u5f97\u5230 ",(0,c.jsx)(n.code,{children:"END"})," \u5bf9\u8c61\u3002\u67e5\u770b\u66f4\u591a",(0,c.jsx)(n.a,{href:"#takemaybepattern",children:"\u8fd9\u91cc"})]}),"\n",(0,c.jsx)(n.h3,{id:"takeeverypattern-saga-args",children:(0,c.jsx)(n.code,{children:"takeEvery(pattern, saga, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5728\u6bcf\u4e2a\u5206\u6d3e\u5230 Store \u7684\u4e0e ",(0,c.jsx)(n.code,{children:"pattern"})," \u5339\u914d\u7684\u64cd\u4f5c\u4e0a\u751f\u6210\u4e00\u4e2a ",(0,c.jsx)(n.code,{children:"saga"}),"\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"pattern: String | Array | Function"})," - \u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u9605 ",(0,c.jsx)(n.a,{href:"#takepattern",children:(0,c.jsx)(n.code,{children:"take(pattern)"})})," \u7684\u6587\u6863"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"saga: Function"})," - \u4e00\u4e2a\u751f\u6210\u5668\u51fd\u6570"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"args: Array<any>"})," - \u8981\u4f20\u9012\u7ed9\u542f\u52a8\u4efb\u52a1\u7684\u53c2\u6570\u3002",(0,c.jsx)(n.code,{children:"takeEvery"})," \u5c06\u5c06\u4f20\u5165\u7684\u64cd\u4f5c\u6dfb\u52a0\u5230\u53c2\u6570\u5217\u8868\u4e2d\uff08\u5373\uff0c\u64cd\u4f5c\u5c06\u662f\u63d0\u4f9b\u7ed9 ",(0,c.jsx)(n.code,{children:"saga"})," \u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\uff09"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-1",children:"\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.p,{children:["\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u57fa\u672c\u4efb\u52a1 ",(0,c.jsx)(n.code,{children:"fetchUser"}),"\u3002\u6211\u4eec\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"takeEvery"})," \u5728\u6bcf\u4e2a\u5206\u6d3e\u7684 ",(0,c.jsx)(n.code,{children:"USER_REQUESTED"})," \u64cd\u4f5c\u4e0a\u542f\u52a8\u4e00\u4e2a\u65b0\u7684 ",(0,c.jsx)(n.code,{children:"fetchUser"})," \u4efb\u52a1\uff1a"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import { takeEvery } from `redux-saga/effects`\r\n\r\nfunction* fetchUser(action) {\r\n  ...\r\n}\r\n\r\nfunction* watchFetchUser() {\r\n  yield takeEvery('USER_REQUESTED', fetchUser)\r\n}\n"})}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-3",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"takeEvery"})," \u662f\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"take"})," \u548c ",(0,c.jsx)(n.code,{children:"fork"})," \u6784\u5efa\u7684\u9ad8\u7ea7 API\u3002\u4ee5\u4e0b\u662f\u5982\u4f55\u4f7f\u7528\u4f4e\u7ea7\u6548\u679c\u5b9e\u73b0\u5e2e\u52a9\u5668"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"const takeEvery = (patternOrChannel, saga, ...args) => fork(function*() {\r\n  while (true) {\r\n    const action = yield take(patternOrChannel)\r\n    yield fork(saga, ...args.concat(action))\r\n  }\r\n})\n"})}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"takeEvery"})," \u5141\u8bb8\u5904\u7406\u5e76\u53d1\u64cd\u4f5c\u3002\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u5f53\u5206\u6d3e\u4e00\u4e2a ",(0,c.jsx)(n.code,{children:"USER_REQUESTED"}),"\r\n\u64cd\u4f5c\u65f6\uff0c\u5373\u4f7f\u524d\u4e00\u4e2a ",(0,c.jsx)(n.code,{children:"fetchUser"})," \u4ecd\u5728\u7b49\u5f85\uff0c\u4e5f\u4f1a\u542f\u52a8\u4e00\u4e2a\u65b0\u7684 ",(0,c.jsx)(n.code,{children:"fetchUser"})," \u4efb\u52a1\r\n\uff08\u4f8b\u5982\uff0c\u7528\u6237\u8fde\u7eed\u4e24\u6b21\u5feb\u901f\u70b9\u51fb ",(0,c.jsx)(n.code,{children:"Load User"})," \u6309\u94ae\uff0c\u7b2c\u4e8c\u6b21\r\n\u70b9\u51fb\u5c06\u5206\u6d3e\u4e00\u4e2a ",(0,c.jsx)(n.code,{children:"USER_REQUESTED"})," \u64cd\u4f5c\uff0c\u800c\u5728\u7b2c\u4e00\u6b21\u89e6\u53d1\u7684 ",(0,c.jsx)(n.code,{children:"fetchUser"})," \u8fd8\u6ca1\u6709\u7ec8\u6b62\uff09"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"takeEvery"})," \u4e0d\u5904\u7406\u4efb\u52a1\u7684\u4e71\u5e8f\u54cd\u5e94\u3002\u4e0d\u80fd\u4fdd\u8bc1\u4efb\u52a1\u5c06\r\n\u6309\u7167\u5b83\u4eec\u5f00\u59cb\u7684\u987a\u5e8f\u7ec8\u6b62\u3002\u8981\u5904\u7406\u4e71\u5e8f\u54cd\u5e94\uff0c\u4f60\u53ef\u4ee5\u8003\u8651\u4e0b\u9762\u7684 ",(0,c.jsx)(n.code,{children:"takeLatest"}),"\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"takeeverychannel-saga-args",children:(0,c.jsx)(n.code,{children:"takeEvery(channel, saga, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4f60\u4e5f\u53ef\u4ee5\u5c06\u901a\u9053\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\uff0c\u5176\u884c\u4e3a\u4e0e ",(0,c.jsx)(n.a,{href:"#takeeverypattern-saga-args",children:"takeEvery(pattern, saga, ...args)"})," \u76f8\u540c\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"takelatestpattern-saga-args",children:(0,c.jsx)(n.code,{children:"takeLatest(pattern, saga, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5bf9\u4e8e\u5339\u914d ",(0,c.jsx)(n.code,{children:"pattern"})," \u7684\u6bcf\u4e2a\u6d3e\u53d1\u5230 Store \u7684\u52a8\u4f5c\uff0c\u90fd\u4f1a\u89e6\u53d1\u4e00\u4e2a ",(0,c.jsx)(n.code,{children:"saga"}),"\u3002\u5e76\u81ea\u52a8\u53d6\u6d88\r\n\u4efb\u4f55\u4e4b\u524d\u542f\u52a8\u7684\u4ecd\u5728\u8fd0\u884c\u7684 ",(0,c.jsx)(n.code,{children:"saga"})," \u4efb\u52a1\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u6bcf\u6b21\u52a8\u4f5c\u88ab\u6d3e\u53d1\u5230 store\u3002\u5982\u679c\u6b64\u52a8\u4f5c\u5339\u914d ",(0,c.jsx)(n.code,{children:"pattern"}),"\uff0c",(0,c.jsx)(n.code,{children:"takeLatest"}),"\r\n\u4f1a\u5728\u540e\u53f0\u542f\u52a8\u4e00\u4e2a\u65b0\u7684 ",(0,c.jsx)(n.code,{children:"saga"})," \u4efb\u52a1\u3002\u5982\u679c\u4e4b\u524d\u542f\u52a8\u4e86\u4e00\u4e2a ",(0,c.jsx)(n.code,{children:"saga"})," \u4efb\u52a1\uff08\u5728\u5b9e\u9645\u52a8\u4f5c\u4e4b\u524d\u6d3e\u53d1\u7684\u6700\u540e\u4e00\u4e2a\u52a8\u4f5c\uff09\uff0c\u5e76\u4e14\u6b64\u4efb\u52a1\u4ecd\u5728\u8fd0\u884c\uff0c\u90a3\u4e48\u8be5\u4efb\u52a1\u5c06\u88ab\u53d6\u6d88\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"pattern: String | Array | Function"})," - \u66f4\u591a\u4fe1\u606f\u8bf7\u67e5\u770b ",(0,c.jsx)(n.a,{href:"#takepattern",children:(0,c.jsx)(n.code,{children:"take(pattern)"})})," \u7684\u6587\u6863"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"saga: Function"})," - \u4e00\u4e2a Generator \u51fd\u6570"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"args: Array<any>"})," - \u8981\u4f20\u9012\u7ed9\u542f\u52a8\u4efb\u52a1\u7684\u53c2\u6570\u3002",(0,c.jsx)(n.code,{children:"takeLatest"})," \u4f1a\u5c06\r\n\u4f20\u5165\u7684\u52a8\u4f5c\u6dfb\u52a0\u5230\u53c2\u6570\u5217\u8868\u4e2d\uff08\u5373\uff0c\u52a8\u4f5c\u5c06\u662f\u63d0\u4f9b\u7ed9 ",(0,c.jsx)(n.code,{children:"saga"})," \u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\uff09"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-2",children:"\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.p,{children:["\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u57fa\u672c\u4efb\u52a1 ",(0,c.jsx)(n.code,{children:"fetchUser"}),"\u3002\u6211\u4eec\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"takeLatest"})," \u6765\r\n\u5728\u6bcf\u4e2a\u6d3e\u53d1\u7684 ",(0,c.jsx)(n.code,{children:"USER_REQUESTED"})," \u52a8\u4f5c\u4e0a\u542f\u52a8\u4e00\u4e2a\u65b0\u7684 ",(0,c.jsx)(n.code,{children:"fetchUser"})," \u4efb\u52a1\u3002\u7531\u4e8e ",(0,c.jsx)(n.code,{children:"takeLatest"}),"\r\n\u4f1a\u53d6\u6d88\u4e4b\u524d\u542f\u52a8\u7684\u4efb\u4f55\u5f85\u5904\u7406\u4efb\u52a1\uff0c\u6211\u4eec\u786e\u4fdd\u5982\u679c\u7528\u6237\u5feb\u901f\u8fde\u7eed\u89e6\u53d1\u591a\u4e2a ",(0,c.jsx)(n.code,{children:"USER_REQUESTED"})," \u52a8\u4f5c\uff0c\u6211\u4eec\u53ea\u4f1a\u5904\u7406\u6700\u65b0\u7684\u52a8\u4f5c"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import { takeLatest } from `redux-saga/effects`\r\n\r\nfunction* fetchUser(action) {\r\n  ...\r\n}\r\n\r\nfunction* watchLastFetchUser() {\r\n  yield takeLatest('USER_REQUESTED', fetchUser)\r\n}\n"})}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-4",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"takeLatest"})," \u662f\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"take"})," \u548c ",(0,c.jsx)(n.code,{children:"fork"})," \u6784\u5efa\u7684\u9ad8\u7ea7 API\u3002\u4ee5\u4e0b\u662f\u5982\u4f55\u4f7f\u7528\u4f4e\u7ea7\u6548\u679c\u5b9e\u73b0\u8be5\u52a9\u624b\u7684\u65b9\u6cd5"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"const takeLatest = (patternOrChannel, saga, ...args) => fork(function*() {\r\n  let lastTask\r\n  while (true) {\r\n    const action = yield take(patternOrChannel)\r\n    if (lastTask) {\r\n      yield cancel(lastTask) // \u5982\u679c\u4efb\u52a1\u5df2\u7ecf\u7ed3\u675f\uff0c\u53d6\u6d88\u64cd\u4f5c\u65e0\u6548\r\n    }\r\n    lastTask = yield fork(saga, ...args.concat(action))\r\n  }\r\n})\n"})}),"\n",(0,c.jsx)(n.h3,{id:"takelatestchannel-saga-args",children:(0,c.jsx)(n.code,{children:"takeLatest(channel, saga, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4f60\u4e5f\u53ef\u4ee5\u5c06\u901a\u9053\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\uff0c\u5176\u884c\u4e3a\u4e0e ",(0,c.jsx)(n.a,{href:"#takelatestpattern-saga-args",children:"takeLatest(pattern, saga, ...args)"})," \u76f8\u540c\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"takeleadingpattern-saga-args",children:(0,c.jsx)(n.code,{children:"takeLeading(pattern, saga, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5bf9\u4e8e\u5339\u914d ",(0,c.jsx)(n.code,{children:"pattern"})," \u7684\u6bcf\u4e2a\u6d3e\u53d1\u5230 Store \u7684\u52a8\u4f5c\uff0c\u90fd\u4f1a\u89e6\u53d1\u4e00\u4e2a ",(0,c.jsx)(n.code,{children:"saga"}),"\u3002\r\n\u5728\u89e6\u53d1\u4e00\u6b21\u4efb\u52a1\u540e\uff0c\u5b83\u4f1a\u963b\u585e\uff0c\u76f4\u5230\u89e6\u53d1\u7684 saga \u5b8c\u6210\uff0c\u7136\u540e\u518d\u5f00\u59cb\u76d1\u542c ",(0,c.jsx)(n.code,{children:"pattern"}),"\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u7b80\u800c\u8a00\u4e4b\uff0c",(0,c.jsx)(n.code,{children:"takeLeading"})," \u5728\u4e0d\u8fd0\u884c saga \u65f6\u76d1\u542c\u52a8\u4f5c\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"pattern: String | Array | Function"})," - \u66f4\u591a\u4fe1\u606f\u8bf7\u67e5\u770b ",(0,c.jsx)(n.a,{href:"#takepattern",children:(0,c.jsx)(n.code,{children:"take(pattern)"})})," \u7684\u6587\u6863"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"saga: Function"})," - \u4e00\u4e2a Generator \u51fd\u6570"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"args: Array<any>"})," - \u8981\u4f20\u9012\u7ed9\u542f\u52a8\u4efb\u52a1\u7684\u53c2\u6570\u3002",(0,c.jsx)(n.code,{children:"takeLeading"})," \u4f1a\u5c06\r\n\u4f20\u5165\u7684\u52a8\u4f5c\u6dfb\u52a0\u5230\u53c2\u6570\u5217\u8868\u4e2d\uff08\u5373\uff0c\u52a8\u4f5c\u5c06\u662f\u63d0\u4f9b\u7ed9 ",(0,c.jsx)(n.code,{children:"saga"})," \u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\uff09"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-3",children:"\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.p,{children:["\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u57fa\u672c\u4efb\u52a1 ",(0,c.jsx)(n.code,{children:"fetchUser"}),"\u3002\u6211\u4eec\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"takeLeading"})," \u6765\r\n\u5728\u6bcf\u4e2a\u6d3e\u53d1\u7684 ",(0,c.jsx)(n.code,{children:"USER_REQUESTED"})," \u52a8\u4f5c\u4e0a\u542f\u52a8\u4e00\u4e2a\u65b0\u7684 ",(0,c.jsx)(n.code,{children:"fetchUser"})," \u4efb\u52a1\u3002\u7531\u4e8e ",(0,c.jsx)(n.code,{children:"takeLeading"}),"\r\n\u5728\u542f\u52a8\u540e\u5ffd\u7565\u4efb\u4f55\u65b0\u7684\u4efb\u52a1\uff0c\u6211\u4eec\u786e\u4fdd\u5982\u679c\u7528\u6237\u5feb\u901f\u8fde\u7eed\u89e6\u53d1\u591a\u4e2a ",(0,c.jsx)(n.code,{children:"USER_REQUESTED"})," \u52a8\u4f5c\uff0c\u6211\u4eec\u53ea\u4f1a\u7ee7\u7eed\u8fd0\u884c\u9886\u5148\u7684\u52a8\u4f5c"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import { takeLeading } from `redux-saga/effects`\r\n\r\nfunction* fetchUser(action) {\r\n  ...\r\n}\r\n\r\nfunction* watchLastFetchUser() {\r\n  yield takeLeading('USER_REQUESTED', fetchUser)\r\n}\n"})}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-5",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"takeLeading"})," \u662f\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"take"})," \u548c ",(0,c.jsx)(n.code,{children:"call"})," \u6784\u5efa\u7684\u9ad8\u7ea7 API\u3002\u4ee5\u4e0b\u662f\u5982\u4f55\u4f7f\u7528\u4f4e\u7ea7\u6548\u679c\u5b9eplement\u8be5\u52a9\u624b\u7684\u65b9\u6cd5"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"const takeLeading = (patternOrChannel, saga, ...args) => fork(function*() {\r\n  while (true) {\r\n    const action = yield take(patternOrChannel);\r\n    yield call(saga, ...args.concat(action));\r\n  }\r\n})\n"})}),"\n",(0,c.jsx)(n.h3,{id:"takeleadingchannel-saga-args",children:(0,c.jsx)(n.code,{children:"takeLeading(channel, saga, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4f60\u4e5f\u53ef\u4ee5\u5c06\u901a\u9053\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\uff0c\u5176\u884c\u4e3a\u4e0e ",(0,c.jsx)(n.a,{href:"#takeleadingpattern-saga-args",children:"takeLeading(pattern, saga, ...args)"})," \u76f8\u540c\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"putaction",children:(0,c.jsx)(n.code,{children:"put(action)"})}),"\n",(0,c.jsx)(n.p,{children:"\u521b\u5efa\u4e00\u4e2a Effect \u63cf\u8ff0\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u5b89\u6392\u5c06\u4e00\u4e2a\u52a8\u4f5c\u5206\u6d3e\u5230\u5b58\u50a8\u5668\u3002\u8fd9\u4e2a\u5206\u6d3e\u53ef\u80fd\u4e0d\u4f1a\u7acb\u5373\u53d1\u751f\uff0c\u56e0\u4e3a saga \u4efb\u52a1\u961f\u5217\u4e2d\u53ef\u80fd\u8fd8\u6709\u5176\u4ed6\u4efb\u52a1\uff0c\u6216\u8005\u8fd8\u6709\u4efb\u52a1\u6b63\u5728\u8fdb\u884c\u4e2d\u3002"}),"\n",(0,c.jsxs)(n.p,{children:["\u7136\u800c\uff0c\u4f60\u53ef\u4ee5\u671f\u671b\u5728\u5f53\u524d\u7684\u5806\u6808\u5e27\uff08\u5373 ",(0,c.jsx)(n.code,{children:"yield put(action)"})," \u540e\u7684\u4e0b\u4e00\u884c\u4ee3\u7801\uff09\u4e2d\u66f4\u65b0\u5b58\u50a8\u5668\uff0c\u9664\u975e\u4f60\u6709\u5176\u4ed6\u7684 Redux \u4e2d\u95f4\u4ef6\uff0c\u5b83\u4eec\u6709\u5f02\u6b65\u6d41\u7a0b\uff0c\u8fd9\u4f1a\u5ef6\u8fdf\u52a8\u4f5c\u7684\u4f20\u64ad\u3002"]}),"\n",(0,c.jsx)(n.p,{children:"\u4e0b\u6e38\u9519\u8bef\uff08\u4f8b\u5982\uff0c\u6765\u81ea reducer \u7684\u9519\u8bef\uff09\u5c06\u88ab\u5192\u6ce1\u4e0a\u6765\u3002"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"action: Object"})," - ",(0,c.jsxs)(n.a,{href:"https://redux.js.org/api/store#dispatchaction",children:["\u67e5\u770b Redux ",(0,c.jsx)(n.code,{children:"dispatch"})," \u6587\u6863\u4ee5\u83b7\u53d6\u5b8c\u6574\u4fe1\u606f"]})]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"putresolveaction",children:(0,c.jsx)(n.code,{children:"putResolve(action)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5c31\u50cf ",(0,c.jsx)(n.a,{href:"#putaction",children:(0,c.jsx)(n.code,{children:"put"})})," \u4e00\u6837\uff0c\u4f46\u662f effect \u662f\u963b\u585e\u7684\uff08\u5982\u679c\u4ece ",(0,c.jsx)(n.code,{children:"dispatch"})," \u8fd4\u56de promise\uff0c\u5b83\u5c06\u7b49\u5f85\u5176\u89e3\u51b3\uff09\u5e76\u4e14\u4f1a\u5192\u6ce1\u4e0b\u6e38\u7684\u9519\u8bef\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"action: Object"})," - ",(0,c.jsxs)(n.a,{href:"https://redux.js.org/api/store/#dispatchaction",children:["\u67e5\u770b Redux ",(0,c.jsx)(n.code,{children:"dispatch"})," \u6587\u6863\u4ee5\u83b7\u53d6\u5b8c\u6574\u4fe1\u606f"]})]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"putchannel-action",children:(0,c.jsx)(n.code,{children:"put(channel, action)"})}),"\n",(0,c.jsx)(n.p,{children:"\u521b\u5efa\u4e00\u4e2a Effect \u63cf\u8ff0\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u5c06\u4e00\u4e2a\u52a8\u4f5c\u653e\u5165\u63d0\u4f9b\u7684\u901a\u9053\u4e2d\u3002"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"channel: Channel"})," - \u4e00\u4e2a ",(0,c.jsx)(n.a,{href:"#channel",children:(0,c.jsx)(n.code,{children:"Channel"})})," \u5bf9\u8c61\u3002"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"action: Object"})," - ",(0,c.jsxs)(n.a,{href:"https://redux.js.org/api/store/#dispatchaction",children:["\u67e5\u770b Redux ",(0,c.jsx)(n.code,{children:"dispatch"})," \u6587\u6863\u4ee5\u83b7\u53d6\u5b8c\u6574\u4fe1\u606f"]})]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c put ",(0,c.jsx)(n.em,{children:"\u4e0d"})," \u662f\u7f13\u51b2\u7684\uff0c\u800c\u662f\u7acb\u5373\u88ab takers \u6d88\u8d39\uff0c\u90a3\u4e48\u8fd9\u4e2a effect \u5c31\u662f\u963b\u585e\u7684\u3002\u5982\u679c\u5728\u8fd9\u4e9b takers \u4e2d\u629b\u51fa\u4e86\u4efb\u4f55\u9519\u8bef\uff0c\u5b83\u5c06\u5192\u6ce1\u56de saga\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"callfn-args",children:(0,c.jsx)(n.code,{children:"call(fn, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u521b\u5efa\u4e00\u4e2a Effect \u63cf\u8ff0\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u4ee5 ",(0,c.jsx)(n.code,{children:"args"})," \u4e3a\u53c2\u6570\u8c03\u7528\u51fd\u6570 ",(0,c.jsx)(n.code,{children:"fn"}),"\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"fn: Function"})," - \u4e00\u4e2a Generator \u51fd\u6570\uff0c\u6216\u8005\u662f\u4e00\u4e2a\u666e\u901a\u51fd\u6570\uff0c\u5b83\u8fd4\u56de\u4e00\u4e2a Promise \u4f5c\u4e3a\u7ed3\u679c\uff0c\u6216\u8005\u4efb\u4f55\u5176\u4ed6\u503c\u3002"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"args: Array<any>"})," - \u4e00\u4e2a\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9 ",(0,c.jsx)(n.code,{children:"fn"})," \u7684\u503c\u7684\u6570\u7ec4"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-6",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"fn"})," \u53ef\u4ee5\u662f\u4e00\u4e2a ",(0,c.jsx)(n.em,{children:"\u666e\u901a"})," \u51fd\u6570\u6216\u4e00\u4e2a Generator \u51fd\u6570\u3002"]}),"\n",(0,c.jsx)(n.p,{children:"\u4e2d\u95f4\u4ef6\u8c03\u7528\u51fd\u6570\u5e76\u68c0\u67e5\u5176\u7ed3\u679c\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u5982\u679c\u7ed3\u679c\u662f\u4e00\u4e2a\u8fed\u4ee3\u5668\u5bf9\u8c61\uff0c\u4e2d\u95f4\u4ef6\u5c06\u8fd0\u884c\u8be5 Generator \u51fd\u6570\uff0c\u5c31\u50cf\u5b83\u5bf9\u542f\u52a8\u7684 Generator \u505a\u7684\u90a3\u6837\uff08\u5728\u542f\u52a8\u65f6\u4f20\u9012\u7ed9\u4e2d\u95f4\u4ef6\uff09\u3002\u7236 Generator \u5c06\u88ab\u6302\u8d77\uff0c\u76f4\u5230\u5b50 Generator \u6b63\u5e38\u7ec8\u6b62\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7236 Generator \u5c06\u4ee5\u5b50 Generator \u8fd4\u56de\u7684\u503c\u6062\u590d\u3002\u6216\u8005\uff0c\u76f4\u5230\u5b50 Generator \u56e0\u67d0\u4e9b\u9519\u8bef\u800c\u4e2d\u6b62\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5c06\u5728\u7236 Generator \u5185\u90e8\u629b\u51fa\u4e00\u4e2a\u9519\u8bef\u3002"}),"\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c ",(0,c.jsx)(n.code,{children:"fn"})," \u662f\u4e00\u4e2a\u666e\u901a\u51fd\u6570\u5e76\u8fd4\u56de\u4e00\u4e2a Promise\uff0c\u4e2d\u95f4\u4ef6\u5c06\u6302\u8d77 Generator\uff0c\u76f4\u5230 Promise \u88ab\u89e3\u51b3\u3002\u5728 promise \u89e3\u51b3\u540e\uff0cGenerator \u4f1a\u4ee5\u89e3\u51b3\u7684\u503c\u6062\u590d\uff0c\u6216\u8005\u5982\u679c Promise \u88ab\u62d2\u7edd\uff0cGenerator \u5185\u90e8\u4f1a\u629b\u51fa\u4e00\u4e2a\u9519\u8bef\u3002"]}),"\n",(0,c.jsx)(n.p,{children:"\u5982\u679c\u7ed3\u679c\u65e2\u4e0d\u662f\u8fed\u4ee3\u5668\u5bf9\u8c61\u4e5f\u4e0d\u662f Promise\uff0c\u4e2d\u95f4\u4ef6\u5c06\u7acb\u5373\u5c06\u8be5\u503c\u8fd4\u56de\u7ed9 saga\uff0c\u4ee5\u4fbf\u5b83\u53ef\u4ee5\u540c\u6b65\u5730\u6062\u590d\u6267\u884c\u3002"}),"\n",(0,c.jsxs)(n.p,{children:["\u5f53\u5728 Generator \u5185\u90e8\u629b\u51fa\u4e00\u4e2a\u9519\u8bef\u65f6\uff0c\u5982\u679c\u5b83\u6709\u4e00\u4e2a ",(0,c.jsx)(n.code,{children:"try/catch"})," \u5757\u5305\u56f4\u5f53\u524d\u7684 ",(0,c.jsx)(n.code,{children:"yield"})," \u6307\u4ee4\uff0c\u63a7\u5236\u6743\u5c06\u88ab\u4f20\u9012\u7ed9 ",(0,c.jsx)(n.code,{children:"catch"})," \u5757\u3002\u5426\u5219\uff0cGenerator \u5c06\u4e2d\u6b62\u5e76\u629b\u51fa\u9519\u8bef\uff0c\u5982\u679c\u8fd9\u4e2a Generator \u662f\u7531\u53e6\u4e00\u4e2a Generator \u8c03\u7528\u7684\uff0c\u9519\u8bef\u5c06\u4f20\u64ad\u5230\u8c03\u7528\u7684 Generator\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"callcontext-fn-args",children:(0,c.jsx)(n.code,{children:"call([context, fn], ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4e0e ",(0,c.jsx)(n.code,{children:"call(fn, ...args)"})," \u76f8\u540c\uff0c\u4f46\u652f\u6301\u5c06 ",(0,c.jsx)(n.code,{children:"this"})," \u4e0a\u4e0b\u6587\u4f20\u9012\u7ed9 ",(0,c.jsx)(n.code,{children:"fn"}),"\u3002\u8fd9\u5bf9\u4e8e\u8c03\u7528\u5bf9\u8c61\u65b9\u6cd5\u5f88\u6709\u7528\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"callcontext-fnname-args",children:(0,c.jsx)(n.code,{children:"call([context, fnName], ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4e0e ",(0,c.jsx)(n.code,{children:"call([context, fn], ...args)"})," \u76f8\u540c\uff0c\u4f46\u652f\u6301\u5c06 ",(0,c.jsx)(n.code,{children:"fn"})," \u4f5c\u4e3a\u5b57\u7b26\u4e32\u4f20\u9012\u3002\u5bf9\u4e8e\u8c03\u7528\u5bf9\u8c61\u7684\u65b9\u6cd5\u5f88\u6709\u7528\uff0c\u4f8b\u5982 ",(0,c.jsx)(n.code,{children:"yield call([localStorage, 'getItem'], 'redux-saga')"}),"\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"callcontext-fn-args-1",children:(0,c.jsx)(n.code,{children:"call({context, fn}, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4e0e ",(0,c.jsx)(n.code,{children:"call([context, fn], ...args)"})," \u76f8\u540c\uff0c\u4f46\u652f\u6301\u5c06 ",(0,c.jsx)(n.code,{children:"context"})," \u548c ",(0,c.jsx)(n.code,{children:"fn"})," \u4f5c\u4e3a\u5bf9\u8c61\u7684\u5c5e\u6027\u4f20\u9012\uff0c\u4f8b\u5982 ",(0,c.jsx)(n.code,{children:"yield call({context: localStorage, fn: localStorage.getItem}, 'redux-saga')"}),"\u3002",(0,c.jsx)(n.code,{children:"fn"})," \u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\u6216\u51fd\u6570\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"applycontext-fn-args",children:(0,c.jsx)(n.code,{children:"apply(context, fn, [args])"})}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"call([context, fn], ...args)"})," \u7684\u522b\u540d\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"cpsfn-args",children:(0,c.jsx)(n.code,{children:"cps(fn, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u521b\u5efa\u4e00\u4e2a Effect \u63cf\u8ff0\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u4ee5 Node \u98ce\u683c\u7684\u51fd\u6570\u8c03\u7528 ",(0,c.jsx)(n.code,{children:"fn"}),"\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"fn: Function"})," - \u4e00\u4e2a Node \u98ce\u683c\u7684\u51fd\u6570\u3002\u5373\uff0c\u4e00\u4e2a\u51fd\u6570\uff0c\u9664\u4e86\u5b83\u7684\u53c2\u6570\u5916\uff0c\u8fd8\u63a5\u53d7\u4e00\u4e2a\u989d\u5916\u7684\u56de\u8c03\u51fd\u6570\uff0c\u5f53 ",(0,c.jsx)(n.code,{children:"fn"})," \u7ed3\u675f\u65f6\u88ab ",(0,c.jsx)(n.code,{children:"fn"})," \u8c03\u7528\u3002\u56de\u8c03\u51fd\u6570\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\uff0c\u5176\u4e2d\u7b2c\u4e00\u4e2a\u53c2\u6570\u7528\u4e8e\u62a5\u544a\u9519\u8bef\uff0c\u800c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u7528\u4e8e\u62a5\u544a\u6210\u529f\u7684\u7ed3\u679c\u3002"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"args: Array<any>"})," - \u4e00\u4e2a\u4f5c\u4e3a ",(0,c.jsx)(n.code,{children:"fn"})," \u7684\u53c2\u6570\u7684\u6570\u7ec4\u3002"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-7",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:["\u4e2d\u95f4\u4ef6\u5c06\u6267\u884c\u8c03\u7528 ",(0,c.jsx)(n.code,{children:"fn(...arg, cb)"}),"\u3002",(0,c.jsx)(n.code,{children:"cb"})," \u662f\u7531\u4e2d\u95f4\u4ef6\u4f20\u9012\u7ed9 ",(0,c.jsx)(n.code,{children:"fn"})," \u7684\u56de\u8c03\u3002\u5982\u679c ",(0,c.jsx)(n.code,{children:"fn"})," \u6b63\u5e38\u7ec8\u6b62\uff0c\u5b83\u5fc5\u987b\u8c03\u7528 ",(0,c.jsx)(n.code,{children:"cb(null, result)"})," \u6765\u901a\u77e5\u4e2d\u95f4\u4ef6\u6210\u529f\u7684\u7ed3\u679c\u3002\u5982\u679c ",(0,c.jsx)(n.code,{children:"fn"})," \u9047\u5230\u4e00\u4e9b\u9519\u8bef\uff0c\u90a3\u4e48\u5b83\u5fc5\u987b\u8c03\u7528 ",(0,c.jsx)(n.code,{children:"cb(error)"})," \u4ee5\u901a\u77e5\u4e2d\u95f4\u4ef6\u53d1\u751f\u4e86\u9519\u8bef\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u4e2d\u95f4\u4ef6\u5c06\u4fdd\u6301\u6302\u8d77\u72b6\u6001\uff0c\u76f4\u5230 ",(0,c.jsx)(n.code,{children:"fn"})," \u7ec8\u6b62\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"cpscontext-fn-args",children:(0,c.jsx)(n.code,{children:"cps([context, fn], ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u652f\u6301\u5c06 ",(0,c.jsx)(n.code,{children:"this"})," \u4e0a\u4e0b\u6587\u4f20\u9012\u7ed9 ",(0,c.jsx)(n.code,{children:"fn"}),"\uff08\u5bf9\u8c61\u65b9\u6cd5\u8c03\u7528\uff09"]}),"\n",(0,c.jsx)(n.h3,{id:"cpscontext-fn-args-1",children:(0,c.jsx)(n.code,{children:"cps({context, fn}, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4e0e ",(0,c.jsx)(n.code,{children:"cps([context, fn], ...args)"})," \u76f8\u540c\uff0c\u4f46\u652f\u6301\u5c06 ",(0,c.jsx)(n.code,{children:"context"})," \u548c ",(0,c.jsx)(n.code,{children:"fn"})," \u4f5c\u4e3a\u5bf9\u8c61\u7684\u5c5e\u6027\u4f20\u9012\u3002",(0,c.jsx)(n.code,{children:"fn"})," \u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\u6216\u51fd\u6570\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"forkfn-args",children:(0,c.jsx)(n.code,{children:"fork(fn, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u521b\u5efa\u4e00\u4e2a Effect \u63cf\u8ff0\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u5bf9 ",(0,c.jsx)(n.code,{children:"fn"})," \u6267\u884c",(0,c.jsx)(n.em,{children:"\u975e\u963b\u585e\u8c03\u7528"})]}),"\n",(0,c.jsx)(n.h4,{id:"\u53c2\u6570",children:"\u53c2\u6570"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"fn: Function"})," - \u4e00\u4e2a Generator \u51fd\u6570\uff0c\u6216\u8005\u662f\u4e00\u4e2a\u666e\u901a\u51fd\u6570\uff0c\u5b83\u8fd4\u56de\u4e00\u4e2a Promise \u4f5c\u4e3a\u7ed3\u679c"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"args: Array<any>"})," - \u4e00\u4e2a\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9 ",(0,c.jsx)(n.code,{children:"fn"})," \u7684\u503c\u7684\u6570\u7ec4"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u8fd4\u56de\u4e00\u4e2a ",(0,c.jsx)(n.a,{href:"#task",children:"Task"})," \u5bf9\u8c61\u3002"]}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-8",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"fork"}),"\uff0c\u50cf ",(0,c.jsx)(n.code,{children:"call"})," \u4e00\u6837\uff0c\u53ef\u4ee5\u7528\u6765\u8c03\u7528\u666e\u901a\u51fd\u6570\u548c Generator \u51fd\u6570\u3002\u4f46\u662f\uff0c\u8c03\u7528\u662f\u975e\u963b\u585e\u7684\uff0c\u4e2d\u95f4\u4ef6\u5728\u7b49\u5f85 ",(0,c.jsx)(n.code,{children:"fn"})," \u7684\u7ed3\u679c\u65f6\u4e0d\u4f1a\u6302\u8d77 Generator\u3002\u76f8\u53cd\uff0c\u4e00\u65e6 ",(0,c.jsx)(n.code,{children:"fn"})," \u88ab\u8c03\u7528\uff0cGenerator \u7acb\u5373\u6062\u590d\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"fork"}),"\uff0c\u4e0e ",(0,c.jsx)(n.code,{children:"race"})," \u4e00\u8d77\uff0c\u662f\u7ba1\u7406 Saga \u4e4b\u95f4\u5e76\u53d1\u7684\u6838\u5fc3 Effect\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"yield fork(fn ...args)"})," \u7684\u7ed3\u679c\u662f\u4e00\u4e2a ",(0,c.jsx)(n.a,{href:"#task",children:"Task"})," \u5bf9\u8c61\u3002\u4e00\u4e2a\u5e26\u6709\u4e00\u4e9b\u6709\u7528\u65b9\u6cd5\u548c\u5c5e\u6027\u7684\u5bf9\u8c61\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u6240\u6709 forked \u4efb\u52a1\u90fd",(0,c.jsx)(n.em,{children:"\u9644\u52a0"}),"\u5230\u5b83\u4eec\u7684\u7236\u4efb\u52a1\u3002\u5f53\u7236\u4efb\u52a1\u7ec8\u6b62\u5176\u81ea\u8eab\u7684\u6307\u4ee4\u4f53\u65f6\uff0c\u5b83\u5c06\u7b49\u5f85\u6240\u6709 forked \u4efb\u52a1\u7ec8\u6b62\u540e\u624d\u8fd4\u56de\u3002"]}),"\n",(0,c.jsx)(n.h4,{id:"\u9519\u8bef\u4f20\u64ad",children:"\u9519\u8bef\u4f20\u64ad"}),"\n",(0,c.jsxs)(n.p,{children:["\u5b50\u4efb\u52a1\u7684\u9519\u8bef\u4f1a\u81ea\u52a8\u5192\u6ce1\u5230\u5b83\u4eec\u7684\u7236\u4efb\u52a1\u3002\u5982\u679c\u4efb\u4f55 forked \u4efb\u52a1\u5f15\u53d1\u4e86\u672a\u6355\u83b7\u7684\u9519\u8bef\uff0c\u90a3\u4e48\u7236\u4efb\u52a1\u5c06\u4ee5\u5b50\u4efb\u52a1\u7684\u9519\u8bef\u4e2d\u6b62\uff0c\u6574\u4e2a\u7236\u4efb\u52a1\u7684\u6267\u884c\u6811\uff08\u5373 forked \u4efb\u52a1 + \u7236\u4efb\u52a1\u7684",(0,c.jsx)(n.em,{children:"\u4e3b\u4efb\u52a1"}),"\uff0c\u5982\u679c\u5b83\u4ecd\u5728\u8fd0\u884c\uff09\u5c06\u88ab\u53d6\u6d88\u3002"]}),"\n",(0,c.jsx)(n.p,{children:"\u53d6\u6d88\u4e00\u4e2a forked \u4efb\u52a1\u5c06\u81ea\u52a8\u53d6\u6d88\u6240\u6709\u4ecd\u5728\u6267\u884c\u7684 forked \u4efb\u52a1\u3002\u5b83\u8fd8\u4f1a\u53d6\u6d88\u5f53\u524d\u88ab\u53d6\u6d88\u7684\u4efb\u52a1\u88ab\u963b\u585e\u7684 Effect\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09\u3002"}),"\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c\u4e00\u4e2a forked \u4efb\u52a1",(0,c.jsx)(n.em,{children:"\u540c\u6b65"}),"\u5931\u8d25\uff08\u5373\uff1a\u5728\u6267\u884c\u4efb\u4f55\u5f02\u6b65\u64cd\u4f5c\u4e4b\u524d\u7acb\u5373\u5931\u8d25\uff09\uff0c\u90a3\u4e48\u4e0d\u4f1a\u8fd4\u56de\u4efb\u4f55\u4efb\u52a1\uff0c\u76f8\u53cd\uff0c\u7236\u4efb\u52a1\u5c06\u5c3d\u5feb\u4e2d\u6b62\uff08\u56e0\u4e3a\u7236\u4efb\u52a1\u548c\u5b50\u4efb\u52a1\u5e76\u884c\u6267\u884c\uff0c\u7236\u4efb\u52a1\u5c06\u5728\u6ce8\u610f\u5230\u5b50\u4efb\u52a1\u5931\u8d25\u540e\u5c3d\u5feb\u4e2d\u6b62\uff09\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u8981\u521b\u5efa",(0,c.jsx)(n.em,{children:"\u5206\u79bb"}),"\u7684 fork\uff0c\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"spawn"}),"\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"forkcontext-fn-args",children:(0,c.jsx)(n.code,{children:"fork([context, fn], ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u652f\u6301\u4ee5 ",(0,c.jsx)(n.code,{children:"this"})," \u4e0a\u4e0b\u6587\u8c03\u7528 forked \u51fd\u6570"]}),"\n",(0,c.jsx)(n.h3,{id:"forkcontext-fn-args-1",children:(0,c.jsx)(n.code,{children:"fork({context, fn}, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4e0e ",(0,c.jsx)(n.code,{children:"fork([context, fn], ...args)"})," \u76f8\u540c\uff0c\u4f46\u652f\u6301\u5c06 ",(0,c.jsx)(n.code,{children:"context"})," \u548c ",(0,c.jsx)(n.code,{children:"fn"})," \u4f5c\u4e3a\u5bf9\u8c61\u7684\u5c5e\u6027\u4f20\u9012\u3002",(0,c.jsx)(n.code,{children:"fn"})," \u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\u6216\u51fd\u6570\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"spawnfn-args",children:(0,c.jsx)(n.code,{children:"spawn(fn, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4e0e ",(0,c.jsx)(n.code,{children:"fork(fn, ...args)"})," \u76f8\u540c\uff0c\u4f46\u521b\u5efa\u4e00\u4e2a",(0,c.jsx)(n.em,{children:"\u5206\u79bb"}),"\u7684\u4efb\u52a1\u3002\u4e00\u4e2a\u5206\u79bb\u7684\u4efb\u52a1\u4e0e\u5176\u7236\u4efb\u52a1\u72ec\u7acb\uff0c\u8868\u73b0\u5f97\u50cf\u4e00\u4e2a\u9876\u7ea7\u4efb\u52a1\u3002\u7236\u4efb\u52a1\u5728\u8fd4\u56de\u524d\u4e0d\u4f1a\u7b49\u5f85\u5206\u79bb\u7684\u4efb\u52a1\u7ec8\u6b62\uff0c\u6240\u6709\u53ef\u80fd\u5f71\u54cd\u7236\u4efb\u52a1\u6216\u5206\u79bb\u4efb\u52a1\u7684\u4e8b\u4ef6\u90fd\u662f\u5b8c\u5168\u72ec\u7acb\u7684\uff08\u9519\u8bef\uff0c\u53d6\u6d88\uff09\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"spawncontext-fn-args",children:(0,c.jsx)(n.code,{children:"spawn([context, fn], ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u652f\u6301\u4ee5 ",(0,c.jsx)(n.code,{children:"this"})," \u4e0a\u4e0b\u6587\u8c03\u7528 spawn \u51fd\u6570"]}),"\n",(0,c.jsx)(n.h3,{id:"jointask",children:(0,c.jsx)(n.code,{children:"join(task)"})}),"\n",(0,c.jsx)(n.p,{children:"\u521b\u5efa\u4e00\u4e2a Effect \u63cf\u8ff0\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u7b49\u5f85\u4e4b\u524d forked \u4efb\u52a1\u7684\u7ed3\u679c\u3002"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"task: Task"})," - \u7531\u4e4b\u524d\u7684 ",(0,c.jsx)(n.code,{children:"fork"})," \u8fd4\u56de\u7684 ",(0,c.jsx)(n.a,{href:"#task",children:"Task"})," \u5bf9\u8c61"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-9",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"join"})," \u5c06\u89e3\u6790\u4e3a\u4e0e joined \u4efb\u52a1\u76f8\u540c\u7684\u7ed3\u679c\uff08\u6210\u529f\u6216\u9519\u8bef\uff09\u3002\u5982\u679c joined \u4efb\u52a1\u88ab\u53d6\u6d88\uff0c\u53d6\u6d88\u4e5f\u5c06\u4f20\u64ad\u5230\u6267\u884c join effect \u7684 Saga\u3002\u540c\u6837\uff0c\u90a3\u4e9b\u53ef\u80fd\u7684 joiners \u7684\u4efb\u4f55\u6f5c\u5728\u8c03\u7528\u8005\u4e5f\u5c06\u88ab\u53d6\u6d88\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"jointasks",children:(0,c.jsx)(n.code,{children:"join([...tasks])"})}),"\n",(0,c.jsx)(n.p,{children:"\u521b\u5efa\u4e00\u4e2a Effect \u63cf\u8ff0\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u7b49\u5f85\u4e4b\u524d forked \u4efb\u52a1\u7684\u7ed3\u679c\u3002"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"tasks: Array<Task>"})," - ",(0,c.jsx)(n.a,{href:"#task",children:"Task"})," \u662f\u7531\u4e4b\u524d\u7684 ",(0,c.jsx)(n.code,{children:"fork"})," \u8fd4\u56de\u7684\u5bf9\u8c61"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-10",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:["\u5b83\u5c06\u4efb\u52a1\u6570\u7ec4\u5305\u88c5\u5728",(0,c.jsx)(n.a,{href:"#jointask",children:"join effects"}),"\u4e2d\uff0c\u5927\u81f4\u76f8\u5f53\u4e8e\r\n",(0,c.jsx)(n.code,{children:"yield tasks.map(t => join(t))"}),"\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"canceltask",children:(0,c.jsx)(n.code,{children:"cancel(task)"})}),"\n",(0,c.jsx)(n.p,{children:"\u521b\u5efa\u4e00\u4e2aEffect\u63cf\u8ff0\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u53d6\u6d88\u4e4b\u524d\u5206\u53c9\u7684\u4efb\u52a1\u3002"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"task: Task"})," - \u7531\u4e4b\u524d\u7684",(0,c.jsx)(n.code,{children:"fork"}),"\u8fd4\u56de\u7684",(0,c.jsx)(n.a,{href:"#task",children:"Task"}),"\u5bf9\u8c61"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-11",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:["\u8981\u53d6\u6d88\u6b63\u5728\u8fd0\u884c\u7684\u4efb\u52a1\uff0c\u4e2d\u95f4\u4ef6\u5c06\u5728\u5e95\u5c42\u7684\u751f\u6210\u5668\u5bf9\u8c61\u4e0a\u8c03\u7528",(0,c.jsx)(n.code,{children:"return"}),"\u3002\u8fd9\u5c06\u53d6\u6d88\u4efb\u52a1\u4e2d\u7684\u5f53\u524dEffect\uff0c\u5e76\u8df3\u8f6c\u5230finally\u5757\uff08\u5982\u679c\u5b9a\u4e49\u4e86\u7684\u8bdd\uff09\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u5728finally\u5757\u5185\u90e8\uff0c\u4f60\u53ef\u4ee5\u6267\u884c\u4efb\u4f55\u6e05\u7406\u903b\u8f91\u6216\u8005\u6d3e\u53d1\u4e00\u4e9b\u52a8\u4f5c\u6765\u4fdd\u6301\u5b58\u50a8\u5728\u4e00\u81f4\u7684\u72b6\u6001\uff08\u4f8b\u5982\uff0c\u5f53\u4e00\u4e2aajax\u8bf7\u6c42\u88ab\u53d6\u6d88\u65f6\uff0c\u91cd\u7f6e\u4e00\u4e2a\u65cb\u8f6c\u5668\u7684\u72b6\u6001\u4e3afalse\uff09\u3002\u4f60\u53ef\u4ee5\u5728finally\u5757\u5185\u90e8\u901a\u8fc7\u53d1\u51fa",(0,c.jsx)(n.code,{children:"yield cancelled()"}),"\u6765\u68c0\u67e5\u4e00\u4e2aSaga\u662f\u5426\u88ab\u53d6\u6d88\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u53d6\u6d88\u4f1a\u5411\u4e0b\u4f20\u64ad\u5230\u5b50sagas\u3002\u5f53\u53d6\u6d88\u4e00\u4e2a\u4efb\u52a1\u65f6\uff0c\u4e2d\u95f4\u4ef6\u4e5f\u4f1a\u53d6\u6d88\u5f53\u524d\u7684Effect\uff08\u4efb\u52a1\u5f53\u524d\u88ab\u963b\u585e\u7684\u5730\u65b9\uff09\u3002\u5982\u679c\u5f53\u524d\u7684Effect\u662f\u5bf9\u53e6\u4e00\u4e2aSaga\u7684\u8c03\u7528\uff0c\u5b83\u4e5f\u4f1a\u88ab\u53d6\u6d88\u3002\u5f53\u53d6\u6d88\u4e00\u4e2aSaga\u65f6\uff0c\u6240\u6709",(0,c.jsx)(n.em,{children:"\u9644\u52a0\u7684\u5206\u53c9"}),"\uff08\u4f7f\u7528",(0,c.jsx)(n.code,{children:"yield fork()"}),"\u5206\u53c9\u7684sagas\uff09\u90fd\u4f1a\u88ab\u53d6\u6d88\u3002\u8fd9\u610f\u5473\u7740\u53d6\u6d88\u5b9e\u9645\u4e0a\u5f71\u54cd\u5230\u5c5e\u4e8e\u88ab\u53d6\u6d88\u4efb\u52a1\u7684\u6574\u4e2a\u6267\u884c\u6811\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"cancel"}),"\u662f\u4e00\u4e2a\u975e\u963b\u585e\u7684Effect\u3002\u5373\u6267\u884c\u5b83\u7684Saga\u5c06\u5728\u6267\u884c\u53d6\u6d88\u540e\u7acb\u5373\u6062\u590d\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u5bf9\u4e8e\u8fd4\u56dePromise\u7ed3\u679c\u7684\u51fd\u6570\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u5728promise\u4e0a\u9644\u52a0\u4e00\u4e2a",(0,c.jsx)(n.code,{children:"[CANCEL]"}),"\u6765\u63d2\u5165\u4f60\u81ea\u5df1\u7684\u53d6\u6d88\u903b\u8f91\u3002"]}),"\n",(0,c.jsx)(n.p,{children:"\u4ee5\u4e0b\u793a\u4f8b\u663e\u793a\u4e86\u5982\u4f55\u5c06\u53d6\u6d88\u903b\u8f91\u9644\u52a0\u5230Promise\u7ed3\u679c\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import { CANCEL } from 'redux-saga'\r\nimport { fork, cancel } from 'redux-saga/effects'\r\n\r\nfunction myApi() {\r\n  const promise = myXhr(...)\r\n\r\n  promise[CANCEL] = () => myXhr.abort()\r\n  return promise\r\n}\r\n\r\nfunction* mySaga() {\r\n\r\n  const task = yield fork(myApi)\r\n\r\n  // ... later\r\n  // will call promise[CANCEL] on the result of myApi\r\n  yield cancel(task)\r\n}\n"})}),"\n",(0,c.jsxs)(n.p,{children:["redux-saga\u5c06\u81ea\u52a8\u4f7f\u7528\u5b83\u4eec\u7684",(0,c.jsx)(n.code,{children:"abort"}),"\u65b9\u6cd5\u53d6\u6d88jqXHR\u5bf9\u8c61\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"canceltasks",children:(0,c.jsx)(n.code,{children:"cancel([...tasks])"})}),"\n",(0,c.jsx)(n.p,{children:"\u521b\u5efa\u4e00\u4e2aEffect\u63cf\u8ff0\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u53d6\u6d88\u4e4b\u524d\u5206\u53c9\u7684\u4efb\u52a1\u3002"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"tasks: Array<Task>"})," - ",(0,c.jsx)(n.a,{href:"#task",children:"Task"}),"\u662f\u4e4b\u524d",(0,c.jsx)(n.code,{children:"fork"}),"\u8fd4\u56de\u7684\u5bf9\u8c61"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-12",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:["\u5b83\u5c06\u4efb\u52a1\u6570\u7ec4\u5305\u88c5\u5728",(0,c.jsx)(n.a,{href:"#canceltask",children:"cancel effects"}),"\u4e2d\uff0c\u5927\u81f4\u76f8\u5f53\u4e8e\r\n",(0,c.jsx)(n.code,{children:"yield tasks.map(t => cancel(t))"}),"\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"cancel",children:(0,c.jsx)(n.code,{children:"cancel()"})}),"\n",(0,c.jsxs)(n.p,{children:["\u521b\u5efa\u4e00\u4e2aEffect\u63cf\u8ff0\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u53d6\u6d88\u5176\u4e2d\u5df2\u4ea7\u751f\u7684\u4efb\u52a1\uff08\u81ea\u6211\u53d6\u6d88\uff09\u3002\r\n\u5b83\u5141\u8bb8\u5728",(0,c.jsx)(n.code,{children:"finally"}),"\u5757\u4e2d\u91cd\u7528\u6790\u6784\u5668\u7c7b\u4f3c\u7684\u903b\u8f91\uff0c\u7528\u4e8e\u5916\u90e8\uff08",(0,c.jsx)(n.code,{children:"cancel(task)"}),"\uff09\u548c\u81ea\u6211\uff08",(0,c.jsx)(n.code,{children:"cancel()"}),"\uff09\u53d6\u6d88\u3002"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-4",children:"\u793a\u4f8b"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"function* deleteRecord({ payload }) {\r\n  try {\r\n    const { confirm, deny } = yield call(prompt);\r\n    if (confirm) {\r\n      yield put(actions.deleteRecord.confirmed())\r\n    }\r\n    if (deny) {\r\n      yield cancel()\r\n    }\r\n  } catch(e) {\r\n    // \u5904\u7406\u5931\u8d25\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      // \u5171\u4eab\u53d6\u6d88\u903b\u8f91\r\n      yield put(actions.deleteRecord.cancel(payload))\r\n    }\r\n  }\r\n}\n"})}),"\n",(0,c.jsx)(n.h3,{id:"selectselector-args",children:(0,c.jsx)(n.code,{children:"select(selector, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u521b\u5efa\u4e00\u4e2a\u6548\u679c\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u5728\u5f53\u524dStore\u7684\u72b6\u6001\u4e0a\u8c03\u7528\u63d0\u4f9b\u7684\u9009\u62e9\u5668\uff08\u5373\u8fd4\u56de",(0,c.jsx)(n.code,{children:"selector(getState(), ...args)"}),"\u7684\u7ed3\u679c\uff09\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"selector: Function"})," - \u51fd\u6570 ",(0,c.jsx)(n.code,{children:"(state, ...args) => args"}),"\u3002\u5b83\u63a5\u53d7\u5f53\u524d\u72b6\u6001\u548c\u4e00\u4e9b\u53ef\u9009\u53c2\u6570\uff0c\u5e76\u8fd4\u56de\u5f53\u524dStore\u72b6\u6001\u7684\u4e00\u4e2a\u5207\u7247"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"args: Array<any>"})," - \u8981\u4f20\u9012\u7ed9\u9009\u62e9\u5668\u7684\u53ef\u9009\u53c2\u6570\uff0c\u9664\u4e86",(0,c.jsx)(n.code,{children:"getState"}),"\u3002"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c",(0,c.jsx)(n.code,{children:"select"}),"\u6ca1\u6709\u53c2\u6570\u8c03\u7528\uff08\u5373",(0,c.jsx)(n.code,{children:"yield select()"}),"\uff09\uff0c\u90a3\u4e48\u6548\u679c\u5c06\u89e3\u6790\u4e3a\u6574\u4e2a\u72b6\u6001\uff08\u4e0e",(0,c.jsx)(n.code,{children:"getState()"}),"\u8c03\u7528\u7684\u7ed3\u679c\u76f8\u540c\uff09\u3002"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u91cd\u8981\u7684\u662f\u8981\u6ce8\u610f\uff0c\u5f53\u4e00\u4e2a\u52a8\u4f5c\u88ab\u5206\u6d3e\u5230\u5b58\u50a8\u5668\u65f6\uff0c\u4e2d\u95f4\u4ef6\u9996\u5148\u5c06\u52a8\u4f5c\u8f6c\u53d1\u7ed9reducers\uff0c\u7136\u540e\u901a\u77e5Sagas\u3002\u8fd9\u610f\u5473\u7740\u5f53\u4f60\u67e5\u8be2Store\u7684State\u65f6\uff0c\u4f60\u5f97\u5230\u7684\u662f\u52a8\u4f5c\u5e94\u7528",(0,c.jsx)(n.strong,{children:"\u540e"}),"\u7684State\u3002\r\n\u7136\u800c\uff0c\u8fd9\u79cd\u884c\u4e3a\u53ea\u6709\u5728\u6240\u6709\u540e\u7eed\u7684\u4e2d\u95f4\u4ef6\u540c\u6b65\u8c03\u7528",(0,c.jsx)(n.code,{children:"next(action)"}),"\u65f6\u624d\u80fd\u4fdd\u8bc1\u3002\u5982\u679c\u4efb\u4f55\u540e\u7eed\u7684\u4e2d\u95f4\u4ef6\u5f02\u6b65\u8c03\u7528",(0,c.jsx)(n.code,{children:"next(action)"}),"\uff08\u8fd9\u662f\u4e0d\u5bfb\u5e38\u7684\uff0c\u4f46\u662f\u53ef\u80fd\u7684\uff09\uff0c\u90a3\u4e48sagas\u5c06\u5f97\u5230\u52a8\u4f5c\u5e94\u7528",(0,c.jsx)(n.strong,{children:"\u524d"}),"\u7684\u72b6\u6001\u3002\u56e0\u6b64\uff0c\u5efa\u8bae\u5ba1\u67e5\u6bcf\u4e2a\u540e\u7eed\u4e2d\u95f4\u4ef6\u7684\u6e90\u4ee3\u7801\uff0c\u4ee5\u786e\u4fdd\u5b83\u540c\u6b65\u8c03\u7528",(0,c.jsx)(n.code,{children:"next(action)"}),"\uff0c\u6216\u8005\u786e\u4fddredux-saga\u662f\u8c03\u7528\u94fe\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u4e2d\u95f4\u4ef6\u3002"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-13",children:"\u6ce8\u91ca"}),"\n",(0,c.jsx)(n.p,{children:"\u6700\u597d\uff0c\u4e00\u4e2aSaga\u5e94\u8be5\u662f\u81ea\u4e3b\u7684\uff0c\u4e0d\u5e94\u8be5\u4f9d\u8d56\u4e8eStore\u7684\u72b6\u6001\u3002\u8fd9\u4f7f\u5f97\u5728\u4e0d\u5f71\u54cdSaga\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u4fee\u6539\u72b6\u6001\u5b9e\u73b0\u3002\u4e00\u4e2asaga\u6700\u597d\u53ea\u4f9d\u8d56\u4e8e\u5b83\u81ea\u5df1\u7684\u5185\u90e8\u63a7\u5236\u72b6\u6001\u3002\u4f46\u662f\u6709\u65f6\u5019\uff0c\u4eba\u4eec\u53ef\u80fd\u4f1a\u53d1\u73b0\u8ba9Saga\u67e5\u8be2\u72b6\u6001\uff0c\u800c\u4e0d\u662f\u81ea\u5df1\u7ef4\u62a4\u6240\u9700\u7684\u6570\u636e\u66f4\u65b9\u4fbf\uff08\u4f8b\u5982\uff0c\u5f53\u4e00\u4e2aSaga\u590d\u5236\u8c03\u7528\u67d0\u4e2areducer\u7684\u903b\u8f91\u6765\u8ba1\u7b97\u5df2\u7ecf\u7531Store\u8ba1\u7b97\u51fa\u7684\u72b6\u6001\u65f6\uff09\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u4f8b\u5982\uff0c\u5047\u8bbe\u6211\u4eec\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u6709\u8fd9\u6837\u7684\u72b6\u6001\u5f62\u72b6\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"state = {\r\n  cart: {...}\r\n}\n"})}),"\n",(0,c.jsxs)(n.p,{children:["\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a",(0,c.jsx)(n.em,{children:"\u9009\u62e9\u5668"}),"\uff0c\u5373\u4e00\u4e2a\u77e5\u9053\u5982\u4f55\u4eceState\u4e2d\u63d0\u53d6",(0,c.jsx)(n.code,{children:"cart"}),"\u6570\u636e\u7684\u51fd\u6570\uff1a"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.code,{children:"./selectors"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"export const getCart = state => state.cart\n"})}),"\n",(0,c.jsxs)(n.p,{children:["\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5728Saga\u4e2d\u4f7f\u7528",(0,c.jsx)(n.code,{children:"select"})," Effect\u6765\u4f7f\u7528\u8be5\u9009\u62e9\u5668\uff1a"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.code,{children:"./sagas.js"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import { take, fork, select } from 'redux-saga/effects'\r\nimport { getCart } from './selectors'\r\n\r\nfunction* checkout() {\r\n  // \u4f7f\u7528\u5bfc\u51fa\u7684\u9009\u62e9\u5668\u67e5\u8be2\u72b6\u6001\r\n  const cart = yield select(getCart)\r\n\r\n  // ... \u8c03\u7528\u4e00\u4e9bAPI\u7aef\u70b9\uff0c\u7136\u540e\u5206\u6d3e\u4e00\u4e2a\u6210\u529f/\u9519\u8bef\u52a8\u4f5c\r\n}\r\n\r\nexport default function* rootSaga() {\r\n  while (true) {\r\n    yield take('CHECKOUT_REQUEST')\r\n    yield fork(checkout)\r\n  }\r\n}\n"})}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"checkout"}),"\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528",(0,c.jsx)(n.code,{children:"select(getCart)"}),"\u76f4\u63a5\u83b7\u53d6\u6240\u9700\u7684\u4fe1\u606f\u3002Saga\u53ea\u4e0e",(0,c.jsx)(n.code,{children:"getCart"}),"\u9009\u62e9\u5668\u8026\u5408\u3002\u5982\u679c\u6211\u4eec\u6709\u8bb8\u591a\u9700\u8981\u8bbf\u95ee",(0,c.jsx)(n.code,{children:"cart"}),"\u5207\u7247\u7684Sagas\uff08\u6216React\u7ec4\u4ef6\uff09\uff0c\u4ed6\u4eec\u90fd\u5c06\u8026\u5408\u5230\u540c\u4e00\u4e2a\u51fd\u6570",(0,c.jsx)(n.code,{children:"getCart"}),"\u3002\u73b0\u5728\uff0c\u5982\u679c\u6211\u4eec\u6539\u53d8\u72b6\u6001\u5f62\u72b6\uff0c\u6211\u4eec\u53ea\u9700\u8981\u66f4\u65b0",(0,c.jsx)(n.code,{children:"getCart"}),"\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"actionchannelpattern-buffer",children:(0,c.jsx)(n.code,{children:"actionChannel(pattern, [buffer])"})}),"\n",(0,c.jsxs)(n.p,{children:["\u521b\u5efa\u4e00\u4e2a\u6548\u679c\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u4f7f\u7528\u4e8b\u4ef6\u901a\u9053\u5bf9\u5339\u914d",(0,c.jsx)(n.code,{children:"pattern"}),"\u7684\u64cd\u4f5c\u8fdb\u884c\u6392\u961f\u3002\u53ef\u9009\u5730\uff0c\u60a8\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u7f13\u51b2\u533a\u6765\u63a7\u5236\u6392\u961f\u64cd\u4f5c\u7684\u7f13\u51b2\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"pattern:"})," - \u53c2\u89c1 ",(0,c.jsx)(n.code,{children:"take(pattern)"})," \u7684API"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"buffer: Buffer"})," - \u4e00\u4e2a ",(0,c.jsx)(n.a,{href:"#buffer",children:"Buffer"})," \u5bf9\u8c61"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-5",children:"\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.p,{children:["\u4ee5\u4e0b\u4ee3\u7801\u521b\u5efa\u4e86\u4e00\u4e2a\u901a\u9053\uff0c\u7528\u4e8e\u7f13\u51b2\u6240\u6709\u7684 ",(0,c.jsx)(n.code,{children:"USER_REQUEST"})," \u64cd\u4f5c\u3002\u6ce8\u610f\uff0c\u5373\u4f7f Saga \u53ef\u80fd\u5728 ",(0,c.jsx)(n.code,{children:"call"})," \u6548\u679c\u4e0a\u88ab\u963b\u585e\u3002\u6240\u6709\u5728\u5b83\u88ab\u963b\u585e\u65f6\u6765\u7684\u64cd\u4f5c\u90fd\u4f1a\u81ea\u52a8\u88ab\u7f13\u51b2\u3002\u8fd9\u5bfc\u81f4 Saga \u4e00\u6b21\u6267\u884c\u4e00\u4e2a API \u8c03\u7528\u3002"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import { actionChannel, call } from 'redux-saga/effects'\r\nimport api from '...'\r\n\r\nfunction* takeOneAtMost() {\r\n  const chan = yield actionChannel('USER_REQUEST')\r\n  while (true) {\r\n    const {payload} = yield take(chan)\r\n    yield call(api.getUser, payload)\r\n  }\r\n}\n"})}),"\n",(0,c.jsx)(n.h3,{id:"flushchannel",children:(0,c.jsx)(n.code,{children:"flush(channel)"})}),"\n",(0,c.jsx)(n.p,{children:"\u521b\u5efa\u4e00\u4e2a\u6548\u679c\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u4ece\u901a\u9053\u4e2d\u5237\u65b0\u6240\u6709\u7f13\u51b2\u7684\u9879\u76ee\u3002\u5237\u65b0\u7684\u9879\u76ee\u88ab\u8fd4\u56de\u7ed9 saga\uff0c\u56e0\u6b64\u5982\u679c\u9700\u8981\uff0c\u5b83\u4eec\u53ef\u4ee5\u88ab\u5229\u7528\u3002"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"channel: Channel"})," - \u4e00\u4e2a ",(0,c.jsx)(n.a,{href:"#channel",children:(0,c.jsx)(n.code,{children:"Channel"})})," \u5bf9\u8c61\u3002"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-6",children:"\u793a\u4f8b"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"function* saga() {\r\n  const chan = yield actionChannel('ACTION')\r\n\r\n  try {\r\n    while (true) {\r\n      const action = yield take(chan)\r\n      // ...\r\n    }\r\n  } finally {\r\n    const actions = yield flush(chan)\r\n    // ...\r\n  }\r\n\r\n}\n"})}),"\n",(0,c.jsx)(n.h3,{id:"cancelled",children:(0,c.jsx)(n.code,{children:"cancelled()"})}),"\n",(0,c.jsx)(n.p,{children:"\u521b\u5efa\u4e00\u4e2a\u6548\u679c\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u8fd4\u56de\u6b64\u751f\u6210\u5668\u662f\u5426\u5df2\u88ab\u53d6\u6d88\u3002\u901a\u5e38\uff0c\u60a8\u5728 finally \u5757\u4e2d\u4f7f\u7528\u6b64\u6548\u679c\u6765\u8fd0\u884c\u53d6\u6d88\u7279\u5b9a\u7684\u4ee3\u7801\u3002"}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-7",children:"\u793a\u4f8b"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"function* saga() {\r\n  try {\r\n    // ...\r\n  } finally {\r\n    if (yield cancelled()) {\r\n      // \u53ea\u5728\u53d6\u6d88\u65f6\u6267\u884c\u7684\u903b\u8f91\r\n    }\r\n    // \u5728\u6240\u6709\u60c5\u51b5\u4e0b\u90fd\u5e94\u6267\u884c\u7684\u903b\u8f91\uff08\u4f8b\u5982\uff0c\u5173\u95ed\u4e00\u4e2a\u901a\u9053\uff09\r\n  }\r\n}\n"})}),"\n",(0,c.jsx)(n.h3,{id:"setcontextprops",children:(0,c.jsx)(n.code,{children:"setContext(props)"})}),"\n",(0,c.jsx)(n.p,{children:"\u521b\u5efa\u4e00\u4e2a\u6548\u679c\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u66f4\u65b0\u5176\u81ea\u8eab\u7684\u4e0a\u4e0b\u6587\u3002\u6b64\u6548\u679c\u6269\u5c55\u4e86 saga \u7684\u4e0a\u4e0b\u6587\uff0c\u800c\u4e0d\u662f\u66ff\u6362\u5b83\u3002"}),"\n",(0,c.jsx)(n.h3,{id:"getcontextprop",children:(0,c.jsx)(n.code,{children:"getContext(prop)"})}),"\n",(0,c.jsx)(n.p,{children:"\u521b\u5efa\u4e00\u4e2a\u6548\u679c\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u8fd4\u56de saga \u4e0a\u4e0b\u6587\u7684\u7279\u5b9a\u5c5e\u6027\u3002"}),"\n",(0,c.jsx)(n.h3,{id:"delayms-val",children:(0,c.jsx)(n.code,{children:"delay(ms, [val])"})}),"\n",(0,c.jsxs)(n.p,{children:["\u8fd4\u56de\u4e00\u4e2a\u6548\u679c\u63cf\u8ff0\u7b26\uff0c\u4ee5\u963b\u585e\u6267\u884c ",(0,c.jsx)(n.code,{children:"ms"})," \u6beb\u79d2\u5e76\u8fd4\u56de ",(0,c.jsx)(n.code,{children:"val"})," \u503c\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"throttlems-pattern-saga-args",children:(0,c.jsx)(n.code,{children:"throttle(ms, pattern, saga, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5728\u5339\u914d ",(0,c.jsx)(n.code,{children:"pattern"})," \u7684\u64cd\u4f5c\u88ab\u5206\u6d3e\u5230 Store \u65f6\uff0c\u751f\u6210\u4e00\u4e2a ",(0,c.jsx)(n.code,{children:"saga"}),"\u3002\u751f\u6210\u4efb\u52a1\u540e\uff0c\u5b83\u4ecd\u7136\u63a5\u53d7\u8fdb\u5165\u5e95\u5c42 ",(0,c.jsx)(n.code,{children:"buffer"})," \u7684\u64cd\u4f5c\uff0c\u6700\u591a\u4fdd\u7559 1 \u4e2a\uff08\u6700\u8fd1\u7684\u4e00\u4e2a\uff09\uff0c\u4f46\u540c\u65f6\u5728 ",(0,c.jsx)(n.code,{children:"ms"})," \u6beb\u79d2\u5185\u6682\u505c\u751f\u6210\u65b0\u4efb\u52a1\uff08\u56e0\u6b64\u5176\u540d\u79f0 - ",(0,c.jsx)(n.code,{children:"throttle"}),"\uff09\u3002\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u5728\u5904\u7406\u4efb\u52a1\u7684\u540c\u65f6\u5ffd\u7565\u7ed9\u5b9a\u65f6\u95f4\u6bb5\u5185\u7684\u8fdb\u5165\u64cd\u4f5c\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"ms: Number"})," - \u5728\u64cd\u4f5c\u5f00\u59cb\u5904\u7406\u540e\u5c06\u5ffd\u7565\u64cd\u4f5c\u7684\u65f6\u95f4\u7a97\u53e3\u957f\u5ea6\uff08\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\uff09"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"pattern: String | Array | Function"})," - \u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u89c1 ",(0,c.jsx)(n.a,{href:"#takepattern",children:(0,c.jsx)(n.code,{children:"take(pattern)"})})," \u7684\u6587\u6863"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"saga: Function"})," - \u4e00\u4e2a\u751f\u6210\u5668\u51fd\u6570"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"args: Array<any>"})," - \u8981\u4f20\u9012\u7ed9\u542f\u52a8\u4efb\u52a1\u7684\u53c2\u6570\u3002",(0,c.jsx)(n.code,{children:"throttle"})," \u5c06\u6dfb\u52a0\u8fdb\u5165\u64cd\u4f5c\u5230\u53c2\u6570\u5217\u8868\uff08\u5373\uff0c\u64cd\u4f5c\u5c06\u662f\u63d0\u4f9b\u7ed9 ",(0,c.jsx)(n.code,{children:"saga"})," \u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\uff09"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-8",children:"\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.p,{children:["\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u57fa\u672c\u4efb\u52a1 ",(0,c.jsx)(n.code,{children:"fetchAutocomplete"}),"\u3002\u6211\u4eec\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"throttle"})," \u5728\u5206\u6d3e ",(0,c.jsx)(n.code,{children:"FETCH_AUTOCOMPLETE"})," \u64cd\u4f5c\u65f6\u542f\u52a8\u65b0\u7684 ",(0,c.jsx)(n.code,{children:"fetchAutocomplete"})," \u4efb\u52a1\u3002\u7136\u800c\uff0c\u7531\u4e8e ",(0,c.jsx)(n.code,{children:"throttle"})," \u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u5ffd\u7565\u8fde\u7eed\u7684 ",(0,c.jsx)(n.code,{children:"FETCH_AUTOCOMPLETE"}),"\uff0c\u6211\u4eec\u786e\u4fdd\u7528\u6237\u4e0d\u4f1a\u7528\u8bf7\u6c42\u6df9\u6ca1\u6211\u4eec\u7684\u670d\u52a1\u5668\u3002"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import { call, put, throttle } from `redux-saga/effects`\r\n\r\nfunction* fetchAutocomplete(action) {\r\n  const autocompleteProposals = yield call(Api.fetchAutocomplete, action.text)\r\n  yield put({type: 'FETCHED_AUTOCOMPLETE_PROPOSALS', proposals: autocompleteProposals})\r\n}\r\n\r\nfunction* throttleAutocomplete() {\r\n  yield throttle(1000, 'FETCH_AUTOCOMPLETE', fetchAutocomplete)\r\n}\n"})}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-14",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"throttle"})," \u662f\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"take"}),"\uff0c",(0,c.jsx)(n.code,{children:"fork"})," \u548c ",(0,c.jsx)(n.code,{children:"actionChannel"})," \u6784\u5efa\u7684\u9ad8\u7ea7 API\u3002\u4ee5\u4e0b\u662f\u5982\u4f55\u4f7f\u7528\u4f4e\u7ea7\u6548\u679c\u5b9e\u73b0\u8be5\u52a9\u624b"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"const throttle = (ms, pattern, task, ...args) => fork(function*() {\r\n  const throttleChannel = yield actionChannel(pattern, buffers.sliding(1))\r\n\r\n  while (true) {\r\n    const action = yield take(throttleChannel)\r\n    yield fork(task, ...args, action)\r\n    yield delay(ms)\r\n  }\r\n})\n"})}),"\n",(0,c.jsx)(n.h3,{id:"throttlems-channel-saga-args",children:(0,c.jsx)(n.code,{children:"throttle(ms, channel, saga, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4f60\u4e5f\u53ef\u4ee5\u5c06\u901a\u9053\u4f5c\u4e3a\u53c2\u6570\u5904\u7406\uff0c\u5176\u884c\u4e3a\u4e0e ",(0,c.jsx)(n.a,{href:"#throttlems-pattern-saga-args",children:(0,c.jsx)(n.code,{children:"throttle(ms, pattern, saga, ..args)"})})," \u76f8\u540c"]}),"\n",(0,c.jsx)(n.h3,{id:"debouncems-pattern-saga-args",children:(0,c.jsx)(n.code,{children:"debounce(ms, pattern, saga, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5728\u5339\u914d ",(0,c.jsx)(n.code,{children:"pattern"})," \u7684\u52a8\u4f5c\u88ab\u5206\u53d1\u5230 Store \u540e\uff0c\u751f\u6210\u4e00\u4e2a ",(0,c.jsx)(n.code,{children:"saga"}),"\u3002\u5728 ",(0,c.jsx)(n.code,{children:"ms"})," \u6beb\u79d2\u5185\u505c\u6b62\u63a5\u6536 ",(0,c.jsx)(n.code,{children:"pattern"})," \u52a8\u4f5c\u540e\uff0c\u5c06\u8c03\u7528 Saga\u3002\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u9632\u6b62\u5728\u52a8\u4f5c\u88ab\u89e3\u51b3\u4e4b\u524d\u8c03\u7528 saga\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"ms: Number"})," - \u5b9a\u4e49\u4ece\u6700\u540e\u4e00\u6b21\u89e6\u53d1 ",(0,c.jsx)(n.code,{children:"pattern"})," \u52a8\u4f5c\u5230\u8c03\u7528 ",(0,c.jsx)(n.code,{children:"saga"})," \u5e94\u7ecf\u8fc7\u591a\u5c11\u6beb\u79d2"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"pattern: String | Array | Function"})," - \u66f4\u591a\u4fe1\u606f\u8bf7\u53c2\u89c1 ",(0,c.jsx)(n.a,{href:"#takepattern",children:(0,c.jsx)(n.code,{children:"take(pattern)"})})," \u7684\u6587\u6863"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"saga: Function"})," - \u4e00\u4e2a Generator \u51fd\u6570"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"args: Array<any>"})," - \u8981\u4f20\u9012\u7ed9\u542f\u52a8\u4efb\u52a1\u7684\u53c2\u6570\u3002",(0,c.jsx)(n.code,{children:"debounce"})," \u5c06\u628a\r\n\u4f20\u5165\u7684\u52a8\u4f5c\u6dfb\u52a0\u5230\u53c2\u6570\u5217\u8868\u4e2d\uff08\u5373\uff0c\u52a8\u4f5c\u5c06\u662f\u63d0\u4f9b\u7ed9 ",(0,c.jsx)(n.code,{children:"saga"})," \u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\uff09"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-9",children:"\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.p,{children:["\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u57fa\u672c\u4efb\u52a1 ",(0,c.jsx)(n.code,{children:"fetchAutocomplete"}),"\u3002\u6211\u4eec\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"debounce"})," \u6765\r\n\u5ef6\u8fdf\u8c03\u7528 ",(0,c.jsx)(n.code,{children:"fetchAutocomplete"})," saga\uff0c\u76f4\u5230\u6211\u4eec\u505c\u6b62\u63a5\u6536\u4efb\u4f55 ",(0,c.jsx)(n.code,{children:"FETCH_AUTOCOMPLETE"})," \u4e8b\u4ef6\u81f3\u5c11 ",(0,c.jsx)(n.code,{children:"1000"})," \u6beb\u79d2\u3002"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import { call, put, debounce } from `redux-saga/effects`\r\n\r\nfunction* fetchAutocomplete(action) {\r\n  const autocompleteProposals = yield call(Api.fetchAutocomplete, action.text)\r\n  yield put({type: 'FETCHED_AUTOCOMPLETE_PROPOSALS', proposals: autocompleteProposals})\r\n}\r\n\r\nfunction* debounceAutocomplete() {\r\n  yield debounce(1000, 'FETCH_AUTOCOMPLETE', fetchAutocomplete)\r\n}\n"})}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-15",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"debounce"})," \u662f\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"take"}),"\u3001",(0,c.jsx)(n.code,{children:"delay"}),"\u3001",(0,c.jsx)(n.code,{children:"race"})," \u548c ",(0,c.jsx)(n.code,{children:"fork"})," \u6784\u5efa\u7684\u9ad8\u7ea7 API\u3002\u4ee5\u4e0b\u662f\u5982\u4f55\u4f7f\u7528\u4f4e\u7ea7\u6548\u679c\u5b9e\u73b0 helper \u7684\u65b9\u6cd5"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"const debounce = (ms, pattern, task, ...args) => fork(function*() {\r\n  while (true) {\r\n    let action = yield take(pattern)\r\n\r\n    while (true) {\r\n      const { debounced, latestAction } = yield race({\r\n        debounced: delay(ms),\r\n        latestAction: take(pattern)\r\n      })\r\n\r\n      if (debounced) {\r\n        yield fork(task, ...args, action)\r\n        break\r\n      }\r\n\r\n      action = latestAction\r\n    }\r\n  }\r\n})\n"})}),"\n",(0,c.jsx)(n.h3,{id:"debouncems-channel-saga-args",children:(0,c.jsx)(n.code,{children:"debounce(ms, channel, saga, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4f60\u4e5f\u53ef\u4ee5\u5c06\u901a\u9053\u4f5c\u4e3a\u53c2\u6570\u5904\u7406\uff0c\u5176\u884c\u4e3a\u4e0e ",(0,c.jsx)(n.a,{href:"#debouncems-pattern-saga-args",children:(0,c.jsx)(n.code,{children:"debounce(ms, pattern, saga, ..args)"})})," \u76f8\u540c"]}),"\n",(0,c.jsx)(n.h3,{id:"retrymaxtries-delay-fn-args",children:(0,c.jsx)(n.code,{children:"retry(maxTries, delay, fn, ...args)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u521b\u5efa\u4e00\u4e2a Effect \u63cf\u8ff0\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u7528 ",(0,c.jsx)(n.code,{children:"args"})," \u4f5c\u4e3a\u53c2\u6570\u8c03\u7528\u51fd\u6570 ",(0,c.jsx)(n.code,{children:"fn"}),"\u3002\r\n\u5982\u679c\u5931\u8d25\uff0c\u5c06\u5728 ",(0,c.jsx)(n.code,{children:"delay"})," \u6beb\u79d2\u540e\u5c1d\u8bd5\u518d\u6b21\u8c03\u7528\uff0c\u5982\u679c\u5c1d\u8bd5\u6b21\u6570 < ",(0,c.jsx)(n.code,{children:"maxTries"}),"\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"maxTries: Number"})," - \u6700\u5927\u8c03\u7528\u6b21\u6570\u3002"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"delay: Number"})," - ",(0,c.jsx)(n.code,{children:"fn"})," \u8c03\u7528\u4e4b\u95f4\u7684\u65f6\u95f4\u7a97\u53e3\u957f\u5ea6\uff08\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\uff09\u3002"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"fn: Function"})," - \u4e00\u4e2a Generator \u51fd\u6570\uff0c\u6216\u8005\u662f\u8fd4\u56de Promise \u4f5c\u4e3a\u7ed3\u679c\u7684\u666e\u901a\u51fd\u6570\uff0c\u6216\u8005\u662f\u4efb\u4f55\u5176\u4ed6\u503c\u3002"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"args: Array<any>"})," - \u8981\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9 ",(0,c.jsx)(n.code,{children:"fn"})," \u7684\u503c\u6570\u7ec4"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-10",children:"\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.p,{children:["\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u57fa\u672c\u4efb\u52a1 ",(0,c.jsx)(n.code,{children:"retrySaga"}),"\u3002\u6211\u4eec\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"retry"})," \u6765\u5c1d\u8bd5\u7528 10 \u79d2\u7684\u95f4\u9694\u8c03\u7528\u6211\u4eec\u7684 API 3 \u6b21\u3002\u5982\u679c ",(0,c.jsx)(n.code,{children:"request"})," \u7b2c\u4e00\u6b21\u5931\u8d25\uff0c\u90a3\u4e48 ",(0,c.jsx)(n.code,{children:"retry"})," \u5c06\u518d\u6b21\u8c03\u7528 ",(0,c.jsx)(n.code,{children:"request"}),"\uff0c\u53ea\u8981\u8c03\u7528\u6b21\u6570\u5c11\u4e8e 3 \u6b21\u3002"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import { put, retry } from 'redux-saga/effects'\r\nimport { request } from 'some-api';\r\n\r\nfunction* retrySaga(data) {\r\n  try {\r\n    const SECOND = 1000\r\n    const response = yield retry(3, 10 * SECOND, request, data)\r\n    yield put({ type: 'REQUEST_SUCCESS', payload: response })\r\n  } catch(error) {\r\n    yield put({ type: 'REQUEST_FAIL', payload: { error } })\r\n  }\r\n}\n"})}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-16",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"retry"})," \u662f\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"delay"})," \u548c ",(0,c.jsx)(n.code,{children:"call"})," \u6784\u5efa\u7684\u9ad8\u7ea7 API\u3002",(0,c.jsx)(n.a,{href:"/docs/recipes/#retrying-xhr-calls",children:"\u8fd9\u662f\u5982\u4f55\u4f7f\u7528\u4f4e\u7ea7\u6548\u679c\u5b9e\u73b0 helper \u7684\u65b9\u6cd5"})]}),"\n",(0,c.jsx)(n.h2,{id:"effect-\u7ec4\u5408\u5668",children:"Effect \u7ec4\u5408\u5668"}),"\n",(0,c.jsx)(n.h3,{id:"raceeffects",children:(0,c.jsx)(n.code,{children:"race(effects)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u521b\u5efa\u4e00\u4e2a Effect \u63cf\u8ff0\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u5728\u591a\u4e2a Effects \u4e4b\u95f4\u8fd0\u884c\u4e00\u4e2a ",(0,c.jsx)(n.em,{children:"Race"}),"\uff08\u8fd9\u7c7b\u4f3c\u4e8e ",(0,c.jsx)(n.a,{href:"https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Promise/race",children:(0,c.jsx)(n.code,{children:"Promise.race([...])"})})," \u7684\u884c\u4e3a\uff09\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"effects: Object"})," - \u5f62\u5f0f\u4e3a ",(0,c.jsx)(n.code,{children:"{label: effect, ...}"})," \u7684\u5b57\u5178\u5bf9\u8c61"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-11",children:"\u793a\u4f8b"}),"\n",(0,c.jsx)(n.p,{children:"\u4ee5\u4e0b\u793a\u4f8b\u5728\u4e24\u4e2a\u6548\u679c\u4e4b\u95f4\u8fdb\u884c\u7ade\u8d5b\uff1a"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["\u8c03\u7528\u4e00\u4e2a\u51fd\u6570 ",(0,c.jsx)(n.code,{children:"fetchUsers"}),"\uff0c\u8be5\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a Promise"]}),"\n",(0,c.jsxs)(n.li,{children:["\u53ef\u80fd\u6700\u7ec8\u5728 Store \u4e0a\u5206\u6d3e\u7684 ",(0,c.jsx)(n.code,{children:"CANCEL_FETCH"})," \u64cd\u4f5c"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import { take, call, race } from `redux-saga/effects`\r\nimport fetchUsers from './path/to/fetchUsers'\r\n\r\nfunction* fetchUsersSaga() {\r\n  const { response, cancel } = yield race({\r\n    response: call(fetchUsers),\r\n    cancel: take(CANCEL_FETCH)\r\n  })\r\n}\n"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c ",(0,c.jsx)(n.code,{children:"call(fetchUsers)"})," \u9996\u5148\u89e3\u6790\uff0c",(0,c.jsx)(n.code,{children:"race"})," \u7684\u7ed3\u679c\u5c06\u662f\u4e00\u4e2a\u5e26\u6709\u5355\u952e\u5bf9\u8c61 ",(0,c.jsx)(n.code,{children:"{response: result}"})," \u7684\u5bf9\u8c61\uff0c\u5176\u4e2d ",(0,c.jsx)(n.code,{children:"result"})," \u662f ",(0,c.jsx)(n.code,{children:"fetchUsers"})," \u7684\u89e3\u6790\u7ed3\u679c\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c ",(0,c.jsx)(n.code,{children:"call(fetchUsers)"})," \u9996\u5148\u62d2\u7edd\uff0c",(0,c.jsx)(n.code,{children:"race"})," \u4f1a\u629b\u51fa\u62d2\u7edd\u539f\u56e0\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c\u5728 ",(0,c.jsx)(n.code,{children:"fetchUsers"})," \u5b8c\u6210\u4e4b\u524d\u5728 Store \u4e0a\u5206\u6d3e\u4e86\u7c7b\u578b\u4e3a ",(0,c.jsx)(n.code,{children:"CANCEL_FETCH"})," \u7684\u64cd\u4f5c\uff0c\u7ed3\u679c\u5c06\u662f\u4e00\u4e2a\u5e26\u6709\u5355\u952e\u5bf9\u8c61 ",(0,c.jsx)(n.code,{children:"{cancel: action}"})," \u7684\u5bf9\u8c61\uff0c\u5176\u4e2d action \u662f\u5206\u6d3e\u7684\u64cd\u4f5c\u3002"]}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-17",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:["\u5728\u89e3\u6790 ",(0,c.jsx)(n.code,{children:"race"})," \u65f6\uff0c\u4e2d\u95f4\u4ef6\u4f1a\u81ea\u52a8\u53d6\u6d88\u6240\u6709\u5931\u8d25\u7684 Effects\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"raceeffects-\u5e26\u6570\u7ec4",children:(0,c.jsx)(n.code,{children:"race([...effects]) (\u5e26\u6570\u7ec4)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4e0e ",(0,c.jsx)(n.a,{href:"#raceeffects",children:(0,c.jsx)(n.code,{children:"race(effects)"})})," \u76f8\u540c\uff0c\u4f46\u5141\u8bb8\u4f60\u4f20\u5165\u4e00\u4e2a\u6548\u679c\u6570\u7ec4\u3002"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-12",children:"\u793a\u4f8b"}),"\n",(0,c.jsx)(n.p,{children:"\u4ee5\u4e0b\u793a\u4f8b\u5728\u4e24\u4e2a\u6548\u679c\u4e4b\u95f4\u8fdb\u884c\u7ade\u8d5b\uff1a"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["\u8c03\u7528\u4e00\u4e2a\u51fd\u6570 ",(0,c.jsx)(n.code,{children:"fetchUsers"}),"\uff0c\u8be5\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a Promise"]}),"\n",(0,c.jsxs)(n.li,{children:["\u53ef\u80fd\u6700\u7ec8\u5728 Store \u4e0a\u5206\u6d3e\u7684 ",(0,c.jsx)(n.code,{children:"CANCEL_FETCH"})," \u64cd\u4f5c"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import { take, call, race } from `redux-saga/effects`\r\nimport fetchUsers from './path/to/fetchUsers'\r\n\r\nfunction* fetchUsersSaga() {\r\n  const [response, cancel] = yield race([\r\n    call(fetchUsers),\r\n    take(CANCEL_FETCH)\r\n  ])\r\n}\n"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c ",(0,c.jsx)(n.code,{children:"call(fetchUsers)"})," \u9996\u5148\u89e3\u6790\uff0c",(0,c.jsx)(n.code,{children:"response"})," \u5c06\u662f ",(0,c.jsx)(n.code,{children:"fetchUsers"})," \u7684\u7ed3\u679c\uff0c",(0,c.jsx)(n.code,{children:"cancel"})," \u5c06\u662f ",(0,c.jsx)(n.code,{children:"undefined"}),"\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c ",(0,c.jsx)(n.code,{children:"call(fetchUsers)"})," \u9996\u5148\u62d2\u7edd\uff0c",(0,c.jsx)(n.code,{children:"race"})," \u4f1a\u629b\u51fa\u62d2\u7edd\u539f\u56e0\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c\u5728 ",(0,c.jsx)(n.code,{children:"fetchUsers"})," \u5b8c\u6210\u4e4b\u524d\u5728 Store \u4e0a\u5206\u6d3e\u4e86\u7c7b\u578b\u4e3a ",(0,c.jsx)(n.code,{children:"CANCEL_FETCH"})," \u7684\u64cd\u4f5c\uff0c",(0,c.jsx)(n.code,{children:"response"})," \u5c06\u662f ",(0,c.jsx)(n.code,{children:"undefined"}),"\uff0c",(0,c.jsx)(n.code,{children:"cancel"})," \u5c06\u662f\u5206\u6d3e\u7684\u64cd\u4f5c\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"alleffects---\u5e76\u884c\u6548\u679c",children:(0,c.jsx)(n.code,{children:"all([...effects]) - \u5e76\u884c\u6548\u679c"})}),"\n",(0,c.jsxs)(n.p,{children:["\u521b\u5efa\u4e00\u4e2a Effect \u63cf\u8ff0\uff0c\u6307\u793a\u4e2d\u95f4\u4ef6\u5e76\u884c\u8fd0\u884c\u591a\u4e2a Effects\uff0c\u5e76\u7b49\u5f85\u5b83\u4eec\u5168\u90e8\u5b8c\u6210\u3002\u8fd9\u4e0e\u6807\u51c6\u7684 ",(0,c.jsx)(n.a,{href:"https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Promise/all",children:(0,c.jsx)(n.code,{children:"Promise#all"})})," API \u76f8\u5bf9\u5e94\u3002"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-13",children:"\u793a\u4f8b"}),"\n",(0,c.jsx)(n.p,{children:"\u4ee5\u4e0b\u793a\u4f8b\u5e76\u884c\u8fd0\u884c\u4e24\u4e2a\u963b\u585e\u8c03\u7528\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import { fetchCustomers, fetchProducts } from './path/to/api'\r\nimport { all, call } from `redux-saga/effects`\r\n\r\nfunction* mySaga() {\r\n  const [customers, products] = yield all([\r\n    call(fetchCustomers),\r\n    call(fetchProducts)\r\n  ])\r\n}\n"})}),"\n",(0,c.jsx)(n.h3,{id:"alleffects",children:(0,c.jsx)(n.code,{children:"all(effects)"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4e0e ",(0,c.jsx)(n.a,{href:"#alleffects-parallel-effects",children:(0,c.jsx)(n.code,{children:"all([...effects])"})})," \u76f8\u540c\uff0c\u4f46\u5141\u8bb8\u4f60\u4f20\u5165\u5e26\u6709\u6807\u7b7e\u7684\u6548\u679c\u5b57\u5178\u5bf9\u8c61\uff0c\u5c31\u50cf ",(0,c.jsx)(n.a,{href:"#raceeffects",children:(0,c.jsx)(n.code,{children:"race(effects)"})})]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"effects: Object"})," - \u5f62\u5f0f\u4e3a ",(0,c.jsx)(n.code,{children:"{label: effect, ...}"})," \u7684\u5b57\u5178\u5bf9\u8c61"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-14",children:"\u793a\u4f8b"}),"\n",(0,c.jsx)(n.p,{children:"\u4ee5\u4e0b\u793a\u4f8b\u5e76\u884c\u8fd0\u884c\u4e24\u4e2a\u963b\u585e\u8c03\u7528\uff1a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import { fetchCustomers, fetchProducts } from './path/to/api'\r\nimport { all, call } from `redux-saga/effects`\r\n\r\nfunction* mySaga() {\r\n  const { customers, products } = yield all({\r\n    customers: call(fetchCustomers),\r\n    products: call(fetchProducts)\r\n  })\r\n}\n"})}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-18",children:"\u6ce8\u91ca"}),"\n",(0,c.jsx)(n.p,{children:"\u5728\u5e76\u884c\u8fd0\u884c Effects \u65f6\uff0c\u4e2d\u95f4\u4ef6\u4f1a\u6302\u8d77 Generator\uff0c\u76f4\u5230\u53d1\u751f\u4ee5\u4e0b\u60c5\u51b5\u4e4b\u4e00\uff1a"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:"\u6240\u6709\u7684 Effects \u90fd\u6210\u529f\u5b8c\u6210\uff1a\u7528\u5305\u542b\u6240\u6709 Effects \u7ed3\u679c\u7684\u6570\u7ec4\u6062\u590d Generator\u3002"}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:"\u5728\u6240\u6709\u6548\u679c\u5b8c\u6210\u4e4b\u524d\uff0c\u6709\u4e00\u4e2a\u6548\u679c\u88ab\u62d2\u7edd\uff1a\u5728 Generator \u5185\u90e8\u629b\u51fa\u62d2\u7edd\u9519\u8bef\u3002"}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"\u63a5\u53e3",children:"\u63a5\u53e3"}),"\n",(0,c.jsx)(n.h3,{id:"\u4efb\u52a1",children:"\u4efb\u52a1"}),"\n",(0,c.jsxs)(n.p,{children:["\u4efb\u52a1\u63a5\u53e3\u6307\u5b9a\u4e86\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"fork"}),"\uff0c",(0,c.jsx)(n.code,{children:"middleware.run"})," \u6216 ",(0,c.jsx)(n.code,{children:"runSaga"})," \u8fd0\u884c Saga \u7684\u7ed3\u679c\u3002"]}),"\n",(0,c.jsxs)("table",{id:"task-descriptor",children:[(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:"\u65b9\u6cd5"}),(0,c.jsx)("th",{children:"\u8fd4\u56de\u503c"})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:"task.isRunning()"}),(0,c.jsx)("td",{children:"\u5982\u679c\u4efb\u52a1\u5c1a\u672a\u8fd4\u56de\u6216\u629b\u51fa\u9519\u8bef\uff0c\u5219\u4e3a true"})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:"task.isCancelled()"}),(0,c.jsx)("td",{children:"\u5982\u679c\u4efb\u52a1\u5df2\u88ab\u53d6\u6d88\uff0c\u5219\u4e3a true"})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:"task.result()"}),(0,c.jsxs)("td",{children:["\u4efb\u52a1\u7684\u8fd4\u56de\u503c\u3002\u5982\u679c\u4efb\u52a1\u4ecd\u5728\u8fd0\u884c\uff0c\u5219\u4e3a ",(0,c.jsx)(n.code,{children:"undefined"})]})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:"task.error()"}),(0,c.jsxs)("td",{children:["\u4efb\u52a1\u629b\u51fa\u7684\u9519\u8bef\u3002\u5982\u679c\u4efb\u52a1\u4ecd\u5728\u8fd0\u884c\uff0c\u5219\u4e3a ",(0,c.jsx)(n.code,{children:"undefined"})]})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:"task.toPromise()"}),(0,c.jsxs)("td",{children:[(0,c.jsx)(n.p,{children:"\u4e00\u4e2a Promise\uff0c\u5b83\u53ef\u80fd\u662f\uff1a"}),(0,c.jsxs)("ul",{children:[(0,c.jsx)("li",{children:"\u7528\u4efb\u52a1\u7684\u8fd4\u56de\u503c\u89e3\u6790\u7684"}),(0,c.jsx)("li",{children:"\u7528\u4efb\u52a1\u629b\u51fa\u7684\u9519\u8bef\u62d2\u7edd\u7684"})]})]})]}),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:"task.cancel()"}),(0,c.jsx)("td",{children:"\u53d6\u6d88\u4efb\u52a1\uff08\u5982\u679c\u5b83\u4ecd\u5728\u8fd0\u884c\uff09"})]})]}),"\n",(0,c.jsx)(n.h3,{id:"\u901a\u9053",children:"\u901a\u9053"}),"\n",(0,c.jsx)(n.p,{children:"\u901a\u9053\u662f\u4e00\u4e2a\u7528\u4e8e\u5728\u4efb\u52a1\u4e4b\u95f4\u53d1\u9001\u548c\u63a5\u6536\u6d88\u606f\u7684\u5bf9\u8c61\u3002\u53d1\u9001\u8005\u7684\u6d88\u606f\u4f1a\u88ab\u6392\u961f\uff0c\u76f4\u5230\u6709\u611f\u5174\u8da3\u7684\u63a5\u6536\u8005\u8bf7\u6c42\u6d88\u606f\uff0c\u800c\u6ce8\u518c\u7684\u63a5\u6536\u8005\u4f1a\u88ab\u6392\u961f\uff0c\u76f4\u5230\u6709\u6d88\u606f\u53ef\u7528\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u6bcf\u4e2a\u901a\u9053\u90fd\u6709\u4e00\u4e2a\u5e95\u5c42\u7f13\u51b2\u533a\uff0c\u8be5\u7f13\u51b2\u533a\u5b9a\u4e49\u4e86\u7f13\u51b2\u7b56\u7565\uff08\u56fa\u5b9a\u5927\u5c0f\uff0c\u4e22\u5f03\uff0c\u6ed1\u52a8\uff09"}),"\n",(0,c.jsxs)(n.p,{children:["\u901a\u9053\u63a5\u53e3\u5b9a\u4e49\u4e863\u4e2a\u65b9\u6cd5\uff1a",(0,c.jsx)(n.code,{children:"take"}),"\uff0c",(0,c.jsx)(n.code,{children:"put"})," \u548c ",(0,c.jsx)(n.code,{children:"close"})]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"Channel.take(callback):"})," \u7528\u4e8e\u6ce8\u518c\u4e00\u4e2a\u63a5\u6536\u8005\u3002\u63a5\u6536\u8005\u7684\u89e3\u51b3\u9075\u5faa\u4ee5\u4e0b\u89c4\u5219"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\u5982\u679c\u901a\u9053\u6709\u7f13\u51b2\u7684\u6d88\u606f\uff0c\u90a3\u4e48",(0,c.jsx)(n.code,{children:"callback"}),"\u5c06\u4f1a\u7528\u5e95\u5c42\u7f13\u51b2\u533a\u7684\u4e0b\u4e00\u6761\u6d88\u606f\uff08\u4f7f\u7528",(0,c.jsx)(n.code,{children:"buffer.take()"}),"\uff09\u6765\u8c03\u7528"]}),"\n",(0,c.jsxs)(n.li,{children:["\u5982\u679c\u901a\u9053\u5df2\u5173\u95ed\u4e14\u6ca1\u6709\u7f13\u51b2\u7684\u6d88\u606f\uff0c\u90a3\u4e48",(0,c.jsx)(n.code,{children:"callback"}),"\u5c06\u4f1a\u7528",(0,c.jsx)(n.code,{children:"END"}),"\u6765\u8c03\u7528"]}),"\n",(0,c.jsxs)(n.li,{children:["\u5426\u5219",(0,c.jsx)(n.code,{children:"callback"}),"\u5c06\u4f1a\u6392\u961f\uff0c\u76f4\u5230\u6709\u6d88\u606f\u88ab\u653e\u5165\u901a\u9053"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"Channel.put(message):"})," \u7528\u4e8e\u5728\u7f13\u51b2\u533a\u653e\u5165\u6d88\u606f\u3002\u653e\u5165\u5c06\u4f1a\u6309\u7167\u4ee5\u4e0b\u89c4\u5219\u5904\u7406"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"\u5982\u679c\u901a\u9053\u5df2\u5173\u95ed\uff0c\u90a3\u4e48\u653e\u5165\u5c06\u4e0d\u4f1a\u6709\u4efb\u4f55\u6548\u679c"}),"\n",(0,c.jsx)(n.li,{children:"\u5982\u679c\u6709\u5f85\u5904\u7406\u7684\u63a5\u6536\u8005\uff0c\u90a3\u4e48\u7528\u6d88\u606f\u8c03\u7528\u6700\u65e7\u7684\u63a5\u6536\u8005"}),"\n",(0,c.jsx)(n.li,{children:"\u5426\u5219\u5c06\u6d88\u606f\u653e\u5165\u5e95\u5c42\u7f13\u51b2\u533a"}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"Channel.flush(callback):"})," \u7528\u4e8e\u4ece\u901a\u9053\u63d0\u53d6\u6240\u6709\u7f13\u51b2\u7684\u6d88\u606f\u3002\u5237\u65b0\u5c06\u6309\u7167\u4ee5\u4e0b\u89c4\u5219\u89e3\u51b3"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\u5982\u679c\u901a\u9053\u5df2\u5173\u95ed\u4e14\u6ca1\u6709\u7f13\u51b2\u7684\u6d88\u606f\uff0c\u90a3\u4e48",(0,c.jsx)(n.code,{children:"callback"}),"\u5c06\u4f1a\u7528",(0,c.jsx)(n.code,{children:"END"}),"\u6765\u8c03\u7528"]}),"\n",(0,c.jsxs)(n.li,{children:["\u5426\u5219",(0,c.jsx)(n.code,{children:"callback"}),"\u5c06\u4f1a\u7528\u6240\u6709\u7f13\u51b2\u7684\u6d88\u606f\u6765\u8c03\u7528"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"Channel.close():"})," \u5173\u95ed\u901a\u9053\uff0c\u8fd9\u610f\u5473\u7740\u4e0d\u518d\u5141\u8bb8\u653e\u5165\u3002\u6240\u6709\u5f85\u5904\u7406\u7684\u63a5\u6536\u8005\u5c06\u4f1a\u7528",(0,c.jsx)(n.code,{children:"END"}),"\u6765\u8c03\u7528\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"\u7f13\u51b2\u533a",children:"\u7f13\u51b2\u533a"}),"\n",(0,c.jsxs)(n.p,{children:["\u7528\u4e8e\u4e3a\u901a\u9053\u5b9e\u73b0\u7f13\u51b2\u7b56\u7565\u3002\u7f13\u51b2\u533a\u63a5\u53e3\u5b9a\u4e49\u4e863\u4e2a\u65b9\u6cd5\uff1a",(0,c.jsx)(n.code,{children:"isEmpty"}),"\uff0c",(0,c.jsx)(n.code,{children:"put"})," \u548c ",(0,c.jsx)(n.code,{children:"take"})]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"isEmpty()"}),": \u5982\u679c\u7f13\u51b2\u533a\u6ca1\u6709\u6d88\u606f\uff0c\u5219\u8fd4\u56detrue\u3002\u6bcf\u5f53\u6ce8\u518c\u65b0\u7684\u63a5\u6536\u8005\u65f6\uff0c\u901a\u9053\u90fd\u4f1a\u8c03\u7528\u6b64\u65b9\u6cd5"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"put(message)"}),": \u7528\u4e8e\u5728\u7f13\u51b2\u533a\u653e\u5165\u65b0\u6d88\u606f\u3002\u6ce8\u610f\u7f13\u51b2\u533a\u53ef\u4ee5\u9009\u62e9\u4e0d\u5b58\u50a8\u6d88\u606f\uff08\u4f8b\u5982\uff0c\u8d85\u8fc7\u7ed9\u5b9a\u9650\u5236\u7684\u65b0\u6d88\u606f\u53ef\u4ee5\u88ab\u4e22\u5f03\u7f13\u51b2\u533a\uff09"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"take()"}),": \u7528\u4e8e\u68c0\u7d22\u4efb\u4f55\u7f13\u51b2\u7684\u6d88\u606f\u3002\u6ce8\u610f\uff0c\u6b64\u65b9\u6cd5\u7684\u884c\u4e3a\u5fc5\u987b\u4e0e",(0,c.jsx)(n.code,{children:"isEmpty"}),"\u4e00\u81f4"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"sagamonitor",children:"SagaMonitor"}),"\n",(0,c.jsx)(n.p,{children:"\u7531\u4e2d\u95f4\u4ef6\u4f7f\u7528\uff0c\u4ee5\u5206\u6d3e\u76d1\u89c6\u4e8b\u4ef6\u3002\u5b9e\u9645\u4e0a\uff0c\u4e2d\u95f4\u4ef6\u5206\u6d3e\u4e866\u4e2a\u4e8b\u4ef6\uff1a"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5f53\u6839saga\u542f\u52a8\u65f6\uff08\u901a\u8fc7",(0,c.jsx)(n.code,{children:"runSaga"}),"\u6216",(0,c.jsx)(n.code,{children:"sagaMiddleware.run"}),"\uff09\uff0c\u4e2d\u95f4\u4ef6\u8c03\u7528",(0,c.jsx)(n.code,{children:"sagaMonitor.rootSagaStarted"})]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5f53\u89e6\u53d1\u6548\u679c\u65f6\uff08\u901a\u8fc7",(0,c.jsx)(n.code,{children:"yield someEffect"}),"\uff09\uff0c\u4e2d\u95f4\u4ef6\u8c03\u7528",(0,c.jsx)(n.code,{children:"sagaMonitor.effectTriggered"})]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c\u6548\u679c\u6210\u529f\u89e3\u51b3\uff0c\u4e2d\u95f4\u4ef6\u8c03\u7528",(0,c.jsx)(n.code,{children:"sagaMonitor.effectResolved"})]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c\u6548\u679c\u88ab\u9519\u8bef\u62d2\u7edd\uff0c\u4e2d\u95f4\u4ef6\u8c03\u7528",(0,c.jsx)(n.code,{children:"sagaMonitor.effectRejected"})]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5982\u679c\u6548\u679c\u88ab\u53d6\u6d88\uff0c\u4e2d\u95f4\u4ef6\u8c03\u7528",(0,c.jsx)(n.code,{children:"sagaMonitor.effectCancelled"})]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["\u6700\u540e\uff0c\u5f53\u5206\u6d3eRedux\u64cd\u4f5c\u65f6\uff0c\u4e2d\u95f4\u4ef6\u8c03\u7528",(0,c.jsx)(n.code,{children:"sagaMonitor.actionDispatched"})]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"\u4ee5\u4e0b\u662f\u6bcf\u4e2a\u65b9\u6cd5\u7684\u7b7e\u540d"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"sagaMonitor.rootSagaStarted(options)"}),"\uff1a\u5176\u4e2doptions\u662f\u4e00\u4e2a\u5177\u6709\u4ee5\u4e0b\u5b57\u6bb5\u7684\u5bf9\u8c61"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"effectId"}),"\uff1a\u6570\u5b57 - \u5206\u914d\u7ed9\u6b64\u6839saga\u6267\u884c\u7684\u552f\u4e00ID"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"saga"}),"\uff1a\u51fd\u6570 - \u5f00\u59cb\u8fd0\u884c\u7684\u751f\u6210\u5668\u51fd\u6570"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"args"}),"\uff1a\u6570\u7ec4 - \u4f20\u9012\u7ed9\u751f\u6210\u5668\u51fd\u6570\u7684\u53c2\u6570"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.code,{children:"effectTriggered(options)"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"effectId"}),"\uff1a\u6570\u5b57 - \u5206\u914d\u7ed9\u4ea7\u751f\u7684\u6548\u679c\u7684\u552f\u4e00ID"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"parentEffectId"}),"\uff1a\u6570\u5b57 - \u7236\u6548\u679c\u7684ID\u3002\u5728",(0,c.jsx)(n.code,{children:"race"}),"\u6216",(0,c.jsx)(n.code,{children:"parallel"}),"\u6548\u679c\u7684\u60c5\u51b5\u4e0b\uff0c\u5185\u90e8\u4ea7\u751f\u7684\u6240\u6709\u6548\u679c\u90fd\u5c06\u76f4\u63a5\u5c06race/parallel\u6548\u679c\u4f5c\u4e3a\u7236\u7ea7\u3002\u5728\u9876\u7ea7\u6548\u679c\u7684\u60c5\u51b5\u4e0b\uff0c\u7236\u7ea7\u5c06\u662f\u5305\u542b\u7684Saga"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"label"}),"\uff1a\u5b57\u7b26\u4e32 - \u5728",(0,c.jsx)(n.code,{children:"race"}),"/",(0,c.jsx)(n.code,{children:"all"}),"\u6548\u679c\u7684\u60c5\u51b5\u4e0b\uff0c\u6240\u6709\u5b50\u6548\u679c\u90fd\u5c06\u88ab\u5206\u914d\u4e3a\u6807\u7b7e\uff0c\u5bf9\u5e94\u4e8e\u4f20\u9012\u7ed9",(0,c.jsx)(n.code,{children:"race"}),"/",(0,c.jsx)(n.code,{children:"all"}),"\u7684\u5bf9\u8c61\u7684\u952e"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"effect"}),"\uff1a\u5bf9\u8c61 - \u4ea7\u751f\u7684\u6548\u679c\u672c\u8eab"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.code,{children:"effectResolved(effectId, result)"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"effectId"}),"\uff1a\u6570\u5b57 - \u4ea7\u751f\u7684\u6548\u679c\u7684ID"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"result"}),"\uff1a\u4efb\u4f55 - \u6548\u679c\u6210\u529f\u89e3\u51b3\u7684\u7ed3\u679c\u3002\u5728",(0,c.jsx)(n.code,{children:"fork"}),"\u6216",(0,c.jsx)(n.code,{children:"spawn"}),"\u6548\u679c\u7684\u60c5\u51b5\u4e0b\uff0c\u7ed3\u679c\u5c06\u662f\u4e00\u4e2a",(0,c.jsx)(n.code,{children:"Task"}),"\u5bf9\u8c61\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.code,{children:"effectRejected(effectId, error)"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"effectId"}),"\uff1a\u6570\u5b57 - \u4ea7\u751f\u7684\u6548\u679c\u7684ID"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"error"}),"\uff1a\u4efb\u4f55 - \u4e0e\u6548\u679c\u7684\u62d2\u7edd\u4e00\u8d77\u5f15\u53d1\u7684\u9519\u8bef"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.code,{children:"effectCancelled(effectId)"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"effectId"}),"\uff1a\u6570\u5b57 - \u4ea7\u751f\u7684\u6548\u679c\u7684ID"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.code,{children:"actionDispatched(action)"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"action"}),"\uff1a\u5bf9\u8c61 - \u5206\u6d3e\u7684Redux\u64cd\u4f5c\u3002\u5982\u679c\u64cd\u4f5c\u662f\u7531Saga\u5206\u6d3e\u7684\uff0c\u5219\u64cd\u4f5c\u5c06\u5177\u6709\u4e00\u4e2a\u5c5e\u6027",(0,c.jsx)(n.code,{children:"SAGA_ACTION"}),"\u8bbe\u7f6e\u4e3atrue\uff08",(0,c.jsx)(n.code,{children:"SAGA_ACTION"}),"\u53ef\u4ee5\u4ece",(0,c.jsx)(n.code,{children:"@redux-saga/symbols"}),"\u5bfc\u5165\uff09\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"\u5916\u90e8-api",children:"\u5916\u90e8 API"}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h3,{id:"runsagaoptions-saga-args",children:(0,c.jsx)(n.code,{children:"runSaga(options, saga, ...args)"})}),"\n",(0,c.jsx)(n.p,{children:"\u5141\u8bb8\u5728 Redux \u4e2d\u95f4\u4ef6\u73af\u5883\u4e4b\u5916\u542f\u52a8 sagas\u3002\u5982\u679c\u4f60\u60f3\u5c06 Saga \u8fde\u63a5\u5230\u9664\u5b58\u50a8\u64cd\u4f5c\u4e4b\u5916\u7684\u5916\u90e8\u8f93\u5165/\u8f93\u51fa\uff0c\u8fd9\u5c06\u975e\u5e38\u6709\u7528\u3002"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"runSaga"})," \u8fd4\u56de\u4e00\u4e2a\u4efb\u52a1\u5bf9\u8c61\u3002\u5c31\u50cf\u4ece ",(0,c.jsx)(n.code,{children:"fork"})," \u6548\u679c\u8fd4\u56de\u7684\u90a3\u6837\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"options: Object"})," - \u76ee\u524d\u652f\u6301\u7684\u9009\u9879\u6709\uff1a"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"channel"})," - \u53c2\u89c1 ",(0,c.jsx)(n.a,{href:"#channel",children:(0,c.jsx)(n.code,{children:"channel"})})," \u7684\u6587\u6863\uff08\u8fd9\u91cc\u6700\u597d\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"stdChannel"}),"\uff09"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"dispatch(output): Function"})," - \u7528\u4e8e\u6ee1\u8db3 ",(0,c.jsx)(n.code,{children:"put"})," \u6548\u679c\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"output: any"})," - \u7531 Saga \u63d0\u4f9b\u7ed9 ",(0,c.jsx)(n.code,{children:"put"})," \u6548\u679c\u7684\u53c2\u6570\uff08\u53c2\u89c1\u4e0b\u9762\u7684\u6ce8\u91ca\uff09\u3002"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"getState(): Function"})," - \u7528\u4e8e\u6ee1\u8db3 ",(0,c.jsx)(n.code,{children:"select"})," \u548c ",(0,c.jsx)(n.code,{children:"getState"})," \u6548\u679c"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"sagaMonitor"})," : ",(0,c.jsx)(n.a,{href:"#sagamonitor",children:"SagaMonitor"})," - \u53c2\u89c1 ",(0,c.jsx)(n.a,{href:"#createsagamiddlewareoptions",children:(0,c.jsx)(n.code,{children:"createSagaMiddleware(options)"})})," \u7684\u6587\u6863"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"onError: Function"})," - \u53c2\u89c1 ",(0,c.jsx)(n.a,{href:"#createsagamiddlewareoptions",children:(0,c.jsx)(n.code,{children:"createSagaMiddleware(options)"})})," \u7684\u6587\u6863"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"context"})," : "," - \u53c2\u89c1 ",(0,c.jsx)(n.a,{href:"#createsagamiddlewareoptions",children:(0,c.jsx)(n.code,{children:"createSagaMiddleware(options)"})})," \u7684\u6587\u6863"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"effectMiddlewares"})," : Function[] - \u53c2\u89c1 ",(0,c.jsx)(n.a,{href:"#createsagamiddlewareoptions",children:(0,c.jsx)(n.code,{children:"createSagaMiddleware(options)"})})," \u7684\u6587\u6863"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"saga: Function"})," - \u4e00\u4e2a\u751f\u6210\u5668\u51fd\u6570"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"args: Array<any>"})," - \u63d0\u4f9b\u7ed9 ",(0,c.jsx)(n.code,{children:"saga"})," \u7684\u53c2\u6570"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u6ce8\u91ca-19",children:"\u6ce8\u91ca"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"{channel, dispatch}"})," \u7528\u4e8e\u6ee1\u8db3 ",(0,c.jsx)(n.code,{children:"take"})," \u548c ",(0,c.jsx)(n.code,{children:"put"})," \u6548\u679c\u3002\u8fd9\u5b9a\u4e49\u4e86 Saga \u7684\u8f93\u5165/\u8f93\u51fa\u63a5\u53e3\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"channel"})," \u7528\u4e8e\u6ee1\u8db3 ",(0,c.jsx)(n.code,{children:"take(PATTERN)"})," \u6548\u679c\u3002\u6bcf\u6b21\u5728\u901a\u9053\u4e0a\u653e\u7f6e\u4e1c\u897f\u65f6\uff0c\u90fd\u4f1a\u901a\u77e5\u6240\u6709\u5f85\u5904\u7406\u7684\u5185\u90e8\u76d1\u542c\u5668\u3002\u5982\u679c Saga \u88ab ",(0,c.jsx)(n.code,{children:"take"})," \u6548\u679c\u963b\u585e\uff0c\u5e76\u4e14 take \u6a21\u5f0f\u5339\u914d\u5f53\u524d\u8fdb\u5165\u7684\u8f93\u5165\uff0cSaga \u5c06\u4ee5\u8be5\u8f93\u5165\u6062\u590d\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"dispatch"})," \u7528\u4e8e\u6ee1\u8db3 ",(0,c.jsx)(n.code,{children:"put"})," \u6548\u679c\u3002\u6bcf\u6b21 Saga \u53d1\u51fa ",(0,c.jsx)(n.code,{children:"yield put(output)"})," \u65f6\uff0c\u90fd\u4f1a\u7528 output \u8c03\u7528 ",(0,c.jsx)(n.code,{children:"dispatch"}),"\u3002"]}),"\n",(0,c.jsxs)(n.p,{children:["\u5982\u4f55\u4f7f\u7528\u6b64 API \u7684\u793a\u4f8b\u53ef\u4ee5\u5728",(0,c.jsx)(n.a,{href:"/redux-toolkit-zh/redux-saga/advanced/UsingRunSaga",children:"\u8fd9\u91cc"}),"\u627e\u5230\u3002"]}),"\n",(0,c.jsx)(n.h2,{id:"\u5b9e\u7528\u5de5\u5177",children:"\u5b9e\u7528\u5de5\u5177"}),"\n",(0,c.jsx)(n.h3,{id:"channelbuffer",children:(0,c.jsx)(n.code,{children:"channel([buffer])"})}),"\n",(0,c.jsx)(n.p,{children:"\u4e00\u4e2a\u53ef\u4ee5\u7528\u6765\u521b\u5efa Channels \u7684\u5de5\u5382\u65b9\u6cd5\u3002\u4f60\u53ef\u4ee5\u9009\u62e9\u6027\u5730\u4f20\u9012\u4e00\u4e2a\u7f13\u51b2\u533a\u6765\u63a7\u5236\u901a\u9053\u5982\u4f55\u7f13\u51b2\u6d88\u606f\u3002"}),"\n",(0,c.jsx)(n.p,{children:"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u6ca1\u6709\u63d0\u4f9b\u7f13\u51b2\u533a\uff0c\u901a\u9053\u5c06\u6392\u961f\u63a5\u6536\u7684\u6d88\u606f\u8fbe\u5230 10\uff0c\u76f4\u5230\u6ce8\u518c\u611f\u5174\u8da3\u7684\u63a5\u6536\u8005\u3002\u9ed8\u8ba4\u7684\u7f13\u51b2\u5c06\u4f7f\u7528 FIFO \u7b56\u7565\uff1a\u65b0\u7684\u63a5\u6536\u8005\u5c06\u88ab\u4f20\u9012\u7f13\u51b2\u533a\u4e2d\u6700\u65e7\u7684\u6d88\u606f\u3002"}),"\n",(0,c.jsx)(n.h3,{id:"eventchannelsubscribe-buffer",children:(0,c.jsx)(n.code,{children:"eventChannel(subscribe, [buffer])"})}),"\n",(0,c.jsxs)(n.p,{children:["\u521b\u5efa\u4e00\u4e2a\u5c06\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"subscribe"})," \u65b9\u6cd5\u8ba2\u9605\u4e8b\u4ef6\u6e90\u7684\u901a\u9053\u3002\u6765\u81ea\u4e8b\u4ef6\u6e90\u7684\u4f20\u5165\u4e8b\u4ef6\u5c06\u5728\u901a\u9053\u4e2d\u6392\u961f\uff0c\u76f4\u5230\u6ce8\u518c\u611f\u5174\u8da3\u7684\u63a5\u6536\u8005\u3002"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"subscribe: Function"})," \u7528\u4e8e\u8ba2\u9605\u5e95\u5c42\u4e8b\u4ef6\u6e90\u3002\u8be5\u51fd\u6570\u5fc5\u987b\u8fd4\u56de\u4e00\u4e2a\u53d6\u6d88\u8ba2\u9605\u51fd\u6570\u4ee5\u7ec8\u6b62\u8ba2\u9605\u3002"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"buffer: Buffer"})," \u53ef\u9009\u7684 Buffer \u5bf9\u8c61\uff0c\u7528\u4e8e\u5728\u6b64\u901a\u9053\u4e0a\u7f13\u51b2\u6d88\u606f\u3002\u5982\u679c\u672a\u63d0\u4f9b\uff0c\u6b64\u901a\u9053\u4e0a\u7684\u6d88\u606f\u5c06\u4e0d\u4f1a\u88ab\u7f13\u51b2\u3002"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u8981\u901a\u77e5\u901a\u9053\u4e8b\u4ef6\u6e90\u5df2\u7ec8\u6b62\uff0c\u4f60\u53ef\u4ee5\u7528 ",(0,c.jsx)(n.code,{children:"END"})," \u901a\u77e5\u63d0\u4f9b\u7684\u8ba2\u9605\u8005\u3002"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-15",children:"\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.p,{children:["\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u4e8b\u4ef6\u901a\u9053\uff0c\u8be5\u901a\u9053\u5c06\u8ba2\u9605 ",(0,c.jsx)(n.code,{children:"setInterval"})]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"const countdown = (secs) => {\r\n  return eventChannel(emitter => {\r\n      const iv = setInterval(() => {\r\n        console.log('countdown', secs)\r\n        secs -= 1\r\n        if (secs > 0) {\r\n          emitter(secs)\r\n        } else {\r\n          emitter(END)\r\n          clearInterval(iv)\r\n          console.log('countdown terminated')\r\n        }\r\n      }, 1000);\r\n      return () => {\r\n        clearInterval(iv)\r\n        console.log('countdown cancelled')\r\n      }\r\n    }\r\n  )\r\n}\n"})}),"\n",(0,c.jsx)(n.h3,{id:"buffers",children:(0,c.jsx)(n.code,{children:"buffers"})}),"\n",(0,c.jsx)(n.p,{children:"\u63d0\u4f9b\u4e00\u4e9b\u5e38\u89c1\u7684\u7f13\u51b2\u533a"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"buffers.none()"}),": \u6ca1\u6709\u7f13\u51b2\uff0c\u5982\u679c\u6ca1\u6709\u5f85\u5904\u7406\u7684\u63a5\u6536\u8005\uff0c\u65b0\u6d88\u606f\u5c06\u4e22\u5931"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"buffers.fixed(limit)"}),": \u65b0\u6d88\u606f\u5c06\u88ab\u7f13\u51b2\u5230 ",(0,c.jsx)(n.code,{children:"limit"}),"\u3002\u6ea2\u51fa\u5c06\u5f15\u53d1\u9519\u8bef\u3002\u7701\u7565 ",(0,c.jsx)(n.code,{children:"limit"})," \u503c\u5c06\u5bfc\u81f4\u9650\u5236\u4e3a 10\u3002"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"buffers.expanding(initialSize)"}),": \u7c7b\u4f3c\u4e8e ",(0,c.jsx)(n.code,{children:"fixed"}),"\uff0c\u4f46\u6ea2\u51fa\u5c06\u5bfc\u81f4\u7f13\u51b2\u533a\u52a8\u6001\u6269\u5c55\u3002"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"buffers.dropping(limit)"}),": \u4e0e ",(0,c.jsx)(n.code,{children:"fixed"})," \u76f8\u540c\uff0c\u4f46\u6ea2\u51fa\u5c06\u9759\u9ed8\u4e22\u5f03\u6d88\u606f\u3002"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"buffers.sliding(limit)"}),": \u4e0e ",(0,c.jsx)(n.code,{children:"fixed"})," \u76f8\u540c\uff0c\u4f46\u6ea2\u51fa\u5c06\u5728\u672b\u5c3e\u63d2\u5165\u65b0\u6d88\u606f\u5e76\u4e22\u5f03\u7f13\u51b2\u533a\u4e2d\u6700\u65e7\u7684\u6d88\u606f\u3002"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"cloneablegeneratorgeneratorfunc",children:(0,c.jsx)(n.code,{children:"cloneableGenerator(generatorFunc)"})}),"\n",(0,c.jsx)(n.p,{children:"\u63a5\u53d7\u4e00\u4e2a\u751f\u6210\u5668\u51fd\u6570\uff08function*\uff09\u5e76\u8fd4\u56de\u4e00\u4e2a\u751f\u6210\u5668\u51fd\u6570\u3002\r\n\u4ece\u6b64\u51fd\u6570\u5b9e\u4f8b\u5316\u7684\u6240\u6709\u751f\u6210\u5668\u90fd\u5c06\u662f\u53ef\u514b\u9686\u7684\u3002\r\n\u4ec5\u7528\u4e8e\u6d4b\u8bd5\u76ee\u7684\u3002"}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-16",children:"\u793a\u4f8b"}),"\n",(0,c.jsx)(n.p,{children:"\u5f53\u4f60\u60f3\u8981\u6d4b\u8bd5 saga \u7684\u4e0d\u540c\u5206\u652f\u800c\u65e0\u9700\u91cd\u64ad\u5bfc\u81f4\u5b83\u7684\u64cd\u4f5c\u65f6\uff0c\u8fd9\u975e\u5e38\u6709\u7528\u3002"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"import { cloneableGenerator } from '@redux-saga/testing-utils';\r\n\r\nfunction* oddOrEven() {\r\n  // \u8fd9\u91cc\u505a\u4e86\u4e00\u4e9b\u4e8b\u60c5\r\n  yield 1;\r\n  yield 2;\r\n  yield 3;\r\n\r\n  const userInput = yield '\u8f93\u5165\u4e00\u4e2a\u6570\u5b57';\r\n  if (userInput % 2 === 0) {\r\n    yield '\u5076\u6570';\r\n  } else {\r\n    yield '\u5947\u6570'\r\n  }\r\n}\r\n\r\ntest('\u6211\u7684 oddOrEven saga', assert => {\r\n  const data = {};\r\n  data.gen = cloneableGenerator(oddOrEven)();\r\n\r\n  assert.equal(\r\n    data.gen.next().value,\r\n    1,\r\n    '\u5e94\u8be5\u4ea7\u51fa 1'\r\n  );\r\n\r\n  assert.equal(\r\n    data.gen.next().value,\r\n    2,\r\n    '\u5e94\u8be5\u4ea7\u51fa 2'\r\n  );\r\n\r\n  assert.equal(\r\n    data.gen.next().value,\r\n    3,\r\n    '\u5e94\u8be5\u4ea7\u51fa 3'\r\n  );\r\n\r\n  assert.equal(\r\n    data.gen.next().value,\r\n    '\u8f93\u5165\u4e00\u4e2a\u6570\u5b57',\r\n    '\u5e94\u8be5\u8be2\u95ee\u4e00\u4e2a\u6570\u5b57'\r\n  );\r\n\r\n  assert.test('\u7ed9\u5b9a\u5076\u6570', a => {\r\n    // \u5728\u7ed9\u51fa\u6570\u5b57\u4e4b\u524d\uff0c\u6211\u4eec\u514b\u9686\u4e86\u751f\u6210\u5668\uff1b\r\n    data.clone = data.gen.clone();\r\n\r\n    a.equal(\r\n      data.gen.next(2).value,\r\n      '\u5076\u6570',\r\n      '\u5e94\u8be5\u4ea7\u51fa \"\u5076\u6570\"'\r\n    );\r\n\r\n    a.equal(\r\n      data.gen.next().done,\r\n      true,\r\n      '\u5e94\u8be5\u5b8c\u6210'\r\n    );\r\n\r\n    a.end();\r\n  });\r\n\r\n  assert.test('\u7ed9\u5b9a\u5947\u6570', a => {\r\n\r\n    a.equal(\r\n      data.clone.next(1).value,\r\n      '\u5947\u6570',\r\n      '\u5e94\u8be5\u4ea7\u51fa \"\u5947\u6570\"'\r\n    );\r\n\r\n    a.equal(\r\n      data.clone.next().done,\r\n      true,\r\n      '\u5e94\u8be5\u5b8c\u6210'\r\n    );\r\n\r\n    a.end();\r\n  });\r\n\r\n  assert.end();\r\n});\r\n\n"})}),"\n",(0,c.jsx)(n.h3,{id:"createmocktask",children:(0,c.jsx)(n.code,{children:"createMockTask()"})}),"\n",(0,c.jsxs)(n.p,{children:["\u8fd4\u56de\u4e00\u4e2a\u6a21\u62df\u4efb\u52a1\u7684\u5bf9\u8c61\u3002\r\n\u4ec5\u7528\u4e8e\u6d4b\u8bd5\u76ee\u7684\u3002\r\n",(0,c.jsx)(n.a,{href:"/redux-toolkit-zh/redux-saga/advanced/TaskCancellation#testing-generators-with-fork-effect",children:"\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u4efb\u52a1\u53d6\u6d88\u6587\u6863\u3002"})]}),"\n",(0,c.jsx)(n.h2,{id:"\u901f\u67e5\u8868",children:"\u901f\u67e5\u8868"}),"\n",(0,c.jsx)(n.h3,{id:"\u963b\u585e--\u975e\u963b\u585e",children:"\u963b\u585e / \u975e\u963b\u585e"}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"\u540d\u79f0"}),(0,c.jsx)(n.th,{children:"\u963b\u585e"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"takeEvery"}),(0,c.jsx)(n.td,{children:"\u5426"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"takeLatest"}),(0,c.jsx)(n.td,{children:"\u5426"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"takeLeading"}),(0,c.jsx)(n.td,{children:"\u5426"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"throttle"}),(0,c.jsx)(n.td,{children:"\u5426"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"debounce"}),(0,c.jsx)(n.td,{children:"\u5426"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"retry"}),(0,c.jsx)(n.td,{children:"\u662f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"take"}),(0,c.jsx)(n.td,{children:"\u662f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"take(channel)"}),(0,c.jsx)(n.td,{children:"\u6709\u65f6\uff08\u53c2\u89c1 API \u53c2\u8003\uff09"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"takeMaybe"}),(0,c.jsx)(n.td,{children:"\u662f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"put"}),(0,c.jsx)(n.td,{children:"\u5426"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"putResolve"}),(0,c.jsx)(n.td,{children:"\u662f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"put(channel, action)"}),(0,c.jsx)(n.td,{children:"\u5426"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"call"}),(0,c.jsx)(n.td,{children:"\u662f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"apply"}),(0,c.jsx)(n.td,{children:"\u662f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"cps"}),(0,c.jsx)(n.td,{children:"\u662f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"fork"}),(0,c.jsx)(n.td,{children:"\u5426"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"spawn"}),(0,c.jsx)(n.td,{children:"\u5426"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"join"}),(0,c.jsx)(n.td,{children:"\u662f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"cancel"}),(0,c.jsx)(n.td,{children:"\u5426"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"select"}),(0,c.jsx)(n.td,{children:"\u5426"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"actionChannel"}),(0,c.jsx)(n.td,{children:"\u5426"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"flush"}),(0,c.jsx)(n.td,{children:"\u662f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"cancelled"}),(0,c.jsx)(n.td,{children:"\u662f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"race"}),(0,c.jsx)(n.td,{children:"\u662f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"delay"}),(0,c.jsx)(n.td,{children:"\u662f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"all"}),(0,c.jsx)(n.td,{children:"\u5982\u679c\u6570\u7ec4\u6216\u5bf9\u8c61\u4e2d\u6709\u963b\u585e\u6548\u679c\uff0c\u5219\u963b\u585e"})]})]})]})]})}function o(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(h,{...e})}):h(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>i});var c=r(6540);const s={},d=c.createContext(s);function l(e){const n=c.useContext(d);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),c.createElement(d.Provider,{value:n},e.children)}}}]);